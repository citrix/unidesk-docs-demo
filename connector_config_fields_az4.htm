<!DOCTYPE html>
<html lang="en-us" xml:lang="en-us">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Azure Connector Configuration</title>
    </head>
    <body style="padding-left: 1.5em; padding-right: 1em; border-bottom-width: .5em; border-left-width: .5em; border-right-width: .5em; border-top-width: .5em; color: #000000; font-family: Arial, ' Helvetica', ' Sans Serif'; font-size: 9pt; margin-left: 0pt; text-align: left; background-color: #ffffff;">
        <div class="MCBreadcrumbsBox_0" style="border-bottom-color: #ffffff;border: 1px;border-bottom-width: 1px;border-top-width: 1px;border-left-width: 1px;border-right-width: 1px;font-size: 9pt;color: #636363;border-bottom-style: solid;padding-bottom: 10px;margin-bottom: 10px;"><span class="MCBreadcrumbsPrefix">You are here: </span><span class="MCBreadcrumbsSelf">Learn about Citrix App Layering [UnideskVersion Layering 4.0.8]</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">Connectors</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="connector_config_create_co4.htm" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">Add Connector Configuration</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">MS Azure</span>
        </div>
        <h1 style="clear: both;width: 85%;page-break-before: always;color: #d31245;font-size: 20px;font-weight: 500;margin-bottom: 0.40em;margin-top: 0.4em;"><a name="Azure_Platform_Connector_Fields"></a>Azure Connector Configuration</h1>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">This article contains:</p>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;"><a href="#How" class="MCXref_0 selected" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;"> When to add a Connector Configuration for Azure</a>
        </p>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;"><a href="#Creds" class="MCXref_0 selected" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;"> Azure information required</a>
        </p>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;"><a href="#Create" class="MCXref_0 selected" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;"> Add a Connector Configuration</a>
        </p>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">A Connector Configuration contains the credentials and location information that Unidesk needs to access a specific location in Azure. For example, your organization may have one Azure account and several storage locations, and you will need a Connector Configuration so Unidesk can access each storage locations. For more about Connectors and Connector Configurations, see <a href="connectors_about_co4.htm" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">Connectors and Connector Configurations</a>.</p>
        <h2 style="margin-bottom: .5em;margin-top: 1.750em;color: #303030;font-size: 15px;font-weight: 600;"><a name="How"></a>When to add a Connector Configuration for Azure</h2>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">When you create your first Layers, and later when you publish Layered Images for the first time you will add a Connector Configuration for each task, as described below.</p>
        <h2 style="margin-bottom: .5em;margin-top: 1.750em;color: #303030;font-size: 15px;font-weight: 600;"><a name="Creds"></a>Azure information required</h2>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">Your organization may have several Azure subscriptions. For Unidesk to access your Azure RD&#160;Session Host account, whether it's to download an OS&#160;Image or to publish a Layered Image, you must run this tool for each Azure subscription that you want to connect to via Unidesk. You can use the Unidesk Credentials Setup Tool to set up credentials for the Unidesk ELM, and later retrieve, the credentials you set up. </p>
        <ul style="margin-left: 0px;padding-left: 15px;margin-top: 0.75em;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><b>Name</b> - A name you enter for a new Connector Configuration. </li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><b>Subscription ID</b> - In order to deploy Azure virtual machines, your organization must have an account and credentials, including a subscription ID. </li>
            <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><b>Tenant ID</b> - This is a GUID that identifies your organization's dedicated instance of Azure AD. </li>
            <li style="margin-left: 0px;margin-bottom: 0.75em;font-size: 13px;color: #4d4d4d;margin-top: 0.75em;" value="4"><b>Client ID</b> - The identifier for one of potentially many Azure accounts that your organization has.</li>
            <li style="margin-left: 0px;margin-bottom: 0.75em;font-size: 13px;color: #4d4d4d;margin-top: 0.75em;" value="5"><b>Client Secret</b> - The password you want to use for the Client ID specified. If you already have a forgotten it, you can create a new one.</li>
            <li style="margin-left: 0px;margin-bottom: 0.75em;font-size: 13px;color: #4d4d4d;margin-top: 0.75em;" value="6">
                <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;"><b>Storage Account Name</b> - The Azure storage account you want to use when storing Azure virtual machine disks. This name must adhere to Azure storage account naming restrictions. For example, the storage account name cannot contain uppercase characters. </p>
                <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">You must either create a storage account through the portal or use an existing storage account that fits the following criteria. The account:</p>
                <ul style="margin-left: 0px;padding-left: 15px;">
                    <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Cannot be a <i>classic</i> storage account.</li>
                    <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Should be a separate storage account from the one used for the Unidesk ELM. This new storage account will be used during Layer creation and Layered Image publishing.</li>
                    <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Must be in the Azure location where you will deploy VMs.</li>
                    <li value="4" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Must be one of the following types: <ul style="margin-left: 0px;padding-left: 15px;"><li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><i>Standard</i> Locally Redundant storage (LRS)</li><li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><i>Standard</i> Geo-Redundant storage (GRS)</li><li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"><i>Standard</i> Read-Access Geo-Redundant storage (RAGRS)</li></ul></li>
                    <li value="5" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Can be located in any resource group, as long as the resource group's location is the same as the account's location.</li>
                </ul>
            </li>
        </ul>
        <h3 style="margin-bottom: .5em;margin-top: 1.50em;color: #4d4d4d;font-size: 13px;font-weight: 600;"><a name="Tool"></a>Tool for retrieving information from Azure</h3>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">The Azure Credentials  Tool is a PowerShell script that grants the Unidesk appliance restricted access to your Azure subscription so that Unidesk can retrieve the information required to create a new Azure Connector Configuration. When you run the tool, it prompts you for your Azure Login credentials, then sets up the credentials required for Unidesk to gain restricted access to your Azure subscription. </p>
        <h4 style="font-size: 100%;margin-top: 1.2em;margin-bottom: .5em;clear: both;color: #303030;">Requirements for running the Azure Credentials Tool </h4>
        <ul style="margin-left: 0px;padding-left: 15px;margin-top: 0.75em;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">A system with access to Azure and running the following software:<ul style="margin-left: 0px;padding-left: 15px;"><li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;"> Windows Server 2008, or later</li><li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Windows Powershell 2.0, or later (This ships with Windows Server 2008 and later.)</li><li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Storage Account in Azure</li></ul></li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">
                <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">Login credentials for a <i>Global Admin</i> or <i>Service Admin</i> in the Azure Active Directory Tenant associated with your subscription. In Azure, you can manage Active Directory <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">here</a>.</p>
                <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">An Azure AD tenant can be associated with many subscriptions, but each subscription can only have one tenant. If you are not sure which tenant is associated with which subscription, you can find out by clicking <b>Subscriptions</b> on the top of the old portal, and filtering by the directories listed until your subscription is listed as a check box under <b>Filter by Subscriptions</b>. </p>
            </li>
        </ul>
        <h4 style="font-size: 100%;margin-top: 1.2em;margin-bottom: .5em;clear: both;color: #303030;">Create a new storage account in Azure, if you don't have one for this purpose</h4>
        <ol style="margin-left: 2.0em;padding-left: 0px;margin-top: 0.75em;list-style-type: decimal;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In a web browser, navigate to the <a href="https://portal.azure.com" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">Microsoft Azure portal</a> and log in.</li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">On the sidebar, select <b>Storage accounts</b> or <b>Browser &gt; Storage accounts</b>. Do <i style="font-weight: bold;">not</i> select Storage accounts (classic). </li>
            <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Select <b>Add</b> in the top-left corner of the window that opens. </li>
            <li value="4" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the form that appears, select the options you need, making sure that the new storage location fits the same criteria for using any existing storage account.</li>
        </ol>
        <h4 style="font-size: 100%;margin-top: 1.2em;margin-bottom: .5em;clear: both;color: #303030;">Retrieve information for a <i>new</i> Azure Connector Configuration</h4>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d; text-decoration: none;">Here's how to set up your Azure credentials in the Connector Configuration wizard. It explains how to run the Azure for each Azure subscription that you want Unidesk to access.</p>
        <ol style="margin-left: 2.0em;padding-left: 0px;margin-top: 0.75em;list-style-type: decimal;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">On a Windows Server 2008 (or later version) machine, download and run the Unidesk Azure Credentials Tool from the <a href="http://www.unidesk.com/support/downloads" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">Unidesk 4 Downloads</a> page.</li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Follow the directions in the command prompt to select a subscription and choose a Client Secret.</li>
            <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">When the tool is complete, it will display the fields below. These should be entered into the configuration. </li>
            <li value="4" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Enter the Client Secret that you chose while running the tool.</li>
            <li value="5" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">If you did not enter a Client Secret, it has already been set up using this tool and you should use the one that was entered previously.</li>
        </ol>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;"><b>Note:</b> you will have to enter a new Client Secret each time you use a new subscription that has a new Tenant ID. This is because client secrets are logically associated with Azure tenants.</p>
        <h4 style="font-size: 100%;margin-top: 1.2em;margin-bottom: .5em;clear: both;color: #303030;"><a name="Retrieve"></a>Retrieve information for an <i>existing</i> Azure Connector Configuration</h4>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">If you have already run the Azure Credentials Tool to set up a subscription, you do not need to run the tool again. You can simply reuse the Name, Subscription ID, Tenant ID, Client ID, and Client Secret that you obtained. </p>
        <h4 style="font-size: 100%;margin-top: 1.2em;margin-bottom: .5em;clear: both;color: #303030;"><a name="Secret"></a>What to do if your Azure Client Secret is lost</h4>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">Once Unidesk creates the Client Secret for a Connector Configuration, the secret will always be hidden from view. If you forget and lose the Client Secret for a Configuration, you can reset it by using the following procedure:</p>
        <p class="noteText" style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d; margin-right: 100px; padding-right: 5px;"><b>Note:</b> You may have to be the primary Administrator of your Azure subscription to complete this procedure. Other Azure users may not have the access required.</p>
        <ol style="margin-left: 2.0em;padding-left: 0px;margin-top: 0.75em;list-style-type: decimal;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Log in to the <i>Classic</i> Azure Portal at: <a href="https://manage.windowsazure.com/" style="text-decoration: underline;text-decoration-blink: false;color: #3e63b1;">https://manage.windowsazure.com/</a>.</li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the left sidebar, select <b>Active Directory</b>.</li>
            <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">From the list of Active Directories, select the entry corresponding to your Unidesk installation.</li>
            <li value="4" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">From the top menu, select <b>Applications</b>.</li>
            <li value="5" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the Show field, select <b>Applications my company owns</b>.</li>
            <li value="6" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the Search box, enter <b>Unidesk</b> and click the check mark to perform the search.</li>
            <li value="7" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the search results, locate an entry named "Unidesk ELM Access for <i style="font-weight: normal;">your-subscription-name</i>" and delete it. If you do not see such an entry, look for it in your other Active Directories.</li>
            <li value="8" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Run the Unidesk Azure Credentials Tool again to create a new Client Secret.</li>
        </ol>
        <h2 style="margin-bottom: .5em;margin-top: 1.750em;color: #303030;font-size: 15px;font-weight: 600;"><a name="Create"></a>Add a Connector Configuration</h2>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">To add a new Connector Configuration:</p>
        <ol style="margin-left: 2.0em;padding-left: 0px;margin-top: 0.75em;list-style-type: decimal;">
            <li value="1" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">In the wizard for creating a Layer or for adding a Layer Version, click the <b>Connector</b> tab. </li>
            <li value="2" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Below the list of Connector Configurations, click the <b>New</b> button. This opens a small dialog box.</li>
            <li value="3" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Select the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click <b>New</b> to open the Connector Configuration page.  </li>
            <li value="4" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Complete the fields on the Connector Configuration page. For guidance, see the above field definitions.</li>
            <li value="5" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Click the <b>TEST</b>&#160;button to verify that Unidesk can access the location specified using the credentials supplied.</li>
            <li value="6" style="margin-left: 0px;margin-bottom: 0.75em;margin-top: 0.75em;font-size: 13px;color: #4d4d4d;">Click <b>Save</b>. The new Connector Configuration should now be listed on the Connector tab.</li>
        </ol>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">&#160;</p>
        <p style="text-align: left; margin-top: 1.12em; margin-bottom: 0.75em; font-size: 13px; color: #4d4d4d;">&#160;</p>
    </body>
</html>
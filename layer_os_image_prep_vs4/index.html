<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <title>layer_os_image_prep_vs4 - Citrix XenServer SDK</title>
     
    <link rel="shortcut icon" href="
https://www.citrix.com/etc/designs/citrix/icon-favicon.png"> 
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="../css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
    <link rel="stylesheet" href="../css/highlight.css">
    <link rel="stylesheet" href="../css/override.css" type="text/css" />
    <link rel="stylesheet" href="../css/font-awesome.css" type="text/css" /> 
    <script>
      // Current page data
      var mkdocs_page_name = "layer_os_image_prep_vs4";
      var mkdocs_page_input_path = "layer_os_image_prep_vs4.md";
      var mkdocs_page_url = "/layer_os_image_prep_vs4/";

    </script>
    
    <script src="../js/jquery-2.1.1.min.js"></script>
    <script src="../js/modernizr-2.8.3.min.js"></script>
    <script type="text/javascript" src="../js/highlight.pack.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/custom.js"></script>  
  </head>

  <body class="wy-body-for-nav" role="document">

    <div class="header-top">
      <div class="header-inner-body">
        <div class="header-top-left">
          <a href="http://citrix.github.io" class="logo-position"><img height="60" src="img/citrixlogoblack.png" target="_blank" class="logo-citrix"><span style="color:#000;font-size: 20px;position: relative;top:4px;left: 5px">Developer Documentation</span></a>
        </div>
        <div class="header-top-right">
          <ul>

            <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
             <ul class="header-elements">
              <li class="list-inline support">
                <input name="q" id="txtName" type="text" placeholder="Search SDKs" class="searchdocs">
                <a class="fa fa-search errspan"></a>
              </li>
             <li> <a href="javascript:void(0);" style="font-size: 22px;position: relative;left: -10px;top: 3px"><i class="fa fa-globe"></i></a></li>
             </ul>
            </form>

          </ul>

        </div>
      </div>
    </div>
    <div class="body">
      <div class="wy-grid-for-nav">

        
        <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
          <div class="wy-side-nav-search">
            <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
	<i class="fa fa-search"></i>
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
          </div>

          <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            <ul class="current">
              
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="..">Welcome</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connectors_about_co4/">connectors_about_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_create_co4/">connector_config_create_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields3_vs4/">connector_config_fields3_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_ah4/">connector_config_fields_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_ah_mc4/">connector_config_fields_ah_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_az4/">connector_config_fields_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_fs4/">connector_config_fields_fs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_pv4/">connector_config_fields_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_vs_mc4/">connector_config_fields_vs_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_vw4/">connector_config_fields_vw4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_xs4/">connector_config_fields_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../connector_config_fields_xs_mc4/">connector_config_fields_xs_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_release_notes_co4/">get_started_deploy_release_notes_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_ah4/">get_started_deploy_unidesk_elm_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_az4/">get_started_deploy_unidesk_elm_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_co4/">get_started_deploy_unidesk_elm_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_hv4/">get_started_deploy_unidesk_elm_hv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_vs4/">get_started_deploy_unidesk_elm_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_deploy_unidesk_elm_xs4/">get_started_deploy_unidesk_elm_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_install_agent_pv4/">get_started_install_agent_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_license_co4/">get_started_license_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_ah4/">get_started_login_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_az4/">get_started_login_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_co4/">get_started_login_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_hv4/">get_started_login_hv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_vs4/">get_started_login_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_login_xs4/">get_started_login_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_prerequisites_ah4/">get_started_prerequisites_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_prerequisites_az4/">get_started_prerequisites_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_prerequisites_hv4/">get_started_prerequisites_hv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_prerequisites_vs4/">get_started_prerequisites_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_prerequisites_xs4/">get_started_prerequisites_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_setup_fileshare_co4/">get_started_setup_fileshare_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_upgrade_elm_co4/">get_started_upgrade_elm_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../get_started_upgrade_unidesk_co4/">get_started_upgrade_unidesk_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../glossary_co4/">glossary_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../labs_enable_co4/">labs_enable_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_install_ah4/">landing_install_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_install_az4/">landing_install_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_install_hv4/">landing_install_hv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_install_vs4/">landing_install_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_install_xs4/">landing_install_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_layer_co4/">landing_layer_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_publish_co4/">landing_publish_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../landing_set_up_co4/">landing_set_up_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_co4/">layered_images_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_ah4/">layered_images_create_template_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_ah_mc4/">layered_images_create_template_ah_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_az4/">layered_images_create_template_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_co4/">layered_images_create_template_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_fs4/">layered_images_create_template_fs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_mc4/">layered_images_create_template_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_pv4/">layered_images_create_template_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_vs4/">layered_images_create_template_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_vw4/">layered_images_create_template_vw4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_xs4/">layered_images_create_template_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_create_template_xs_mc4/">layered_images_create_template_xs_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_manage_template_co4/">layered_images_manage_template_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_ah4/">layered_images_publish_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_ah_mc4/">layered_images_publish_ah_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_az4/">layered_images_publish_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_co4/">layered_images_publish_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_fs4/">layered_images_publish_fs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_mc4/">layered_images_publish_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_pv4/">layered_images_publish_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_vs4/">layered_images_publish_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_vw4/">layered_images_publish_vw4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_xs4/">layered_images_publish_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layered_images_publish_xs_mc4/">layered_images_publish_xs_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_about_co4/">layer_about_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_co4/">layer_apps_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_ah4/">layer_apps_create_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_az4/">layer_apps_create_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_co4/">layer_apps_create_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_fs4/">layer_apps_create_fs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_vs4/">layer_apps_create_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_create_xs4/">layer_apps_create_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_delete_co4/">layer_apps_delete_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_apps_recipes_co4/">layer_apps_recipes_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_assign_apps_co4/">layer_assign_apps_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_assign_apps_elastic_co4/">layer_assign_apps_elastic_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_assign_apps_image_template_co4/">layer_assign_apps_image_template_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_delete_co4/">layer_delete_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_co4/">layer_os_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_ah4/">layer_os_create_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_az4/">layer_os_create_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_co4/">layer_os_create_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_fs4/">layer_os_create_fs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_vs4/">layer_os_create_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_create_xs4/">layer_os_create_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_delete_co4/">layer_os_delete_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_image_prep_ah4/">layer_os_image_prep_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_image_prep_az4/">layer_os_image_prep_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_image_prep_co4/">layer_os_image_prep_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 current">
        <span class="expli"><i class="fa fa-plus-square-o" aria-hidden="true"></i></span><a class="current" style="width:270px;font-size: 12px" href="./">layer_os_image_prep_vs4</a>
        
            <ul style="display:none">
            
                <li class="toctree-l3"><a href="#prepare-the-osimage-vsphere" style="font-size: 12px;margin-left: 10px;position: relative;">&nbsp;Prepare the OS#Image (vSphere)</a></li>
                
                    <li><a class="toctree-l4" href="#which-operating-system-are-you-using" style="font-size: 12px;margin-left: 30px;position: relative;">Which operating system are you using?</a></li>
                
                    <li><a class="toctree-l4" href="#prepare-a-windows-server-2012-r2-image-session-host" style="font-size: 12px;margin-left: 30px;position: relative;">Prepare a Windows Server 2012 R2 image (Session Host)</a></li>
                
                    <li><a class="toctree-l4" href="#prepare-a-windows-2008-r2-image" style="font-size: 12px;margin-left: 30px;position: relative;">Prepare a Windows 2008 R2 image</a></li>
                
                    <li><a class="toctree-l4" href="#prepare-a-windows-10-image" style="font-size: 12px;margin-left: 30px;position: relative;">Prepare a Windows 10 image</a></li>
                
                    <li><a class="toctree-l4" href="#prepare-a-windows-7-image" style="font-size: 12px;margin-left: 30px;position: relative;">Prepare a Windows 7 image</a></li>
                
            
            </ul>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_image_prep_xs4/">layer_os_image_prep_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_version_ah4/">layer_os_version_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_version_az4/">layer_os_version_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_version_co4/">layer_os_version_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_version_vs4/">layer_os_version_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_os_version_xs4/">layer_os_version_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_ah4/">layer_platform_create_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_ah_mc4/">layer_platform_create_ah_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_az4/">layer_platform_create_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_co4/">layer_platform_create_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_mc4/">layer_platform_create_mc4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_ot4/">layer_platform_create_ot4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_pv4/">layer_platform_create_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_vs4/">layer_platform_create_vs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_vw4/">layer_platform_create_vw4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_create_xs4/">layer_platform_create_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_platform_delete_co4/">layer_platform_delete_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../layer_user_enable_co4/">layer_user_enable_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../logs_export_co4/">logs_export_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../platforms_for_publishing_pb_bk4/">platforms_for_publishing_pb_bk4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../platforms_for_publishing_pb_hy4/">platforms_for_publishing_pb_hy4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../platforms_for_publishing_pb_ps4/">platforms_for_publishing_pb_ps4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_ah4/">scenarios_ah4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_az4/">scenarios_az4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_co4/">scenarios_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_hv4/">scenarios_hv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_pv4/">scenarios_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_vw4/">scenarios_vw4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_xa65_pv4/">scenarios_xa65_pv4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../scenarios_xs4/">scenarios_xs4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../support_co4/">support_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../system_manage_appliance_co4/">system_manage_appliance_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../system_ports_firewall_co4/">system_ports_firewall_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../system_settings_co4/">system_settings_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../system_storage_co4/">system_storage_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../system_update_license_co4/">system_update_license_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../users_admins_assign_role_co4/">users_admins_assign_role_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../users_admin_password_co4/">users_admin_password_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../users_dir_service_co4/">users_dir_service_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../welcome_platform_support_co4/">welcome_platform_support_co4</a>
        
    </li>

                <li>
                  
              <li>
    <li class="toctree-l1 ">
        <a class="" style="width:270px;font-size: 12px" href="../welcome_release_notes_co4/">welcome_release_notes_co4</a>
        
    </li>

                <li>
                  
            </ul>
          </div>
          &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

           
          <div class="wy-nav-content">
            <div class="rst-content">
              <!-- <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>layer_os_image_prep_vs4</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/ajitchelat/AppDNA-SDK.git" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div> -->
              <div role="main">
                <div class="section">
                <div class="file-format">
                 <div class="leftAlign" style="float: left;visibility: hidden;">
                  </div>
                  <div class="rightAlign" style="float: right;">
                      <span>Download full document:</span>
                      <ul class="file-types">
                        <li><a style="border: 1px solid #EE3D24;padding: 5px;font-size: 11px;color: #EE3D24;border-radius: 5px;font-weight: 700">PDF</a></li>
                        <li><a style="border: 1px solid #2A579A;padding: 5px;font-size: 11px;color: #2A579A;border-radius: 5px;font-weight: 700">DOCX</a></li>
                        <li><a style="border: 1px solid #495164;padding: 5px;font-size: 11px;color: #495164;border-radius: 5px;font-weight: 700">EMAIL</a></li>
                        <li><a style="border: 1px solid #495164;padding: 5px;font-size: 11px;color: #495164;border-radius: 5px;font-weight: 700">PRINT</a></li>
                      </ul>
                  </div>
                  </div>
                   <p><a href="../layer_os_co4">OS Layer</a></p>
<blockquote>
<p>In vSphere</p>
</blockquote>
<h1 id="prepare-the-osimage-vsphere"><a class="toclink" href="#prepare-the-osimage-vsphere">Prepare the OS#Image (vSphere)</a></h1>
<p>This topic explains how to prepare an OSImage for the Unidesk environment, using the OSMachine Tools available for download on the Unidesk <a href="http://www.unidesk.com/support/downloads">Download</a><a href="http://www.unidesk.com/support/downloads"> page. </a></p>
<p>Notes:</p>
<ul>            <li>The OS Image should <i>not</i> be in a domain. </li>            <li>The OS Image should get its IP address from DHCP.</li>            <li>Using Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image. </li>            <li>Ensure that the VM for your OSLayer is  MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools.</li>            <li>The Paravirtual SCSI controller is <i>not</i> supported. You must use the default controller (SCSI BusLogic) for the OS to be functional. Unidesk supports the LSI Logic SAS controller type. If you subsequently change the SCSI controller type to anything else, such as VMware Paravirtual SCSI controller, the OS Layer import will fail.</li>        </ul>

<h2 id="which-operating-system-are-you-using"><a class="toclink" href="#which-operating-system-are-you-using">Which operating system are you using?</a></h2>
<p>Choose the operating system you are using for the OS Image: </p>
<ul>            <li><a href="#Prepare_win2012">Windows Server 2012 R2 (Session Host)</a>            </li>            <li><a href="#Prepare2">Windows Server 2008 R2</a>            </li>            <li><a href="#Prepare3">Windows 10</a>            </li>            <li><a href="#Prepare">Windows 7 </a>            </li>        </ul>

<h2 id="prepare-a-windows-server-2012-r2-image-session-host"><a class="toclink" href="#prepare-a-windows-server-2012-r2-image-session-host">Prepare a Windows Server 2012 R2 image (Session Host)<a name="Prepare_win2012"></a></a></h2>
<h3 id="step-1-set-up-a-windows-server-2012-r2-os-image-on-a-virtual-machine"><a class="toclink" href="#step-1-set-up-a-windows-server-2012-r2-os-image-on-a-virtual-machine">STEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine<a name="STEP1_win2012r2"></a></a></h3>
<p>In the vSphere client:</p>
<ol>            <li>Create a VM for the OSimage.</li>            <li>                <p>Configure the virtual machine hardware settings, for example, the NIC and video memory.</p>                <p><b>Important:</b> You can have just <i>one network device</i> for the virtual machine, and it must be the VMXNET 3 network adapter, as the default E1000 adapter (or even a ghost NIC leftover from an E1000 adapter) can cause customization timeout errors on the VM when attempting to boot the image in environments such as Citrix PVS, Citrix MCS, or VMware Horizon View. </p>            </li>            <li>Configure a virtual hard disk that is large enough for a Windows operating system installation, and make sure it is accessible by the Unidesk Management Appliance.</li>            <li>Install Windows Server 2012 R2.</li>            <li>Disable Windows System Restore and Windows Automatic Updates. The Unidesk system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.</li>            <li>Install VMware Tools on your OSimage. </li>        </ol>

<h3 id="step-2-copy-the-unidesk-osmachine-tools-onto-the-os-image"><a class="toclink" href="#step-2-copy-the-unidesk-osmachine-tools-onto-the-os-image">STEP 2: Copy the Unidesk OS<a name="STEP4_win2012r2"></a>###Machine Tools onto the OS Image <a name="STEP4_win2012r2"></a></a></h3>
<ol>            <li><a href="http://www.unidesk.com/support/downloads">Download</a> the Unidesk_OS_Machine_Tools ZIP file onto the OS Image. </li>            <li>Extract the Unidesk_OS_Machine_Tools_<i>x.x.x</i> to c:\windows\setup\scripts.</li>        </ol>

<h3 id="step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops"><a class="toclink" href="#step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops">STEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops<a name="STEP5_win2012r2"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, right-click the unattend.exe tool and choose  <b>Run as administrator</b>. The unattend builder form opens.</p>            </li>            <li>                <p>Complete  the unattend form.</p>                <ul>                    <li>Product key activation<ul><li>For KMS activation, select KMS Server.</li><li>For KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.</li><li>For Retail Licensing with a MAK, select Retail with MAK, and the MAK.</li></ul></li>                    <li>Domain Join<ul><li>Select Enable if you want to configure the unattend.xml file to join desktops to a specific domain.  If you plan to use AD join scripts, ensure Enable is <i>not</i> selected.</li><li>You can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.</li><li>  If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.</li></ul></li>                    <li>Local Administrator account<ul><li>If you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select <b>Enable</b>. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.</li><li>If you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.</li><li>You can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled.  However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.</li></ul></li>                    <li>Time zone<ul><li>Select the time zone.  If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, <i>not</i> the display setting.  A list of time zone settings can be found <a href="http://technet.microsoft.com/en-us/library/cc749073(v=ws.10).aspx">here</a>.</li></ul></li>                    <li>Disabling automatic activation<ul><li>Select this option if you plan to use the Microsoft Volume Activation Management Tool.</li></ul></li>                </ul>            </li>            <li>                <p>Click <b>Save File</b>. </p>            </li>        </ol>

<h3 id="step-4-optional-optimize-the-os-image-for-the-unidesk-environment"><a class="toclink" href="#step-4-optional-optimize-the-os-image-for-the-unidesk-environment">STEP 4: (Optional) Optimize the OS Image for the Unidesk environment <a name="STEP7_win2012r2"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, run the Optimize executable to create a .cmd file (optimization.cmd) that will be run to optimize the image during Desktop creation.</p>            </li>            <li>                <p>Follow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.</p>                <p>If you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called <b>Disable Unnecessary Services to Save Memory and CPU</b>, <i>deselect</i> the option to <b>Disable Offline File Service</b>, and click <b>Save File</b>. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.  </p>            </li>        </ol>

<h3 id="step-5-create-a-snapshot-of-the-os-image"><a class="toclink" href="#step-5-create-a-snapshot-of-the-os-image">STEP 5: Create a snapshot of the OS Image<a name="STEP3_win2012r2"></a></a></h3>
<p>Once the OS Image is ready, create a VMware snapshot of it, so that you can return to this state at any time.</p>
<p>Important: It is critical to create a snapshot  before installing the Unidesk software onto the OS Image. Without this snapshot, returning  to this state requires rebuilding the image.</p>
<h3 id="step-6-install-the-unidesk-tools-onto-the-os-image"><a class="toclink" href="#step-6-install-the-unidesk-tools-onto-the-os-image">STEP 6: Install the Unidesk tools onto the OS Image<a name="STEP6_win2012r2"></a></a></h3>
<ol>            <li>In the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).</li>            <li>                <p>The installation prompts for the  location of the unattend.xml file (the default location is c:\windows\panther).</p>            </li>        </ol>

<p>Once this is done, you are ready to <a href="../layer_os_create_vs4">create a Unidesk Operating System Layer</a><a href="../layer_os_create_vs4">.</a></p>
<h2 id="prepare-a-windows-2008-r2-image"><a class="toclink" href="#prepare-a-windows-2008-r2-image">Prepare a Windows 2008 R2 image<a name="Prepare2"></a></a></h2>
<h3 id="step-1-set-up-a-windows-server-2008-r2-os-image-on-a-virtual-machine"><a class="toclink" href="#step-1-set-up-a-windows-server-2008-r2-os-image-on-a-virtual-machine">STEP 1: Set up a Windows Server 2008 R2 OS Image on a virtual machine<a name="STEP1_win2008r2"></a></a></h3>
<p>In the vSphere client:</p>
<ol>            <li>                <p>Create a VM for your OSimage, making sure to choose the default cluster allocation size of 4K.</p>            </li>            <li>                <p>Configure the virtual machine hardware settings, for example, the NIC and video memory.</p>                <p><b>Important:</b> You can have just <i>one network device</i> for the virtual machine, and it must be the VMXNET 3 network adapter, as the default E1000 adapter (or even a ghost NIC leftover from an E1000 adapter) can cause customization timeout errors on the VM when attempting to boot the image in environments such as Citrix PVS, Citrix MCS, or VMware Horizon View. </p>            </li>            <li>                <p>If you are using Citrix PVS or VMware Horizon View, install Windows Server 2008 R2 Service Pack 1 (SP1).</p>                <p><span>Notes:</span> </p>                <ul>                    <li>If you do not install SP1, an error occurs when you try to install View Agent in the virtual machine.</li>                    <li>When creating the image, be sure to choose the default cluster allocation size of 4K.</li>                </ul>            </li>            <li>                <p>If using PVS: </p>                <ol>                    <li>                        <p>In the VMproperties, make sure the PCI slot number is 192, as shown below (mouse over the image to enlarge it):</p>                        <p><a href="Resources/Images/layers_os_2008_1.PNG"><img></img></a>                        </p>                    </li>                    <li>                        <p>Install KB2550978 hotfix:</p>                        <p>https://support.microsoft.com/en-us/kb/2550978</p>                    </li>                    <li>                        <p>Run cmd as Administrator, and enter the following commands:</p><pre>set devmgr_show_nonpresent_devices=1run devmgmt.msc in the same cmd window</pre>                        <p><b>Note:</b> You must run these commands, or the next command will not show hidden devices (ghost NICs)</p>                    </li>                    <li>Select <b>View >Show hidden devices </b> in Device Manager. This shows dead NICs as grayed out.</li>                    <li>                        <p>Uninstall the dead NIC and reboot the system.</p>                    </li>                </ol>            </li>            <li>                <p>Install VMware Tools on the OSimage. </p>            </li>        </ol>

<h3 id="step-2-copy-the-unidesk-tools-onto-the-os-image"><a class="toclink" href="#step-2-copy-the-unidesk-tools-onto-the-os-image">STEP 2: Copy the Unidesk Tools onto the OS Image <a name="STEP4_win2008r2"></a></a></h3>
<ol>            <li><a href="http://www.unidesk.com/support/downloads">Download</a> the Unidesk_OS_Machine_Tools ZIP file onto the OS Image. </li>            <li>Extract the Unidesk_OS_Machine_Tools_<i>x.x.x</i> to c:\windows\setup\scripts.</li>        </ol>

<h3 id="step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_1"><a class="toclink" href="#step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_1">STEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops<a name="STEP5_win2008r2"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, right-click the unattend.exe tool and choose  <b>Run as administrator</b>. The unattend builder form opens.</p>            </li>            <li>                <p>Complete  the unattend form.</p>                <ul>                    <li>Product key activation<ul><li>For KMS activation, select KMS Server.</li><li>For KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.</li><li>For Retail Licensing with a MAK, select Retail with MAK, and the MAK.</li></ul></li>                    <li>Domain Join<ul><li>Select Enable if you want to configure the unattend.xml file to join desktops to a specific domain.  If you plan to use AD join scripts, ensure Enable is <i>not</i> selected.</li><li>You can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.</li><li>  If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.</li><li><p>For information about domain join scripts, see the following Support articles:</p><p><a href="troubleshoot_domain_join.htm">Debugging Domain Join Problems in Windows 7 and Windows Server 2008 R2</a></p></li></ul></li>                    <li>Local Administrator account<ul><li>If you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.</li><li>If you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.</li><li>You can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled.  However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.</li></ul></li>                    <li>Time zone<ul><li>Select the time zone.  If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, <i>not</i> the display setting.  A list of time zone settings can be found <a href="http://technet.microsoft.com/en-us/library/cc749073(v=ws.10).aspx">here</a>.</li></ul></li>                    <li>Disabling automatic activation<ul><li>Select this option if you plan to use the Microsoft Volume Activation Management Tool.</li></ul></li>                </ul>            </li>            <li>                <p>Click <b>Save File</b>. </p>            </li>        </ol>

<h3 id="step-4-optional-optimize-the-os-image-for-the-unidesk-environment_1"><a class="toclink" href="#step-4-optional-optimize-the-os-image-for-the-unidesk-environment_1">STEP 4: (Optional) Optimize the OS Image for the Unidesk environment <a name="STEP7_win2008r2"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.</p>            </li>            <li>                <p>Follow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.</p>                <p>If you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called <b>Disable Unnecessary Services to Save Memory and CPU</b>, <i>deselect</i> the option to <b>Disable Offline File Service</b>, and click <b>Save File</b>. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.  </p>            </li>        </ol>

<h3 id="step-5-create-a-vmware-snapshot-of-the-os-image"><a class="toclink" href="#step-5-create-a-vmware-snapshot-of-the-os-image">STEP 5: Create a VMware snapshot of the OS Image<a name="STEP3_win2008r2"></a></a></h3>
<p>Once the OS Image is ready, create a VMware snapshot of it so you can return to this state at any time.</p>
<p>Important: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning  to this state requires rebuilding the image.</p>
<h3 id="step-6-install-the-unidesk-tools-onto-the-os-image_1"><a class="toclink" href="#step-6-install-the-unidesk-tools-onto-the-os-image_1">STEP 6: Install the Unidesk tools onto the OS Image<a name="STEP6_win2008r2"></a></a></h3>
<ol>            <li>In the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).</li>            <li>                <p>The installation prompts for the location of the unattend.xml file (the default location is c:\windows\panther).</p>            </li>        </ol>

<p>Once this is done, you are ready to <a href="../deploy_os_layer_create_first">create a Unidesk Operating System Layer</a><a href="../deploy_os_layer_create_first">.</a></p>
<h2 id="prepare-a-windows-10-image"><a class="toclink" href="#prepare-a-windows-10-image">Prepare a Windows 10 image<a name="Prepare3"></a></a></h2>
<p>When preparing the OS Image for import into a Unidesk Operating System Layer, you can speed up start times by <a href="http://www.howtogeek.com/224798/how-to-uninstall-windows-10s-built-in-apps-and-how-to-reinstall-them/">removing Windows 10 built-in applications</a><a href="http://www.howtogeek.com/224798/how-to-uninstall-windows-10s-built-in-apps-and-how-to-reinstall-them/">. If you do, we recommend removing these applications either on the OS Image itself, or on the Operating System Layer. </a></p>
<h3 id="step-1-set-up-a-windows-10-image-on-a-virtual-machine"><a class="toclink" href="#step-1-set-up-a-windows-10-image-on-a-virtual-machine">STEP 1: Set up a Windows 10 image on a virtual machine<a name="STEP1_8.1"></a></a></h3>
<p>In the vSphere client:</p>
<ol>            <li>                <p>Create a VM for your OS image.</p>                <p><b>Important:</b> When creating the image, be sure to choose the default cluster allocation size of 4K.</p>            </li>            <li>                <p>Configure the virtual machine hardware settings, for example, the NIC and video memory.</p>            </li>            <li>                <p>Disable Windows System Restore and Windows Automatic Updates: </p>                <ol>                    <li>                        <p>Log into the VM.</p>                    </li>                    <li>Select <b>Computer Config > Administrative Templates > Windows Components > Windows Updates > Config Auto Updates</b>.</li>                    <li>Set this to <b>Disabled</b>.</li>                </ol>                <p>The Unidesk system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.</p>            </li>            <li>                <p>If using KMSlicensing, run a command window as Administrator, and enter these commands:</p><pre>slmgr /skms <kmsserverhost>slmgr /rearmrebootslmgr /ipk XXXX-YOUR-KMS-KEY-XXXXslmgr /ato</pre>            </li>            <li>Install the VMware Tools on the OS image. </li>        </ol>

<h3 id="step-2-copy-the-unidesk-tools-onto-the-os-image_1"><a class="toclink" href="#step-2-copy-the-unidesk-tools-onto-the-os-image_1">STEP 2: Copy the Unidesk Tools onto the OS Image <a name="STEP3_8.1"></a></a></h3>
<ol>            <li><a href="http://www.unidesk.com/support/downloads">Download</a> the Unidesk_OS_Machine_Tools ZIP file onto the OS Image. </li>            <li>Extract the Unidesk_OS_Machine_Tools_<i>x.x.x</i> to c:\windows\setup\scripts.</li>        </ol>

<h3 id="step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_2"><a class="toclink" href="#step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_2">STEP 3: (Optional) Create an answer file for unattended installation on Unidesk Desktops<a name="STEP5_8.1"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, right-click the unattend.exe tool and choose  <b>Run as administrator</b>. The unattend builder form opens.</p>            </li>            <li>                <p>Complete  the unattend form.</p>                <div>                    <div>Product key activation</div>                    <div>                        <p>For KMS activation, select KMS Server.</p>                        <p>For KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.</p>                        <p>For Retail Licensing with a MAK, select Retail with MAK, and the MAK.</p>                    </div>                </div>                <div>                    <div>Domain Join</div>                    <div>                        <p>Select Enable if you want to configure the unattend.xml file to join Desktops to a specific domain.  If you plan to use AD join scripts, ensure Enable is <i>not</i> selected.</p>                        <p>You can add Desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk Desktops, both to segregate the Desktop from other machines and to avoid applying virtual Desktop-specific GPOs to other types of machines.</p>                        <p>If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.</p>                    </div>                </div>                <div>                    <div>Local Administrator account</div>                    <div>                        <p>You can enable the Administrator account on each Unidesk Desktop by selecting Enable. Remember to also enable this account in your OS Image or Operating System Layer version. You can also enable the Administrator account for your OS Image and then have it disabled in the deployed Desktops by clearing the check box.</p>                        <p>If you want to add an alternate Administrator account, select Enable and enter the account information. This account <i>cannot</i> be preconfigured in the OS Image.</p>                        <p>You can create a Desktop where the Administrator is disabled and the alternate administrator is created and enabled.  However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.</p>                    </div>                </div>                <div>                    <div>Time Zone</div>                    <div>                        <p>If your time zone is not listed, you can add it to the <b>Other</b> box. Be sure to use the <a href="http://technet.microsoft.com/en-us/library/cc749073(v=ws.10).aspx">time zone</a>, <i>not</i> the display setting.  </p>                    </div>                </div>                <div>                    <div>Disabling automatic activation</div>                    <div>                        <p>Select this option if you plan to use the Microsoft Volume Activation Management Tool.  </p>                    </div>                </div>            </li>            <li>                <p>Click <b>Save File</b>. </p>            </li>        </ol>

<h3 id="step-4-optional-optimize-the-os-image-for-the-unidesk-environment_2"><a class="toclink" href="#step-4-optional-optimize-the-os-image-for-the-unidesk-environment_2">STEP 4: (Optional) Optimize the OS Image for the Unidesk environment <a name="STEP6_8.1"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, right-click the optimizations.exe tool and choose  <b>Run as administrator</b>. This creates  a .cmd file (optimizations.cmd) that will be run during Desktop creation to optimize the image.</p>            </li>            <li>                <p>Follow the instructions to run the optimizations.cmd file on the OS Image. This removes installation-specific drivers and settings.</p>                <p>If you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called <b>Disable Unnecessary Services to Save Memory and CPU</b>, <i>deselect</i> the option to <b>Disable Offline File Service</b>, and click <b>Save File</b>. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.  </p>            </li>        </ol>

<h3 id="step-5-install-net-framework-351"><a class="toclink" href="#step-5-install-net-framework-351">STEP 5: Install .Net Framework 3.5.1<a name="STEP2_8.1"></a></a></h3>
<p>The .Net Framework is a software framework provided by Microsoft that is required for many 3rd party applications to run. To install this feature, follow the steps below.</p>
<ol>            <li>                <p>On the Start menu, select <b>Control Panel > Programs and Features</b>.</p>            </li>            <li>                <p>In the left panel select <b>Turn Windows features on or off.</b> A window opens.</p>            </li>            <li>                <p>Select <b>.NET Framework 3.5</b>, click <b>OK</b>, and wait for the installation to complete.</p>                <p><b>Important:</b> Even if .NET is already installed, continue with the rest of these steps.</p>            </li>            <li>                <p>Exit the Control Panel.</p>            </li>            <li>                <p>In Notifications in the right-side of your taskbar, click <b>All Settings</b>, and open the Windows 10 Settings app.</p>            </li>            <li>                <p>Select Settings > Update ; Security.</p>            </li>            <li>                <p>Check for updates, and install all updates available.</p>            </li>            <li>                <p>Exit Settings.</p>            </li>            <li>                <p>Open an administrator-level command prompt, and enter the following commands:</p><pre>cd \windows\Microsoft.Net\Framework\v4.nnnnnngen update /force</pre>            </li>            <li>                <p>Wait for the command to complete, and enter the following commands:</p><pre>cd \windows\Microsoft.Net\Framework64\v4.nnnnnngen update /force</pre>            </li>            <li>Exit the command prompt.</li>        </ol>

<h3 id="step-6-if-using-pvs-follow-these-steps-to-avoid-ghost-nics"><a class="toclink" href="#step-6-if-using-pvs-follow-these-steps-to-avoid-ghost-nics">STEP 6: If using PVS, follow these steps to avoid ghost NICs.<a name="Step6"></a></a></h3>
<ol>            <li>                <p>Install KB2550978 hotfix.</p>            </li>            <li>                <p>Reboot the VM,</p>            </li>            <li>                <p>Enter the commands:</p><pre>set devmgr_show_nonpresent_devices=devmgmt.msc</pre>            </li>            <li>                <p>Remove any ghost NICs.</p>            </li>            <li>                <p>Reboot the system.</p>            </li>        </ol>

<h3 id="step-7-create-a-backup-copy-of-the-os-image"><a class="toclink" href="#step-7-create-a-backup-copy-of-the-os-image">STEP 7: Create a backup copy of the OS Image<a name="STEP7"></a></a></h3>
<p>Once the OS Image is ready, create a copy of it so you can return to this state at any time.</p>
<p>Important: It is critical to create a backup copy before installing the Unidesk software onto the OS Image. Without this backup copy, returning  to this state requires rebuilding the image.</p>
<h3 id="step-8-install-the-unidesk-software-onto-the-os-image"><a class="toclink" href="#step-8-install-the-unidesk-software-onto-the-os-image">STEP 8: Install the Unidesk software onto the OS Image<a name="STEP8"></a></a></h3>
<ol>            <li>Run setup_x64.exe from c:\Windows\setup\scripts.</li>        </ol>

<p>Once this is done, you are ready to create a Unidesk Operating System Layer.</p>
<h2 id="prepare-a-windows-7-image"><a class="toclink" href="#prepare-a-windows-7-image">Prepare a Windows 7 image<a name="Prepare"></a></a></h2>
<h3 id="step-1-set-up-a-windows-7-os-image-on-a-virtual-machine"><a class="toclink" href="#step-1-set-up-a-windows-7-os-image-on-a-virtual-machine">STEP 1: Set up a Windows 7 OS Image on a virtual machine<a name="STEP1_win7"></a></a></h3>
<p>In the vSphere client:</p>
<ol>            <li>                <p>Create a VM for your OS Image.</p>                <p>Important: When creating the image, be sure to choose the default cluster allocation size of 4K.</p>            </li>            <li>                <p>Configure the virtual machine hardware settings, for example, the NIC and video memory.</p>            </li>            <li>                <p>Disable Windows System Restore and Windows Automatic Updates. The Unidesk system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.</p>            </li>            <li>                <p>Make sure you have installed VMware Tools on the OSimage. </p>            </li>        </ol>

<h3 id="step-2-mount-or-copy-the-unidesk-tools-onto-the-os-image"><a class="toclink" href="#step-2-mount-or-copy-the-unidesk-tools-onto-the-os-image">STEP 2: Mount or copy the Unidesk Tools onto the OS Image <a name="STEP3_win7"></a></a></h3>
<ol>            <li><a href="http://www.unidesk.com/support/downloads">Download</a> the Unidesk_OS_Machine_Tools ZIP file onto the OS Image. </li>            <li>Extract the Unidesk_OS_Machine_Tools_<i>x.x.x</i> to c:\windows\setup\scripts.</li>        </ol>

<h3 id="step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_3"><a class="toclink" href="#step-3-optional-create-an-answer-file-for-unattended-installation-on-unidesk-desktops_3">STEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops<a name="STEP4_win7"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, right-click the unattend.exe tool and choose  <b>Run as administrator</b>. The unattend builder form opens.</p>            </li>            <li>                <p>Complete  the unattend form.</p>                <ul>                    <li>Product key activation<ul><li>For KMS activation, select KMS Server.</li><li>For KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.</li><li>For Retail Licensing with a MAK, select Retail with MAK, and the MAK.</li></ul></li>                    <li>Domain Join<ul><li>Select Enable if you want to configure the unattend.xml file to join desktops to a specific domain.  If you plan to use AD join scripts, ensure Enable is <i>not</i> selected.</li><li>You can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.</li><li>  If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.</li><li><p>For information about domain join scripts,see the following Support articles:</p><p><a href="troubleshoot_domain_join.htm">Debugging Domain Join Problems in Windows 7 and Windows 2008 R2</a></p><p><a href="http://www.unidesk.com/support/kb/using-powershell-advanced-domain-join-operations">Using PowerShell for Advanced Domain Join Operations</a></p></li></ul></li>                    <li>Local Administrator account<ul><li>If you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.</li><li>If you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.</li><li>You can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled.  However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.</li></ul></li>                    <li>Time zone<ul><li>Select the time zone.  If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, <i>not</i> the display setting.  A list of time zone settings can be found <a href="http://technet.microsoft.com/en-us/library/cc749073(v=ws.10).aspx">here</a>.</li></ul></li>                    <li>Disabling automatic activation<ul><li>Select this option if you plan to use the Microsoft Volume Activation Management Tool.</li></ul></li>                </ul>            </li>            <li>                <p>Click <b>Save File</b>. </p>            </li>        </ol>

<h3 id="step-4-optional-optimize-the-os-image-for-the-unidesk-environment_3"><a class="toclink" href="#step-4-optional-optimize-the-os-image-for-the-unidesk-environment_3">STEP 4: (Optional) Optimize the OS Image for the Unidesk environment<a name="STEP6_win7"></a></a></h3>
<ol>            <li>                <p>In the c:\windows\setup\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.</p>            </li>            <li>                <p>Follow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.</p>                <p>If you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called <b>Disable Unnecessary Services to Save Memory and CPU</b>, <i>deselect</i> the option to <b>Disable Offline File Service</b>, and click <b>Save File</b>. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.  </p>            </li>        </ol>

<h3 id="step-5-if-using-pvs-follow-these-steps-to-avoid-ghost-nics"><a class="toclink" href="#step-5-if-using-pvs-follow-these-steps-to-avoid-ghost-nics">STEP 5: If using PVS, follow these steps to avoid ghost NICs</a></h3>
<ol>            <li>Install KB2550978 hotfix.</li>            <li>Reboot the VM,</li>            <li>                <p>Enter the commands: </p><pre>set devmgr_show_nonpresent_devices=1devmgmt.msc</pre>            </li>            <li>Remove any ghost NICs.</li>            <li>Reboot the system.</li>        </ol>

<h3 id="step-6-create-a-vmware-snapshot-of-the-os-image"><a class="toclink" href="#step-6-create-a-vmware-snapshot-of-the-os-image">STEP 6: Create a VMware snapshot of the OS Image<a name="STEP2_win7"></a></a></h3>
<ol>            <li>                <p>Create a VMware snapshot of the OSimage so you can return to this state at any time.</p>                <p><span>Important:</span> It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning  to this state requires rebuilding the image.</p>            </li>        </ol>

<h3 id="step-7-install-the-unidesk-software-onto-the-os-image"><a class="toclink" href="#step-7-install-the-unidesk-software-onto-the-os-image">STEP 7: Install the Unidesk software onto the OS Image<a name="STEP5_win7"></a></a></h3>
<ol>            <li>In the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).</li>            <li>                <p>The installation prompts for   the location of the unattend.xml file (the default location is c:\windows\panther).</p>            </li>        </ol>

<p>Once this is done, you are ready to <a href="../deploy_os_layer_create_first">create a Unidesk Operating System Layer</a><a href="../deploy_os_layer_create_first">.</a></p> 

                </div>
              </div>

            </div>
          </div>

        </section>

      </div>
    </div>
    <!--<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ajitchelat/AppDNA-SDK.git" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span class="prev"><a href="../layer_os_image_prep_co4/"><i class="fa fa-angle-left"></i> Previous</a></span>
      
      
        <span class="next"><a href="../layer_os_image_prep_xs4/">Next <i class="fa fa-angle-right"></i></a></span>
      
    </span>
	<div class="footer-right">
		<ul class="social-links">
			<li class="list-inline"><a href="https://twitter.com/citrix"><i class="fa fa-twitter"></i>@citrix</a></li>
			<li class="list-inline"><a href="mailto:support@citrix.com"><i class="fa fa-envelope-o"></i>support@citrix.com</a></li>
		</ul>
		<ul class="inner-pages">
			<li class="list-inline"><a href="http://citrix.com/about/legal">Privacy and Terms</li>
		</ul>
	</div>
</div>-->

  </body>

</html>

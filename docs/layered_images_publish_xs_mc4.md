[Publish Layered Images](layered_images_publish_co4)
 > Citrix MCS for XenServer
#Publish Layered Images (Citrix MCS for XenServer)
In this article:
<table>            <col></col>            <tbody>                <tr>                    <td>                        <p><a href="#Prerequi"> Prerequisites</a>                        </p>                        <p><a href="#Pub"> Publish a Layered Image</a>                        </p>                    </td>                </tr>            </tbody>        </table>
A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Citrix MCS in your XenServer environment and add it to a catalog for provisioning systems.  In the Connector Configuration wizard, be sure to configure a Virtual Machine Template, so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.
##Prerequisites<a name="Prerequi"></a>
To publish a Layered Image to MCS, you need:
<ul>            <li>One or more Image Templates. </li>        </ul>
##Publish a Layered Image<a name="Pub"></a>
<ol>            <li>                <p>In the Images module, select one or more Image Templates that you want to publish.</p>            </li>            <li>                <p>From the Action menu, select <b>Publish Layered Image</b>.</p>            </li>            <li>                <p>On the Confirm and Complete page, select <b>Publish Layered Images</b>.  For each Image Template this starts a task called, <i>Publishing Layered Image</i>. When each task completes, the task description provides the information you need to navigate to the image in your environment. </p>                <p>At the end of the image creation process:</p>                <ul>                    <li>                        <p><b>Unidesk powers on the VM</b> - This will enable the guest OS to run and execute any layer scripts via our kmssetup.cmd functionality. This can be used to perform important layer specific steps like activating Microsoft Office which may need to be done before the VM is used to create a view desktop pool/RDS farm or recompose them. The mechanism used to execute these scripts can vary, including our own kmssetup.cmd functionality, run-once support, or even manual execution. It is expected that once all scripts are run or other manual steps are taken and the VM is in the desired state, a guest OS shutdown will be initiated either by the scripts, or by the user (if using the kmssetup.cmd functionality there will a documented process for initiating a shutdown after all layer scripts and other kmssetup functionality is complete).</p>                    </li>                    <li>                        <p><b>When the Task changes to Action Required, shut down the VM and take a snapshot</b> - The status then changes to <i>Done</i>. </p>                    </li>                    <li>                        <p><b>If you want the VMto shut down on its own, you can specify a script to run when you publish Layered Images</b> - For details about enabling and using Scripts, see the instructions for the <a href="connector_config_fields_xs_mc4.htm">MCSfor XenServer</a> Connector Configuration.  </p>                    </li>                </ul>                <p>When the task completes, the task description provides the information you need to navigate to the image in your environment.</p>            </li>            <li>                <p>Use the information in the expanded Packaging Disk Task to navigate to the location in your environment where the Layered Image has been published.</p>            </li>        </ol>
Next you can move the image to a collection or other location for provisioning servers.



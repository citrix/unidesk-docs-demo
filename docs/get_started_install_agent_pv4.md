[Set up Unidesk](landing_set_up_co4)
 > Install the Unidesk Agent (if using PVS or Connector Scripts)
#Install the Unidesk Agent (required for PVS and Connector Scripts)
In this article:
<table>            <col></col>            <tbody>                <tr>                    <td>                        <p><a href="#About"> About installing the Unidesk Agent </a>                        </p>                        <p><a href="#Prereq"> Prerequisites</a>                        </p>                        <p><a href="#Create_Share"> Install the Unidesk Agent</a>                        </p>                        <p><a href="#Manual_Register"> Register with the Unidesk ELM manually</a>                        </p>                        <p><a href="#Next"> Next step</a>                        </p>                    </td>                </tr>            </tbody>        </table>
##About installing the Unidesk Agent <a name="About"></a>
The Unidesk Agent enables the Unidesk Enterprise Layer Manager (ELM) or a Unidesk Packaging Machine VM to run PowerShell commands locally. If you supply  the proper credentials, the agent can run PowerShell commands as a specific user. 
The Unidesk Agent is required in cases where one of your Connector Configurations  launches a PowerShell script. This includes Connector Configurations you use to:
<ul>            <li>Publish Layered Images to a provisioning system. </li>            <li>Package Layers in your hypervisor environment.</li>        </ul>
The Unidesk Agent installer prompts you to register the agent with a Unidesk ELM. If you do not register the agent during installation, you can manually register it later. However, keep in mind that the PowerShell scripts will not run until the agent is registered with the ELM. 
##Prerequisites<a name="Prereq"></a>
Before you install the Unidesk Agent, you must have the following requirements on the system where you are installing the Unidesk Agent:
<ul>            <li>                <p>An account with administrator privileges </p>            </li>            <li>                <p>.NET 4.5</p>            </li>            <li>                <p>PowerShell 3.0 or greater</p>            </li>            <li>                <p>PowerShell Snap-in</p>                <p>Before using the Unidesk Agent on a PVS server you must ensure the PowerShell Snap-in is installed. This is a manual step. </p>                <ul>                    <li>                        <p>For PVS 7.7 and later, you must install the Powershell Snap-in <span>Citrix.PVS.Snapin.dll</span>. </p>                    </li>                    <li>                        <p>For PVS 7.6 and PVS 7.1, you must install <span>McliPSSnapIn.dll</span>. Use the <span>installutil.exe</span> to install the Snap-in.</p>                        <p>Example (7.6): </p>                        <ol>                            <li>                                <p>From a command prompt, go to:</p>                                <p><code>c:\program files\citrix\provisioning services console</code>                                </p>                            </li>                            <li>                                <p>Run this command:</p><pre>"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe" McliPSSnapIn.dll</pre>                            </li>                        </ol>                        <p>Example (7.7):</p>                        <ol>                            <li>                                <p>From a command prompt, go to:</p>                                <p><code>c:\program files\citrix\provisioning services console</code>                                </p>                            </li>                            <li>                                <p>Run this command:</p><pre>"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe" Citrix.PVS.snapin.dll</pre>                            </li>                        </ol>                    </li>                </ul>                <p>On Windows 2008 R2, you must also enable PowerShell remote commands. For background information, see this Microsoft article:</p>                <p>https://technet.microsoft.com/en-us/library/hh849694.aspx</p>                <p>If your 2008 R2 OS does not have PowerShell remoting enabled, run the following PowerShell command on the PVS server:   </p><pre>Enable-PSRemoting</pre>            </li>        </ul>
##Install the Unidesk Agent<a name="Create_Share"></a>
<ol>            <li>                <p>Log in as an administrator on the system where you are installing the agent. </p>            </li>            <li>                <p>Download the Unidesk Agent from the Unidesk Download page. </p>            </li>            <li>                <p>Copy the <span>Unidesk_agent_installer.exe</span> file from the Unidesk Agent folder to a convenient location on the PVS server.</p>            </li>            <li>                <p>Run the <span>Unidesk_agent_installer.exe</span> as Administrator, and when prompted, enter the path to the directory where you want to install the Unidesk Agent. The default location is <span>C:\\Program Files (x86)\Unidesk\Agent</span>.</p>                <p>The Unidesk Agent installer checks to see if all <a href="#Prereq"> Prerequisites</a> are present. If any prerequisites are missing, the installer reports this and exits without installing. </p>            </li>            <li>                <p>The installer prompts you for an Agent Port number. You can accept the default port number (8016) or specify a different one if the default port is already in use.</p>            </li>            <li>                <p>The installer prompts you for the credentials (<i>address</i>, <i>username</i>, and <i>password</i>) for your Unidesk ELM. Register the Unidesk Agent with the ELM by entering the IP address and login credentials for a Unidesk Management Console (UMC) user on the ELM with Administrator privileges, (for example, the credentials you use to log into the UMC). </p>                <p><b>Note:</b> If the Unidesk ELM is not available yet or you choose not to register with it now, you can manually register at a later time using the procedure described in <a href="#Manual_Register"> Register with the Unidesk ELM manually</a>. </p>            </li>            <li>                <p>Click <b>Finish</b> to exit the wizard.</p>            </li>        </ol>
The Unidesk Agent registration appears in the Audit log for the Management Service in the Unidesk Management Console.
##Register with the Unidesk ELM manually<a name="Manual_Register"></a>
If the Unidesk Agent was not registered with a Unidesk ELMduring installation, you can register it later by using the following procedure.
To manually register the Unidesk Agent with the ELM:
<ol>            <li>                <p>As an <i>administrator</i>, log in to the server where you installed the Unidesk Agent.</p>            </li>            <li>                <p>Open a command window (cmd.exe) as administrator and navigate to the directory where the Unidesk Agent is installed. (The default location is <span>C:\\Program Files (x86)\Unidesk\Agent</span>.)</p>            </li>            <li>                <p>Run the following command, using the IP address of the ELM where indicated: </p>                <p><span>Unidesk.Agent.Service.exe register /i /e:<i>IP_address_of_ELM</i> /u:Administrator</span> </p>            </li>            <li>                <p>When prompted, enter the password for a user who has Administrator privileges in the Unidesk Management Console (UMC) on the ELM. </p>            </li>            <li>                <p>When the registration process completes, a message appears informing you of the successful outcome. The Unidesk Agent registration appears in the Audit log for the Management Service in the UMC.</p>            </li>        </ol>
If the process does not succeed, examine the ```\Unidesk\Agent\Logs\unidesk.agent.log```
 file in the Unidesk Agent installation directory. You can also view Help for the Unidesk Agent command line options by running the following command: Unidesk.Agent.Service.exe /?.
##Next step<a name="Next"></a>
[ Connect to a Directory Service](users_dir_service_co4)[        ](users_dir_service_co4)

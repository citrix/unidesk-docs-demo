[OS Layer](layer_os_co4)
 > From Azure
#Create an OS Layer (Azure)
In this article:
<table>            <col></col>            <tbody>                <tr>                    <td>                        <p><a href="#Before"> Before you start</a>                        </p>                        <p><a href="#Create"> Create an OS Machine in Azure</a>                        </p>                        <p><a href="#Prepare"> Prepare the OS Image (Windows 2012 R2)</a>                        </p>                        <p><a href="#Import"> Import the OS Image into a new OSLayer</a>                        </p>                    </td>                </tr>            </tbody>        </table>
The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you need.
The OS Layer is created using a virtual machine in your infrastructure and the Windows Operating System that you want to use for your Layered Images. You can import the OS from your Azure environment or from the Network File Share attached to the Unidesk ELM. 
Note: The OSimage must be created from a Microsoft ISO, rather than an existing template. 
##Before you start<a name="Before"></a>
<ul>            <li><a href="get_started_deploy_unidesk_elm_az4.htm">Deploy ELM from the Microsoft Azure Marketplace</a>            </li>            <li><a href="get_started_setup_fileshare_co4.htm">Configure a Network File Share</a>            </li>        </ul>
##Create an OS Machine in Azure<a name="Create"></a>
To create an OS Layer, you create a virtual machine in Azure, prepare the OS in Azure, and then import the resulting OS Disk into Unidesk to create the OSLayer.
<ol>            <li>                <p>In the <a href="https://portal.azure.com/">Microsoft Azure portal</a>, create a new VM from the "Windows Server Remote Desktop Session Host Windows Server 2012 R2" image (<b>New > Compute > Virtual Machine > From Gallery > Windows Server Remote Desktop Session Host Windows Server 2012 R2</b>).</p>            </li>            <li>                <p>Choose <b>Resource Manager</b> from the <b>Select a deployment model</b> option list and click <b>Create</b>. </p>                <p><b>Note:</b> Unidesk for Azure does not support the <b>Classic</b> option from the <b>Select a deployment model</b> option list.</p>            </li>            <li>                <p>Complete the Create virtual machine wizard to create the OS machine.</p>                <ul>                    <li>The name of the new server machine you specify must comply with Azure naming conventions. </li>                    <li>The User name and Password of the new server machine you specify becomes the User name  and Password of any Packaging Machines that are subsequently created containing this OS Layer.</li>                    <li>Be sure that the value for the Resource group location matches the Storage account location that you configured in the Platform Connector Configuration.</li>                </ul>            </li>        </ol>
##Prepare the OS Image (Windows 2012 R2)<a name="Prepare"></a>
<ol>            <li>                <p>After the new server machine has been successfully created, reboot the machine, and log into it remotely.</p>            </li>            <li>                <p>Turn off Windows Automatic Updates (<b>Control Panel > System and Security > Windows Update > Change Settings</b>).</p>            </li>            <li>                <p>From the new machine, open a web browser, navigate to the <a href="http://www.unidesk.com/support/unidesk-4-download">Unidesk Download Center</a> and download the Unidesk OS Machine Tools. </p>            </li>            <li>                <p>Rename or delete the "Unattend.wsf" file  in the C:\Windows\OEM directory. </p>                <p><b>Note:</b> Do <i>not</i> use the Unattend.exe, as this is <i>not</i> needed and will cause issues with Azure.</p>            </li>            <li>                <p>On the new server machine, run the setup_x64.exe file to install the Unidesk drivers on the OS Machine.</p>            </li>            <li>                <p>Ensure that this machine is <i>not</i> joined to a domain.</p>                <p><b>Note:</b> Session Hosts will join a domain when you provision them from a Layered Image. </p>            </li>            <li>                <p>Optionally, you can shut down the new OS machine.</p>                <p><b>Notes:</b></p>                <ul>                    <li>Before you can import the OS Disk (as described in the following section), the state of the OS Machine must be either Stopped, Stopped (deallocated), or Running. Unidesk cannot import the OS Disk if the OS machine is in a Starting or Updating state. </li>                    <li>You must perform any pending reboots to the OS machine before importing the OSDisk.</li>                </ul>            </li>        </ol>
##Import the OS Image into a new OS<a name="Import"></a>##Layer<a name="Import"></a>
To import an OS disk into Unidesk:
<ol>            <li>                <p>In the Unidesk ELM, select <b>Layers > OS Layers</b> and click <b>Create OS Layer</b> in the Action bar. This opens the Create Operating System Layer Wizard.</p>            </li>            <li>                <p>In the Layer Details tab, specify a <b>Layer Name</b> and <b>Version</b>, both required values. Optionally, you can enter <b>Descriptions</b> of the Layer and Version, and change the <b>Max Layer Size</b> to accommodate the OS you are going to import. For details, see more about these values <a href="#Referenc">below</a>.</p>            </li>            <li>                <p>In the Connector tab, choose a <b>Connector Configuration</b> for the platform where you'll be publishing your Layered Images. If the configuration you need is not listed, add a <b>New</b> one and select it from this list. For information about creating a new Platform Connector Configuration, see <a href="connector_config_fields_az4.htm">Create a Connector Configuration</a>.</p>                <p><b>Note:</b> Alternatively, if you have a *.vhd file of the OS disk in your Network File Share, you can select the file share instead of a Unidesk Connector.</p>            </li>            <li>                <p>In the Import Disk Details tab, enter the name of the Azure Resource Group that contains the OS disk and the name of the OS disk, both required values.</p>                <p><b>Note:</b> If you specified a file share on the Connector tab, enter the name of the OS disk residing on that file share or click <b>Browse</b> to select it. </p>            </li>            <li>                <p>In the Icon Assignment tab, select an icon image to assign to this Layer.</p>            </li>            <li>                <p>In the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click <b>Create Layer</b>. If you enter comments, they appear in the Information view Audit History.</p>            </li>        </ol>
When the task completes, the new OS Layer in the Unidesk Management Console displays a "Deployable" status.
##Reference: Create Operating System Layer Wizard values<a name="Referenc"></a>
<ul>            <li><i>Layer Name</i> - (Required) A name that will let you know what app(s) the layer will be used for, for example, 2012_64_OS. Layer Names can be from 1 to 100 characters in length.</li>            <li><i>Layer Description</i> - (Optional) Enter a description of the OS Layer.</li>            <li>                <p><i>Version</i> - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the OSLayer. It may be useful to include the date in the version name. Version names can be from 1 to 100 characters in length. </p>            </li>            <li><i>Version Description</i> - (Optional) Enter a description of the OS version.</li>            <li><i>Max Layer Size</i> - (Optional) Lets you specify how large the OS is that you are going to import. The default is 30 GB. </li>            <li><i>Select a Connector Configuration</i> - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a <b>New</b> one and select it from this list. If you want to change the settings of a Platform Connect, select it and click <b>Edit</b>.</li>            <li><i>Resource Group</i> - (Required) The name of the Azure Resource Group containing the OS Import disk.</li>            <li><i>Virtual Machine Name</i> - (Required) The name of the server machine you created in Azure.</li>            <li><i>OS Disk</i> - (Required) If you chose a file share in the Connector tab, enter the path to the *.vhd file here or click <b>Browse</b> to select it.</li>            <li><i>Icon Assignment</i> - You can select a default image or browse to select an image of your own. Icon images must have a .jpg or a .png file format.</li>        </ul>




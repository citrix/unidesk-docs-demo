{
    "docs": [
        {
            "location": "/", 
            "text": "Welcome to Citrix App Layering 4\n\n\nIn this article:\n\n\nThe ultimate in application management simplicity\nProvision servers in any environment\nDeliver applications with ease\nA simple addition to your environment\nGet started\n\n\n\nThe ultimate in application management simplicity\n\n\nUnidesk makes it easier to manage your Windows applications. Regardless of which hypervisor or provisioning service you use, Unidesk can help you manage your applications and operating systems.\n\n\nUnidesk separates the management of your Operating System and applications from your infrastructure. With Unidesk you can install each of your applications and operating system patches once, and use them as part of any image you deploy. You can publish Layered Images as open standard virtual disks usable in any environment. This allows you to maintain a single Windows installation, and a single copy of each application, that you use for all of your images across all of your virtual environments.\n\n\nUnidesk wraps each of your applications in a Layer, and stores the Layers as virtual disks.\nYou can pull together any combination of these App Layers and an OS Layer as part of a Layered Image, and publish it to your target platform.\nThat means that you can install an application or an operating system once, and deploy it as part of any number of images.\n\n\n\nProvision servers in any environment\n\n\nUnidesk lets you to package any Windows app as a virtual disk \nLayer\n  and deliver it, installation-free, to session hosts. With Unidesk Layering, you can:\n\n\nInstall and manage a single copy of your Windows OS and a single copy of each of your applications in Layers.\nSelect any combination of Layers to create Layered Images that are deployable as Session Hosts.\nDeploy those Layered Images to virtual machine session hosts, making the applications available to users.\n\n\n\nNew applications, application updates, and Windows patches can be delivered to an entire RDSH farm with a single image update.\n\n\nDeliver applications with ease\n\n\nUsing the Unidesk Management Console, you can:\n\n\nLayer Applications and deliver them as read-only virtual disks to session hosts. Layering is faster and easier than app virtualization and is compatible with more apps. Layers have the look and feel of a local installation and enable full application interoperability.\nLayer a Windows OS and deliver it as a read-only virtual disk to all session hosts. Patch an OS layer once to update an entire RDSH server farm.\nMaintain platform-independent OS and App Layers by creating Platform Layers to hold infrastructure-related software and settings.\nProvision RDSH VMs. You can create custom RDSH virtual machines by assigning any combination of compatible OS and App layers in any order.\n\n\n\nA simple addition to your environment\n\n\nThe heart of the Unidesk deployment is the Enterprise Layer Manager (ELM), a virtual appliance that you deploy in your environment. The ELM hosts the Unidesk Management Console (UMC), a friendly interface where you create Unidesk Layers and assign the OS Layer and App Layers for each of your Layered Images.\n\n\nUnidesk Layers\n\n\nWith Unidesk you can create an OS Layer or App Layer once, and use it to create any number of images. You can then update the OS or application by adding a new Version to the Layer for each patch or update that you apply.\n\n\nIn App Layers you can deploy virtually any applications compatible with the OS. Each App Layer can include one or more applications. When it's time to upgrade an application, you can add a new version to the Layer for the latest update.\n\n\nPlatform Layers are designed to support your environment. A Platform Layer containing your hypervisor tools and settings makes it easy to create layers using VMs in your hypervisor environment. A Platform Layer containing your hypervisor, provisioning service, and connection broker software isolates App and OS Layers from the infrastructure where they will be published.\n\n\nLayered Images for provisioning Session Hosts\n\n\nImage Templates are where you choose the Operating System and Layer assignments for an Image. You can include OS and App layers in any number of Image Templates. Using an Image Template and a Platform Layer, you can publish a Layered Image to your provisioning service, hypervisor, or network file share .\n\n\nYou can publish Layered Images as virtual disks to any location to which the ELM has access, and use the disks to provision as many servers as you need.\n\n\nPlatform Connectors\n\n\nA Unidesk Platform Connector configured with the credentials for a specific location in your virtual environment, allows Unidesk to publish the Layered Images and provision servers in a specific location.\n\n\nCompatibility\n\n\nFor compatibility details, see Supported Platforms.\n\n\nGet started\n\n\nIf you haven't yet started your free trial, you can find out how to install Unidesk \nhere\n.\n\n\nUnidesk Release Notes and Platform Support\n\n\nFind out what's new, what to watch out for, and what platforms are supported in this release.\n\n\nUnidesk 4 Release Notes\n\n\nIn this article:\n\n\nWelcome to Unidesk 4.0.8!\nUnidesk 4 Release Notes\nNew in Unidesk Labs!\nSupported Platforms\nUpgrade path\nKnown issues and considerations\nHow can I contact Unidesk?\n\n\n\nWelcome to Unidesk 4.0.8!\n\n\nThis release adds full support for Nutanix AHV, making Unidesk the only solution to support all leading hypervisors. You now have complete agility and flexibility in deciding where to host your Windows workspaces, today and into the future.\n\n\nWe have also made performance improvements and added support for Windows Server 2016.\n\n\nYou'll also get your first look at the Unidesk 4 User Layer, now supported in Unidesk Labs. Those of you who have been waiting to test the ability to persist user settings, data, and applications in non-persistent VDI environments need wait no longer!\n\n\nWhat's new in this release?\n\n\nFull support for Nutanix AHV.\n Unidesk now fully supports Nutanix AHV, adding to our existing support for Hyper-V, vSphere/ESX, Citrix XenServer, and Azure. Like the other platforms, you can now use Nutanix AHV to host the Unidesk Enterprise Layer Manager (ELM) virtual appliance; package App Layers and Layer versions; create and publish Layered Images; and use Elastic Layering to deliver custom applications to both virtual desktops and XenApp/RDSH sessions at login. You can also deliver Layers and Layered Images to all supported platforms without costly re-packaging or re-imaging. Moving your users from one end user computing environment or hypervisor to another, and managing across multiple environments has never been easier.\nUnidesk Connector for Citrix MCS support for Nutanix AHV.\n You can now publish Unidesk Layered Images directly to Citrix Machine Creation Services (MCS) running on Nutanix AHV. You'll be able to manage image content (OS and Apps) once with Unidesk and continue to use MCS to manage image delivery for both your XenApp and XenDesktop environments. Instead of having to update Windows and common applications once for every delivery group and MCS image, you'll only have to apply updates once.\nWindows Server 2016 Support.\n You can now use Windows Server 2016 as a supported operating system (OS) layer for Citrix XenApp and RDSH published application and desktop deployments. Import your Windows Server 2016 OS and you can start building App Layers and Platform Layers on top of it!\nImproved performance when Creating App Layers on VMware vSphere.\n You can configure the VMware vSphere Connector to cache boot and packaging disks and reuse them. Once these disks have been cached as part of creating your first App Layer, the time it takes to create subsequent App Layers is cut in half.\nLayer Management updates.\n We made several enhancements to general layer management usability including improvements to the Virtual Appliance Configuration Tool, the ability to edit the Layer version description, and listing the OS type in the OS Layer detail information.\nImprivata OneSign Single Sign-On.\n Unidesk is fully compatible with Imprivata OneSign for single sign-on efficiency. Imprivata can be packaged as a Unidesk application layer to make distribution to all virtual workspaces fast and easy.\nUnidesk Roles.\n Previously released in Labs, Unidesk Roles are now generally available and with a new capability to assign Roles to AD Groups in addition to directly assigning Roles to individual users.\nElastic Fit.\n Also previously released in Labs, Elastic Fit is now Generally Available. This feature alerts you if an Application Layer can be delivered as an Elastic Layer at login. Unidesk gives you the option of delivering applications as Layered Images or as Elastic Layers, Elastic Fit will advise you on which of Unidesk's layer delivery options to use.\nUser Layer (Unidesk Labs).\n You can now test the ability to persist user profile settings, data, and user-installed applications in non-persistent VDI environments with the new User Layer. Initially, the User Layer will support Windows 7 64-bit environments for Citrix XenDesktop, VMware Horizon View and View JIT. Additional operating systems and session environments will be supported going forward.\n\n\n\nNew in Unidesk Labs!\n\n\nUser Layers (Unidesk Labs)\n.\nYou can now test the ability to persist user profile settings, data, and user-installed applications in non-persistent VDI environments with the new User Layer. Initially, the User Layer will support Windows 7 64-bit environments for Citrix XenDesktop and VMware Horizon View. Additional operating systems and session environments will be supported going forward.\n\n\n\nFor the steps to enable Unidesk Labs features, click \nhere\n.\n\n\nSupported Platforms\n\n\nFor information about Unidesk-supported platforms, see Supported Platforms.\n\n\nUpgrade path\n\n\nYou can upgrade from 4.0.x to the current release.\n\n\nKnown issues and considerations\n\n\nUser Layer (Unidesk Labs)\n\n\nMS Office should be in the Layered Image. If using add-ins or Office 365, you \nmust\n include Office in the Layered Image, not in the User Layer. If not, you will have activation issues. (UNI-53474)\nThere are issues with Windows Search when using a User Layer. (UNI-53320), (UNI-54524), (UNI-54520)\nRed '\nX\n' network adapter icon indicates there's an issue even when the network is functional. When using a User Layer, the network icon will appear as a red x, even when everything is functional. You can ignore the red '\nX\n'. (UNI-53443)\n\n\n\nCommon across platforms\n\n\nTasks created prior to this release do not have fully qualified owners and can only be canceled by an Administrator. (UNI-52741)\nApp may appear to load slowly on a user's session. For applications that automatically update, like Chrome and Firefox, updates should be turned off. Windows will prompt the user to make changes with Admin rights even though the user does not have those rights. Instruct the user to click \nNo\n when prompted, and the application will load successfully.\nUnidesk Agent requires .NET Framework 4.5, but the installer lists 4.0 as a prerequisite.The Unidesk Agent needs .NET Framework 4.5 but lists 4.0 as a prerequisite. This causes the installer to fail when it reaches \"Starting services\", and the Unidesk Agent logs show the service trying to start up repeatedly. Please install .NET Framework 4.5 as a prerequisite for the Unidesk Agent. (UNI-50769)\nUser receives alert on first launch of an elastically assigned Skype Layer.When a Skype Layer is elastically assigned, the user receives this alert the first time the app is launched, \"The Installer has insufficient privileges to modify this file: \nurl\n.\" If the user clicks the \nIgnore\n button, Skype opens as expected. (UNI-52164) \nUse the same hypervisor when adding a Version to your OS Layer. When adding a Version to an OS Layer, you must package the Layer on the same hypervisor from which you imported the OS during Layer creation. (UNI-44372)\nAfter adding new disks to the ELM, be sure to reboot. When adding disks to expand storage, a reboot of the ELM is recommended after the disk expansion wizard has completed the operation. (UNI-53580)\n\n\n\nElastic Layering\n\n\nElastic Layers require .NET Framework 4.5.If you are using Unidesk Elastic Layers, .NET Framework 4.5 must be installed on any Layered Image where Elastic Layers are enabled.\nEmpty directories visible to Windows Explorer users when Unidesk drivers are running. When an image has been enabled with Elastic Layering, a user using Windows Explorer to view files and directories may be able to see empty directories associated with other sessions using Elastic Layering if they also use Windows Explorer to browse files. Directories explored in the other session may create folders visible to all sessions that have the rights to browse that directory. The directories and the contents of them will not be visible to users who do not have access to the volume.\nIf using Elastic Layer Assignments with Windows Server 2008 or Windows 7, your fileshare must be created with a sector size of 512. \n For details about this issue and related OS updates, see the Microsoft articles about \nMicrosoft support policy for 4K sector hard drives in Windows\n, and \nUpdate that improves the compatibility of Win 7 and Win Server 2008 R2 with Advanced Format Disks\n. (UNI-48984)\nWhen using Elastic Layer Assignments, Persona Management in Horizon View is \nnot\n supported. Although Unidesk supports Horizon View 6.1 and later, Elastic Layer Assignments do not work with these versions of View Persona Management. (UNI-53639) \n\n\n\nElastic Layering MS Office\n\n\nShortcuts to elastically assigned Office apps may be visible on the Start menu for users who are not assigned the apps. Although these shortcuts are visible, they only work for users who are assigned the apps. (UNI-49687)\nWhen MS Office is assigned elastically, use built-in license activation scripting. For best results when using office elastically, consider using built-in license activation scripting and adding c:\\windows\\setup\\scripts\\officeactivate.cmd to the script path when finalizing the Office App Layer or editing its properties. (UNI-50467)\nWhen elastically layering MS Office, do not install One Note. Instead, include OneNote in the Layered Image. The One Note printer driver allows other Office apps to print to One Note. For further details, refer to the \nMicrosoft Office Recipe\n. (UNI-50449)\n\n\n\nWindows 10\n\n\nWindows 10 upgrades require a 60 GB disk for the OS Layer Version. When adding a Version for upgrading your Windows 10 OS Layer, be sure to change the Max Layer Size from the default of 30 GB to the required 60 GB. (UNI-52422)\nAdditional step required when upgrading a major Win 10. During a major upgrade, for example when upgrading from 1511 to 1607, Windows 10 sometimes creates a Recovery Volume as a new partition on the same disk as the OS Layer Version. This volume should always be removed before you finalize the OS Layer Version. Otherwise, the recovery volume can cause desktops to fail to boot correctly. For the steps to safely remove a recovery volume, click \nhere\n. \n\n\n\nCitrix PVS\n\n\nWhen creating an Image Template, the template's target device hardware settings must match the Windows OS and Platform Layer settings. Make sure the target device hardware settings match the OS and Platform layer hardware settings, especially the number of CPUs. If they don't match, you can get a \nreboot required\n message when the published image is booted. (UNI-50799, UNI-46333, UNI-51599)\nWhen using PVS, you must disable IPv6 in the OS Layer. If this is configured in the Platform Layer instead of in the OS Layer, when the resulting PVS machines boot, they will lose their network connection and hang. (UNI-53600)\nIf permissions are wrong when publishing an image, you may get an error message that states that the operation has timed out. (UNI-54516)\nAlthough the UMC allows image names that contain a period (\".\"), those names fail in the PVS environment. Do not include a period in the name. UNI-54263)\n\n\n\nXenServer\n\n\nWhen preparing your OS image for use in XenServer, you must open port 5900. (UNI-50846)\nCreating a Unidesk Connector Configuration that points to a \nslave\n node in a XenServer pool produces an unexpected error message. To avoid this issue, only use the \nmaster\n node when creating Connector Configurations. (UNI-52454) \n\n\n\nVMware Horizon View\n\n\nElastic layers are only supported with floating desktop pools. (UNI-53442) \n\n\nMicrosoft Azure\n\n\nThe Azure File Share \nfeature\n is not supported. However, you must create an NFS or SMB file share in Azure to use with Unidesk. (UNI-42272)\nPublishing Layered Images simultaneously to the same Azure resource group fails. Either deploy one at a time, or deploy the Layered Images to different resource groups.(UNI-43376)\nUsing a Fully Qualified Domain Name (FQDN) in Azure can fail if not entered in the format Azure expects. When deploying in Azure, the Azure template requires the FQDN in a specific format, or it will fail. Click \nhere\n for details. (UNI-51587) \n\n\n\nMicrosoft Hyper-V\n\n\nWhen using Elastic Layering in Hyper-V, you must use \nunmanaged\n RDS pools. (UNI-53545) \n\n\n\nImprivata\n\n\nImprivata App Layers must be created with the appropriate broker Platform Layer as a prerequisite. This is critical for Citrix PVS/MCS and Horizon View environments\n\n\n\nHow can I contact Unidesk?\n\n\nWe welcome your feedback about this release.\n\n\nUse our online \nForum\n to talk directly with Unidesk employees and other organizations deploying Unidesk.\n\n\n\nFor product issues and questions, open a \nSupport Case\n.\n\n\n\nWe look forward to hearing what you think about Unidesk 4!\n\n\nSupported Platforms\n\n\nIn this article:\n\n\nHypervisor\nImage publishing\nOperating System for Layered Images\nDirectory Service\nInternet browser\n\n\n\nHypervisor\n\n\nUnidesk Enterprise Layer Manager (ELM)\n\n\nThe Unidesk ELM can be installed in the following environments:\n\n\nAzure Resource Manager\nCitrix XenServer 6.5, 7.0\nMicrosoft Hyper-V, Windows Server 2012 R2\nNutanix Acropolis\nvSphere vCenter 5.5.x, 6.0.x\n\n\n\nNetwork File Share protocol\n\n\nServer Message Block (SMB)\nNetwork File System (NFS)\nNote:\n \nElastic Layers\n can only use SMB file shares. NFS shares are not supported for Elastic Layering.\n\n\n\nNetwork connection\n\n\nA 10 GB connection is recommended between the Unidesk ELM and the file share.\n\n\n\nImage publishing\n\n\nUnidesk 4 lets you publish to these platforms:\n\n\nCitrix MCS for Nutanix AHV\nCitrix MCS for vSphere\nCitrix MCS for XenServer\nCitrix PVS 7.1, 7.6 - 7.9, 7.11 - 7.12 with recommended network speeds to the PVS Store of 10 GB.\nCitrix XenApp and XenDesktop 6.5, 7.0 - 7.11\nMicrosoft Azure, with recommended network speeds to the Azure publishing location of 10 GB.\nVMware Horizon View 6.x, 7.x\nNote:\n View Persona Management is \nnot\n supported with Elastic Layering.\n\n\n\nYou can use Unidesk Layers and Layered Images with other provisioning systems and hypervisors, although the solution is not fully integrated.\n\n\nOperating System for Layered Images\n\n\nWindows Server 2016, 64-bit (Standard and Datacenter Editions)\nWindows Server 2012 R2, 64-bit (Standard and Datacenter Editions)\nWindows Server 2008 R2, 64-bit (Standard and Datacenter Editions)\nWindows 10, 64-bit\nWindows 7, 64-bit\nWindows 7, 32-bit\n\n\n\nUnidesk supports single-byte language packs for the base US English Windows operating system. Language packs must be installed on the OS Machine before importing the OS into a Layer. Language packs installed on a Version added to the OS Layer will not work correctly.\n\n\nDirectory Service\n\n\nMicrosoft Active Directory\n\n\n\nInternet browser\n\n\nThe Unidesk Management Console (UMC) supports the following browsers with Silverlight 4.0 support:\n\n\nInternet Explorer v11\nFirefox v45 and later versions that support MS Silverlight 4.0.\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM)\n\n\nWhere are you installing the Unidesk ELM?\n\n\nInstall the Unidesk ELM in Citrix XenServer\n\n\nReview the prerequisites and follow the steps to install the ELM in Citrix XenServer. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.\n\n\nUnidesk Prerequisites (XenServer)\n\n\nIn this article:\n\n\n \nStorage requirements\nXenServer requirements\n\n\n\nOperating System requirement \n\n\nOS for Layered Images\nYou need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\n\n\n\nStorage requirements\n\n\n350-500 GB Storage Space\nThe Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed.\n40-100 GB network file share (SMB/NFS)\nThe file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.\n\n\n\nCitrix XenServer prerequisites\n\n\nXenServer account and privileges\nA XenServer account (new or existing) to use for Unidesk.\nThe account must have XenServer privileges to:\nCreate and remove virtual disks.\nCopy and delete layers on virtual disks using XenServer file APIs.\nCitrix XenServer software and settings\nAccess to the XenServer Tools to install on the layer.\nXenServer resource information\nThe XenServer info listed in \nCitrix XenServer Connector Configuration\n.\nNetwork access to Unidesk OS Machine Tools\nWhen you create Layer or add a Version to it, the Unidesk Management Console (UMC) uses a Connector Configuration to create a VM called a Packaging Machine for the Layer you are building. The Packaging Machine \nmust\n have access to the Unidesk OS Machine Tools download, which is available on the Unidesk Download page.\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM) (XenServer)\n\n\nIn this article:\n\n\nBefore you start\nDeploy the Unidesk Enterprise Layer Manager (ELM)\nExpand locally attached storage, if needed\nNext Step\n\n\n\nBefore you start\n\n\nTo get started with Unidesk, you will need:\n\n\nA Unidesk account.\nA supported version of Citrix XenServer\n.\nA Virtual Network in XenServer.\nStorage requirements and XenServer requirements listed \nhere\n.\nA XenCenter Client.\n\n\n\nDeploy the Unidesk Enterprise Layer Manager (ELM)\n\n\nUsing this procedure, you will do a basic Unidesk ELM installation on your XenServer Server. Once you complete these steps, use the following sections to \nchange the administrator password\n  (strongly recommended), and configure more advanced options, such as Static IP.\n\n\nDownload the Unidesk installation package, Unidesk_install_xenserver_pkg_4.x.x, from the Unidesk download site. This zip file contains the xenserver_elm_4.x.x.x.ova and other files.\nExtract the xenserver_elm_4.x.x.x.ova file to a folder on your local drive.\nIn your XenCenter Client, select \nFile > Import\n.\nIn the wizard that opens, select the following values:\nImport Source\n - Browse to \nyour\n unique location.\nLocation\n - Choose the XenServer where you want to deploy the ELM.\nStorage\n - Use the default value to put the Unidesk disks on the Local XenServer Storage.\nNetworking\n - Select the correct network for your XenServer configuration.\nSecurity\n - This tab should be grayed out. Click \nNext\n to continue.\nOS Fixup Settings\n - Select \nDon't use Operating System Fixup\n.\nTransfer VM Settings\n - Choose the correct network , and choose \nDHCP\n.\nFinish\n - Review your settings and select \nFinish\n.\nSwitch to \nNotification view\n and wait for deployment to complete. This takes about 20-35 minutes.\nSwitch to \nInfrastructure view\n.\nRename your new appliance:\nSelect your new appliance, which will be named \nCentOS-7_x86_64_build_template_xenserver\n.\nClick \nProperties\n, and enter a good name and description for your new ELM.\n\n\n\nThe new VM created from the Unidesk_ELM.ova file has 8 GB of memory and 4 CPUs.\n\n\nConfigure advanced settings\n\n\nOnce you've completed the ELM installation, you should immediately log into the ELM and:\n\n\nModify the administrator password.\n(Optional) Configure advanced network options, such as Static IP, as needed.\nMake any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.\n\n\n\nThe Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .\n\n\nExpand locally attached storage, if needed\n\n\nIf you need to expand the ELM's local storage, see Manage system storage.\n\n\nNext Step\n\n\nOnce you're satisfied that the ELM is correctly configured and has the required storage space, you can log into the Unidesk Management Console, and begin creating your layers.\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nIn this article:\n\n\nLog into the UMC\nNext step\n\n\n\nLog into the UMC\n\n\nOnce you have \nset up the Unidesk ELM\n, you can log into the Unidesk Management Console, which is the user interface for creating and managing Unidesk Layers and Layered Images.\n\n\nThe following steps explain how to log into the UMC using the default User Name and Password.\n\n\nLocate the VM you created for the Unidesk ELM and determine the IP address for this VM.\nUsing the IP address for the ELM, enter the following URL in a compatible web browser:\nhttp://\n/udmc\nThis displays the Login page for the Unidesk Management Console.\nEnter \nAdministrator\n in the User Name field and \nUnidesk1\n in the Password field to log in to the Unidesk Management Console for the first time.\n\n\n\nNext step\n\n\nObtain a Unidesk license\n\n\nInstall the Unidesk ELM in Azure\n\n\nReview the prerequisites for installing the Unidesk Enterprise Layer Manager in Azure. Next,follow the steps to install the ELM in Azure. You will then be able to log in to the Unidesk Management Console and complete the Unidesk setup.\n\n\nUnidesk Prerequisites (Azure)\n\n\nIn this article:\n\n\nUnidesk Prerequisites (Azure)\nStorage requirements\nAzure-specific requirements\n\n\n\nOperating System requirement \n\n\nOS for Layered Images\nYou need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\n\n\n\nStorage requirements\n\n\n350-500 GB Storage Space\nThe Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed.\n40-100 GB network file share (SMB/NFS)\nThe file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.\n\n\n\nAzure prerequisites\n\n\nBefore installing the Unidesk ELM in Azure, be sure to meet the following prerequisites.\n\n\nNetwork File Share (Azure specifics)\nA file share server in Azure will perform significantly better than an on-premise file share. Even though the \nAzure\n file share feature is not supported, you can use an existing network file share or create a new file share in the Azure environment.\nUsing \nPremium Storage\n is strongly recommended.\nOnly fixed VHD disks will deploy successfully.\nAzure account and subscription\nTo deploy and configure the Unidesk Enterprise Layer Manager, you will need the credentials for an account that has administrative access to your Azure subscription. For more information, refer to the \nMicrosoft Azure Sign in page\n.\n\n\n\nAzure Resource Manager\nUnidesk is designed to work with Azure's new Resource Management (ARM) model. It does not support Azure's Classic deployment model. All resources such as virtual network, file shares and OS machines that Unidesk will work with must be created with Azure Resource Manager. For more information, refer to the \nAzure Resource Manager overview page\n.\nAzure network topology\nBefore deploying the Unidesk Enterprise Layer Manager (ELM), you must define and create your Azure network topology. The ELM and its Network File Share must have network connectivity. However, the ELM does not require network connectivity to the Session Hosts that are created. Unidesk recommends utilizing a site-to-site connection between your corporate and Azure networks to access the Unidesk Management Console on the ELM. For more information, refer to the \nMicrosoft Azure Virtual Network page\n.\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM) with local storage (Azure)\n\n\nIn this article:\n\n\nBefore you start\nDeploy the Unidesk ELM from the Azure Marketplace\nNext Step\n\n\n\nBefore you start\n\n\nTo get started with Unidesk in Azure, you will need:\n\n\nAn Azure subscription\nA Virtual Network in Azure. Your Unidesk deployment in Azure can operate in a point-to-site or site-to-site Virtual Network.\n\n\n\nNote:\n  If you have not already set up a connection to an Azure Virtual Network, see \nhttps://azure.microsoft.com/en-us/documentation/articles/?service=vpn-gateway\n for more information.\n\n\nThe storage and Azure requirements listed \nhere\n\n\n\nDeploy the Unidesk ELM from the Azure Marketplace\n\n\nTo deploy Unidesk for Azure, create a Virtual Machine in the Azure Marketplace using the Unidesk offering. This installs the Unidesk ELM with local storage for Unidesk Layers, Templates, and temporary files.\n\n\nUsing this procedure, you will do a basic Unidesk ELM installation in Azure. Once you complete these steps, use the following sections to \nchange the administrator password\n  (strongly recommended), and configure more advanced options, such as Static IP.\n\n\nOpen a web browser, navigate to the \nMicrosoft Azure portal\n, sign in with your Azure credentials, and click \nNew\n.\nIn the search field in the New panel, type \nUnidesk\n and press \nEnter\n. The window displays Unidesk for Azure as a Publisher. Select it and click \nCreate\n.\nFill out the Basics, Size, and Settings options for creating a new VM.\n\n\n\nNotes:\n \n\n\nIMPORTANT: Record the User name and Password that you specify for the Azure VM for later use, as this becomes the User name and Password for the Administrator account of your Unidesk ELM. There is no root password on the ELM and if you lose the ELM credentials you will have to reinstall the ELM. You may also be asked to furnish the ELM credentials when you contact Unidesk Support. Note that the User name and Password for the ELM (which runs on Linux) is different from the User name and Password of the Unidesk Management Console (which runs on Windows).\nIMPORTANT: Be sure to note the Resource group location you select now as you will require this information later. For more information about resource groups, refer to \nUsing the Azure Portal to manage your Azure resources\n.\nWhen selecting a virtual machine size, Unidesk recommends creating an D3 Standard machine.\nThe name you specify for the new virtual machine must comply with Azure naming conventions.\nSelect a Virtual Network in which HTTP port: 80 is accessible (Public IP can be disabled).\nOn the Monitoring Diagnostics entry, select \nDisabled\n.\n\n\n\nTo complete the process, view the Summary of the options you selected and, when you are satisfied with your selections, click \nOK\n , and click \nPurchase\n .\n\n\nNote:\n  If you experience a failed deployment of a Virtual Machine in Azure, you can obtain more detail regarding the nature of the failure by browsing to the relevant resource group and clicking the related \"(Failed)\" link.\n\n\nConfigure advanced settings\n\n\nOnce you've completed the ELM installation, you should immediately log into the ELM and:\n\n\nModify the administrator password.\n(Optional) Configure advanced network options, such as Static IP, as needed.\nMake any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.\n\n\n\nThe Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .\n\n\nExpand locally attached storage, if needed\n\n\nIf you need to expand the ELM's local storage, see Manage system storage.\n\n\nNext Step\n\n\nOnce you're satisfied that the ELM is correctly configured and has the required storage space, you can log into the Unidesk Management Console, and begin creating your layers.\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nIn this article:\n\n\nLog into the UMC\n\n\nNext step\n\n\nLog into the UMC\n\n\nOnce you have \nset up the Unidesk ELM\n, you can log into the Unidesk Management Console, which is the user interface for creating and managing Unidesk Layers and Layered Images.\n\n\nThe following steps explain how to log into the UMC using the default User Name and Password.\n\n\nLocate the VM you created for the Unidesk ELM and determine the IP address for this VM.\nUsing the IP address for the ELM, enter the following URL in a compatible web browser:\nhttp://\n/udmc\nThis displays the Login page for the Unidesk Management Console.\nEnter \nAdministrator\n in the User Name field and \nUnidesk1\n in the Password field to log in to the Unidesk Management Console for the first time.\n\n\n\nNext step\n\n\nObtain a Unidesk license\n\n\nInstall the Unidesk ELM in Hyper-V\n\n\nReview the prerequisites and follow the steps to install the ELM in Hyper-V. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.\n\n\nUnidesk Prerequisites (Hyper-V)\n\n\nIn this article:\n\n\n \nStorage requirements\nHyper-V-specific requirements\n\n\n\nOperating System requirement \n\n\nOS for Layered Images\nYou need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\n\n\n\nStorage requirements\n\n\n350-500 GB Storage Space\nThe Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed.\n40-100 GB network file share (SMB/NFS)\nThe file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.\n\n\n\nHyper-V prerequisites\n\n\nBe sure the Hyper-V VM where you are installing the ELM meets the following prerequisites.\n\n\nA Windows Hyper-V 2012 R2 server\nA Virtual Network in Hyper-V\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM) (Hyper-V)\n\n\nIn this article:\n\n\nBefore you start\nDeploy the Unidesk Enterprise Layer Manager (ELM)\nNext Step\n\n\n\nBefore you start\n\n\nPrerequisites\n\n\nTo install the Unidesk ELM in Hyper-V environment you need:\n\n\nA Unidesk account.\nThe Storage and Hyper-V requirements listed \nhere\n.\n\n\n\nVirtual appliance details\n\n\nName\nValue\nVirtual Machine Name\nUnidesk Enterprise Layer Manager\nVIrtual Machine Generation\nGeneration 1\nMemory\n8192 MB\nCPUs\n4\nDisk 1\nunidesk_hyperv-system.vhdx\nDisk 2\nunidesk_hyperv-repository.vhdx\n\n\n\nDeploy the Unidesk Enterprise Layer Manager (ELM)\n\n\nUsing this procedure, you will do a basic Unidesk ELM installation on your Hyper-V Server. Once you complete these steps, use the following sections to \nchange the administrator password\n  (strongly recommended), and configure more advanced options, such as Static IP.\n\n\nDownload the Unidesk Hyper-V installation package from the \nUnidesk 4 Downloads\n page to a file system on a Windows Server 2012 R2 Hyper-V-enabled system.\nExtract the Hyper-V zip package containing two disks, and copy the disks to a storage location that Hyper-V can access.\nOpen the Hyper-V Manager, right-click the Hyper-V server where you want to deploy the Unidesk ELM, and select \nNew Virtual Machine\n.\nThis opens the New Virtual Machine Wizard.\nOn the first wizard tab, click Next to begin configuring the virtual machine:\nOn the Specify Name and Location tab, set the \nName\n and \nLocation\n of the new VM. Ideally, use the location where you extracted the disks in step 2:\nOn the Specify Generation tab, ensure that \nGeneration 1 VM's\n is selected, as Unidesk currently only supports Generation 1.\nOn the Assign Memory tab, set the VM to use 8 GB of RAM. Make sure the \nUse Dynamic Memory for this virtual machine\n check box is \nnot\n selected.\nOn the Configure Networking tab, specify the NIC for the network adapter to use to connect to the network.\nOn the Connect Virtual Hard Disk tab, attach the system disk (\nunidesk_hyperv-system.vhdx\n), one of the disks that you extracted in step 2.\nOn the Summary tab, verify your choices and click \nFinish\n.\nBack in the Hyper-V Manager, select the VM and click \nSettings\n from the VM panel.\nSelect \nHardware > Processor\n, and set the Number of Virtual Processors to 4.\nSelect \nIDE Controller 0 > Hard Drive\n, click \nAdd\n.\nSelect the \nVirtual Disk\n radio button, click \nBrowse\n, and select the \nrepository\n disk (\nunidesk_hyperv-repository.vhdx\n) extracted in step 2.\nPower on the VM.\n\n\n\nConfigure advanced settings\n\n\nOnce you've completed the ELM installation, you should immediately log into the ELM and:\n\n\nChange the \nadministrator password\n.\n(Optional) Configure \nadvanced network\n options, such as Static IP, as needed.\nMake any changes required to the existing settings, for example, the \nNTP servers\n you use or the \nTime Zone\n.\n\n\n\nThe Unidesk \nAppliance Configuration utility\n lets you configure these settings.\n\n\nExpand locally attached storage, if needed\n\n\nIf you need to expand the ELM's local storage, see Manage system storage.\n\n\nNext Step\n\n\nOnce you're satisfied that the ELM is correctly configured and has the required storage space, you can log into the Unidesk Management Console, and begin creating your layers.\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nIn this article:\n\n\nLog into the UMC\nNext step\n\n\n\nLog into the UMC\n\n\nOnce you have \nset up the Unidesk ELM\n, you can log into the Unidesk Management Console, which is the user interface for creating and managing Unidesk Layers and Layered Images.\n\n\nThe following steps explain how to log into the UMC using the default User Name and Password.\n\n\nLocate the VM you created for the Unidesk ELM and determine the IP address for this VM.\nUsing the IP address for the ELM, enter the following URL in a compatible web browser:\nhttp://\n/udmc\nThis displays the Login page for the Unidesk Management Console.\nEnter \nAdministrator\n in the User Name field and \nUnidesk1\n in the Password field to log in to the Unidesk Management Console for the first time.\n\n\n\nNext step\n\n\nObtain a Unidesk license\n\n\nInstall the Unidesk ELM in Nutanix AHV\n\n\nReview the prerequisites and follow the steps to install the ELM in Nutanix AHV. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.\n\n\nUnidesk Prerequisites (Nutanix AHV)\n\n\nIn this article:\n\n\nOS requirements\nStorage requirements\nNutanix Acropolis requirements\n\n\n\nOperating System requirement \n\n\nOS for Layered Images\nYou need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\n\n\n\nStorage requirements\n\n\n350-500 GB Storage Space\nThe Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed.\n40-100 GB network file share (SMB/NFS)\nThe file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.\n\n\n\nNutanix Acropolis requirements for installing the Unidesk ELM\n\n\nIf you are installing the Unidesk ELM and building your Layers on Acropolis VMs, or you are publishing Layered Images that will be used in a Acropolis environment, you need:\n\n\nAcropolis account and privileges\nAn existing or new Acropolis account to use for Unidesk.\nThe account must have Acropolis privileges to:\nCreate and remove virtual disks.\nCopy and delete layers on virtual disks using Acropolis file APIs.\nNutanix Acropolis software and settings\nAccess to the Acropolis Tools to install on the layer.\nAcropolis resource information\nThe Acropolis info listed in \nAcropolis Connector Configuration\n.\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV)\n\n\nIn this article:\n\n\nBefore you start\nDeploy the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV)\nChange the administrator password\nConfigure advanced settings\nExpand locally attached storage, if needed\nNext Step\n\n\n\nBefore you start\n\n\nTo get started with Unidesk, you will need:\n\n\nA Unidesk account\nA supported version of Nutanix AHV\nA virtual network in Nutanix AHV\nStorage requirements and Nutanix AHV requirements listed \nhere\n.\n\n\n\nDeploy the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV)\n\n\nUsing this procedure, you will do a basic Unidesk ELM installation on your Nutanix AHV Server. Using this process you will create the new VM for the Unidesk ELM, and has 8 GB of memory and 1 VCPU with 4 cores.\n\n\nOnce you complete these steps, use the remaining sections to \nchange the administrator password\n  (strongly recommended), and configure more advanced options, such as Static IP.\n\n\nDownload the Unidesk installation package, Unidesk_install_pkg_4.x.x, from the Unidesk download site. This zip file contains two unidesk_elm_4.x.x.x.vhd files.\nUnzip the Unidesk installation package, and place the two .vhd files on a file share that the Nutanix server can access.\nLog into the Nutanix Prism console, where you will upload the Unidesk VHD disks, and then create a VM for the Unidesk ELM.\nSelect the \nTools\n menu in the top right corner of the UI, and choose \nImage Configuration\n.\nClick the \nUpload Image\n button, and name the disk.\nSelect the \nDisk Image Type\n.\nSelect the \nUpload a File\n option, browse to your file share, and choose the ELM Boot Disk. Wait for the upload to complete.\nRepeat steps 2 - 7 for the ELM Local Storage Disk.\nSelect \nTasks\n and make sure that for each of the disks, \nboth\n the Image Create and Image Update tasks are complete. Once this is done, you can create the VM.\nSelect the \nVM\n tab on the top left dropdown menu, and click the \nCreate VM\n button.\nComplete the \nName\n and \nDescription\n of the new VM.\nSet VCPU(S) to \n1\n.\nSet Number of Cores per VCPU to \n4\n.\nSet Memory to \n8\n GB.\nTo add the Disks to the VM, click \nAdd new disk\n and choose type \nDisk\n.\nIn the Operation drop-down, choose \nClone from Image Service\n.\nIn the \nBus Type\n drop-down select \nIDE\n.\nIn the Image Box select the Boot disk that you uploaded, and click \nAdd\n.\nRepeat the above steps for the following disks:\nBoot Disk:\n unidesk_nutanix-system.img\nRepository Disk:\n unidesk_nutanix-repository.img\nAdd NIC by clicking on \nAdd new NIC\n.\nClick \nSave\n to complete dialog and create VM.\nPower on the VM.\n\n\n\nIf you receive the error: \"Cannot create UUID from string \"undefined\"\"\n\n\nEnsure that you have waited for both tasks for each disk to be completed before attempting to create the VM.\n\n\nChange the administrator password\n\n\nLog in\n to the ELM's Appliance Configuration utility, as described above.\nAt the Appliance Configuration utility's Action prompt, enter \nP\n (for \nPassword change\n), and press \nReturn\n.\nWhen prompted, enter the new password, and then confirm the password. A message confirms that the \n** Password changed successfully\n.\nPress the \nEnter\n key to continue.\nAt the Action prompt, enter \nQ\n to quit.\n\n\n\nConfigure advanced settings\n\n\nConfigure advanced \nnetwork options\n, such as Static IP, NTP servers and Time Zone.\n\n\n\nThe Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .\n\n\nExpand locally attached storage, if needed\n\n\nIf you need to expand the ELM's local storage, see Manage system storage.\n\n\nNext Step\n\n\nOnce you're satisfied that the ELM is correctly configured and has the required storage space, you can log into the Unidesk Management Console (UMC), and begin creating your layers.\n\n\nLog into the Unidesk Management Console (UMC)\n\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nIn this article:\n\n\nLog into the UMC\nNext step\n\n\n\nLog into the UMC\n\n\nOnce you have \nset up the Unidesk ELM\n, you can log into the Unidesk Management Console, which is the user interface for creating and managing Unidesk Layers and Layered Images.\n\n\nThe following steps explain how to log into the UMC using the default User Name and Password.\n\n\nLocate the VM you created for the Unidesk ELM and determine the IP address for this VM.\nUsing the IP address for the ELM, enter the following URL in a compatible web browser:\nhttp://\n/udmc\nThis displays the Login page for the Unidesk Management Console.\nEnter \nAdministrator\n in the User Name field and \nUnidesk1\n in the Password field to log in to the Unidesk Management Console for the first time.\n\n\n\nNext step\n\n\nObtain a Unidesk license\n\n\nInstall the Unidesk ELM in vSphere\n\n\nReview the prerequisites for installing the Unidesk Enterprise Layer Manager in vSphere. Next, follow the steps to install the ELM on your vSphere server. You will then be able to log in to the Unidesk Management Console and complete the Unidesk setup.\n\n\nUnidesk Prerequisites (vSphere)\n\n\nIn this article:\n\n\n \nStorage requirements\nvSphere requirements\n\n\n\nOperating System requirement \n\n\nOS for Layered Images\nYou need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\n\n\n\nStorage requirements\n\n\n350-500 GB Storage Space\nThe Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed.\n40-100 GB network file share (SMB/NFS)\nThe file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.\n\n\n\nvSphere prerequisites\n\n\nIf you are installing the Unidesk ELM in vSphere and building your layers on vSphere VMs or publishing Layered Images to vSphere, you need:\n\n\nNetwork access to Unidesk Tools download\nYou need access from the Packaging Machine VM in vSphere to the Unidesk Tools download (available on the Unidesk Download page).\nvCenter account and privileges\nAn existing or new vCenter account to use for Unidesk.\nThe account must have vCenter privileges to: Create and remove VMDKs, and to copy and delete layers on VMDKs using vSphere file APIs (see detailed list of vCenter permissions below).\nDedicated vCenter role for Unidesk (optional)\nTo set up a new role:\nIn the vSphere Client, navigate to \nHome > Administration > Roles\n.\nClick \nAdd Role\n.\nEnter a name. Example: \nUDAdmin\n.\nSet the privileges for this account.\nPrivileges set for the vCenter role you are using for Unidesk\n Add the required vCenter permissions (detailed permissions list below).\nOpen the \nAssign Permissions\n window.\nIn the vSphere Client, navigate to \nHome > Inventory > Hosts and Clusters\n.\nSelect your \nvCenter\n, right-click, and select \nAdd permission\n.\n In the Assign Permissions window, under Assigned Role, expand All Privileges.\nSelect the permissions listed below, make sure that the \nPropogate to Child Objects\n check box is selected, and click \nOK\n. displayed.\nThe \nUnidesk\n role associated with the administrator account\nAssociate the Unidesk role with the administrator account:\nAdd the administrator account and assign the Unidesk role to it.\nAllow the permissions to propagate to the entire Datacenter.\nNote:\n If you want to restrict this use from accessing specific folders in the Datacenter, grant the user more restrictive permissions for those folders.\nvCenter permissions\nUnidesk needs vCenter-level privileges to request information about the execution status of tasks. Without those privileges, Unidesk would consider the tasks failed.\nExpand \nAll Privileges\n, and each of the following...\nThen select...\nDatastore\nAllocate space\nBrowse datastore\nLow level file operations\nFolder\nCreate folder\nDelete folder\nGlobal\nCancel task\nHost > Configuration\nSystem Management\nNetwork\nAssign network\nResource\nAssign virtual machine to resource pool\nvApp\nExport\nImport\nvApp application configuration\nVirtual machine > Configuration\nAdd existing disk\nAdd new disk\nAdd or remove device\n Advanced\nChange CPU count\nChange resource\n Configure managedBy\nDisk change tracking\nMemory\nModify device settings\nRemove disk\nRename\nReset guest information\nSet annotation\nSettings\nSwapfile placement\nUpgrade virtual hardware\nVirtual machine > Interaction\nAnswer question\nConfigure CD media\nConsole interaction\nDevice connection\nPower off\nPower on\nReset\nSuspend\nVirtual machine > Inventory\nCreate from existing\nCreate new\nRegister\nRemove\nUnregister\nVirtual machine > Provisioning\nClone template (optional, but required to use a vSphere template as the source VM)\nClone virtual machine\nCustomize\nDeploy template\nMark as template\nVirtual machine > Snapshot management\nCreate snapshot\nRemove Snapshot\n\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM) (vSphere)\n\n\nIn this article:\n\n\nBefore you start\nDeploy the Unidesk Enterprise Layer Manager (ELM)\nExpand locally attached storage, if needed\nNext Step\n\n\n\nBefore you start\n\n\nTo get started with Unidesk, you will need:\n\n\nA Unidesk account\nA supported version of VMware vSphere\nA Virtual Network in vSphere\nStorage requirements and vSphere requirements listed \nhere\n.\n\n\n\nDeploy the Unidesk Enterprise Layer Manager (ELM)\n\n\nUsing this procedure, you will do a basic Unidesk ELM installation on your vSphere Server. Once you complete these steps, use the following sections to \nchange the administrator password\n  (strongly recommended), and configure more advanced options, such as Static IP.\n\n\nDownload the Unidesk Tools installation package, Unidesk_install_pkg_4.x.x, from the Unidesk download site. This zip file contains the unidesk_elm_4.x.x.x.ova file and other files.\nExtract the Unidesk_ELM.ova file to a folder on your local drive.\nIn the vSphere Web Client you are using, navigate to the \nVMs and Templates\n page.\nRight-click the folder in vSphere where you want to deploy the template and select \nDeploy OVF Template\n. The Deploy OVF Template wizard appears.\nIn the Deploy OVF Template wizard, do the following:\nOn the \nSelect source\n page, select the \nLocal file\n option, and browse to the \nUnidesk_ELM.ova\n file to select it.\nOn the \nSelect name and folder\n page, designate a name and location for the deployed OVF template.\nOn the \nSelect a resource\n page, select a location to run the deployed OVF template.\nOn the \nSelect storage\n page, select the \nThick Provision Lazy Zeroed\n setting of the \nSelect virtual disk format\n option, select a storage policy, and specify a storage location.\nOn the \nSetup networks\n page, select your vSphere virtual network in the \nDestination\n column and select the \nIPv4\n setting of the \nIP protocol\n option.\nOn the \nReady to complete\n page, review the template settings and click \nFinish\n when you are satisfied with the settings.\n\n\n\nThe new VM created from the Unidesk_ELM.ova file has 8 GB of memory and 4 CPUs.\n\n\nConfigure advanced settings\n\n\nOnce you've completed the ELM installation, you should immediately log into the ELM and:\n\n\nModify the administrator password.\n(Optional) Configure advanced network options, such as Static IP, as needed.\nMake any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.\n\n\n\nThe Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .\n\n\nExpand locally attached storage, if needed\n\n\nIf you need to expand the ELM's local storage, see Manage system storage.\n\n\nNext Step\n\n\nOnce you're satisfied that the ELM is correctly configured and has the required storage space, you can log into the Unidesk Management Console, and begin creating your layers.\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nLog into the Unidesk Management Console (UMC)\n\n\nIn this article:\n\n\nLog into the UMC\nNext step\n\n\n\nLog into the UMC\n\n\nOnce you have \nset up the Unidesk ELM\n, you can log into the Unidesk Management Console, which is the user interface for creating and managing Unidesk Layers and Layered Images.\n\n\nThe following steps explain how to log into the UMC using the default User Name and Password.\n\n\nLocate the VM you created for the Unidesk ELM and determine the IP address for this VM.\nUsing the IP address for the ELM, enter the following URL in a compatible web browser:\nhttp://\n/udmc\nThis displays the Login page for the Unidesk Management Console.\nEnter \nAdministrator\n in the User Name field and \nUnidesk1\n in the Password field to log in to the Unidesk Management Console for the first time.\n\n\n\nNext step\n\n\nObtain a Unidesk license\n\n\nSet up Unidesk\n\n\nOnce the Unidesk Enterprise Layer Manager (ELM) is installed, complete these setup instructions before attempting to use the ELM.\n\n\nBefore you start\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM)\n\n\nSet up the Unidesk environment\n\n\nObtain a Unidesk license\nChange the Administrator password\nSet up a network file share\nOpen firewall ports for Unidesk, as needed\nInstall the Unidesk Agent (required for PVS and Connector Scripts)\nCreate a directory junction \nAssign Unidesk Roles to users\nEnable Unidesk Labs features\n\n\n\nNext Step\n\n\nCreate Layers\n\n\nObtain a Unidesk license\n\n\nIn this article:\n\n\nRegister with Unidesk and log in\nDownload the license\nNext step\n\n\n\nTo acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.\n\n\nRegister with Unidesk and log in\n\n\nTo register on the Unidesk website:\n\n\nIn a web browser, navigate to \nthe Unidesk website\n and click \nLogin\n.\nIn the Register section of the login page, enter your email address and click \nRegister.\nUnidesk sends a confirmation email message to the address you provided.\nOpen the confirmation email message from Unidesk, which contains the Subject line \"Confirming your registration at www.unidesk.com\", and click the link it contains or paste the link into a web browser.\nTo finish registering, fill out the fields in the \"Email address confirmed\" page and click the \nComplete registration\n button.\n\n\n\nDownload the license\n\n\nOnce you are registered on the Unidesk site, you can obtain a Unidesk license by downloading a license.xml file. To obtain a license:\n\n\nIn the Unidesk Management Console, click \nAbout\n.\nIn the About Unidesk box, click the License tab.\nOn the License tab, click \nManage License\n.\nIn the Update License box, click \nDownload your license now by entering your credentials for the www.unidesk.com website\n option and enter your Unidesk \nUser Name\n and \nPassword\n and click the Next icon \n to access the Confirm Your License Update tab.\nIn the Confirm Your License Update tab, click \nFinish\n.\n\n\n\nNext step\n\n\nChange the Administrator password\n\n\nChange the Administrator password\n\n\nUse these steps to change the password for the original Administrator account created for the Unidesk Management Console (UMC).\n\n\nLog into the Unidesk Management Console (UMC).\nSelect \nUser > Administrators\n.\nIn the list of Administrators select \nAdministrator\n and click \nEdit Properties\n.\nEnter the new password and type it again in the \nConfirm Password\n field.\nOn the Confirm and Complete tab, click \nUpdate User\n.\n\n\n\nNext step\n\n\nSet up a network file share\n\n\nSet up a network file share\n\n\nIn this article:\n\n\nNetwork file share requirements and recommendations\nCreate the network file share\nConfigure Unidesk to access the file share\nNext step\n\n\n\nThe Unidesk ELM must be connected to a network file share.\n\n\nNetwork file share requirements and recommendations\n\n\nRequirements\n\n\nWhen setting up the ELM's file share:\n\n\nThe file share must be configured using SMB or NFS technology. However, if you plan to use Elastic Layer assignments, you must use SMB protocol, as NFS technology is \nnot\n supported when using Elastic Layers.\nThe user credentials for the file share must have full permissions for that share.\nThe share must be set up by the admin to be \nreadonly\n for all users except for the one configured in the ELM. This secures the Layers and other files stored on the share.\nEnsure that you have the minimum storage space requirement of 40-100GB for your file share.\nNote:\n Storage space is expandable, as you can add space to a disk, or other disks to the ELM.\n\n\n\nRecommendations\n\n\nFor convenience, set up a Network File Share hosted in your hypervisor.\nFor Azure:\n Currently, the Unidesk ELM does not support the \nAzure File Share feature\n. For best performance, it is best to create a file share server in Azure using a fast system with a Premium Disk, for example, a DS class machine.\n\n\n\nCreate the network file share\n\n\nDepending on your environment, configure a file share that uses either Network File System (NFS) or Server Message Block (SMB) protocol.\n\n\nFollow the vendor's instructions for setting up a file share using the protocol supported in your environment.\nIf you are planning to deploy Elastic Layers, the share \nmust be configured using SMB technology\n. When using Elastic Layer assignments, \nNFS technology is not supported\n for the file share.\n\n\n\nConfigure Unidesk to access the file share\n\n\nOnce you have created a file share, configure the Unidesk Enterprise Layer Manager (ELM) to attach to it. You can configure the ELM via the Unidesk Management Console (UMC).\n\n\nIn the Unidesk Management Console, select \nSystem > Settings and Configuration\n, then scroll down to the network file shares setting and click \nEdit\n.\nSpecify a Type, Path, User name, and Password for the file share.\nClick \nTest Network File Share\n to see if you can connect to the file share. The test returns a message stating either \nSuccess\n or \nFailed to mount network file share path\n.\nOnce the test returns a \nSuccess\n message, click \nSave\n.\n\n\n\nNext step\n\n\nOpen ports in your firewall for Unidesk\n\n\nOpen firewall ports for Unidesk, as needed\n\n\nIn this article:\n\n\nAdmin User\nUnidesk Enterprise Layer Manager Appliance\nNext step\n\n\n\nThe Unidesk ELM must be connected to a network file share.\n\n\nThe Unidesk installer opens ports that the Unidesk Enterprise Layer Manager (ELM) needs to interact with services on the virtual server where it is hosted. The default ports that Unidesk uses are listed in the tables below.\n\n\nIf there is a firewall between the Unidesk appliance and the machine on which you are running the Unidesk Agent or one of the Unidesk Connectors, you must manually open the port in the firewall used for that purpose. If during installation you changed any of the ports from the default setting, be sure to open the correct port.\n\n\nAdmin User\n\n\nBy default, Unidesk uses the following ports in your firewall for the Unidesk Admin User to interact with the Unidesk Management Console (UMC).\n\n\nDestination\nActivity\nProtocol\nPorts\nUnidesk Enterprise Layer Manager (ELM)\nUnidesk Management Console (UMC)\nTCP\n80,443\n\n\n\nUnidesk Enterprise Layer Manager Appliance\n\n\nInternal Connections\n\n\nBy default, Unidesk uses the following ports in your firewall for internal connections between the Unidesk appliance and each of the destinations listed below.\n\n\nDestination\nActivity\nProtocol\nPorts\nUnidesk ELM\nActiveMQ Console\nTCP\n8161\nUnidesk ELM\nLog deliveries from the Unidesk Agent\nTCP\n8787\nUnidesk ELM\nLog deliveries from users\nTCP\n8888\nUnidesk ELM\nCommunication with datastore via ESXI Host\nTCP\n443\nUnidesk Agent\nCommunication\nTCP\n8016\nUnidesk Agent\nLog gathering\nTCP\n14243\nActive Directory\nLDAP\nTCP\n389, 636\nConnector for Azure\nCommunication\nTCP\n3000 (HTTP) \n3500 (HTTPS)\nConnector for PVS\nCommunication\nTCP\n3009 (HTTP) \n3509 (HTTPS)\nConnector for vSphere\nCommunication\nTCP\n3004 (HTTP)\n3504 (HTTPS)\nConnector for XenServer\nCommunication\nTCP\n3002 (HTTP)\n3502 (HTTPS)\n\n\n\nExternal connection\n\n\nBy default, Unidesk uses the following port in your firewall for external connections between the Unidesk appliance and the destination listed below.\n\n\nDestination\nActivity\nProtocol\nPorts\napi.unidesk.com\nLogs and Phone Home data uploads from the Unidesk ELM (optional)\nTCP\n443\n\n\n\nOS Image (XenServer requirement)\n\n\nCitrix XenServer uses Port 5900 for communications between your OS Image and XenCenter or other Xen client.\n\n\nDestination\nActivity\nProtocol\nPorts\nXenCenter\nCommunications\n \n5900\n\n\n\nNext step\n\n\nIf you are publishing to PVS: Install the Unidesk Agent (required for PVS and Connector Scripts)\n\n\nIf you are \nnot\n  publishing to PVS: Assign Unidesk Roles to users\n\n\nInstall the Unidesk Agent (required for PVS and Connector Scripts)\n\n\nIn this article:\n\n\nAbout installing the Unidesk Agent\nPrerequisites\nInstall the Unidesk Agent\nRegister with the Unidesk ELM manually\nNext step\n\n\n\nAbout installing the Unidesk Agent\n\n\nThe Unidesk Agent enables the Unidesk Enterprise Layer Manager (ELM) or a Unidesk Packaging Machine VM to run PowerShell commands locally. If you supply the proper credentials, the agent can run PowerShell commands as a specific user.\n\n\nThe Unidesk Agent is required in cases where one of your Connector Configurations launches a PowerShell script. This includes Connector Configurations you use to:\n\n\nPublish Layered Images to a provisioning system.\nPackage Layers in your hypervisor environment.\n\n\n\nThe Unidesk Agent installer prompts you to register the agent with a Unidesk ELM. If you do not register the agent during installation, you can manually register it later. However, keep in mind that the PowerShell scripts will not run until the agent is registered with the ELM.\n\n\nPrerequisites\n\n\nBefore you install the Unidesk Agent, you must have the following requirements on the system where you are installing the Unidesk Agent:\n\n\nAn account with administrator privileges\n.NET 4.5\nPowerShell 3.0 or greater\nPowerShell Snap-in\nBefore using the Unidesk Agent on a PVS server you must ensure the PowerShell Snap-in is installed. This is a manual step.\nFor PVS 7.7 and later, you must install the Powershell Snap-in \nCitrix.PVS.Snapin.dll\n.\nFor PVS 7.6 and PVS 7.1, you must install \nMcliPSSnapIn.dll\n. Use the \ninstallutil.exe\n to install the Snap-in.\nExample (7.6):\nFrom a command prompt, go to:\nc:\\program files\\citrix\\provisioning services console\nRun this command:\n\"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe\" McliPSSnapIn.dll\nExample (7.7):\nFrom a command prompt, go to:\nc:\\program files\\citrix\\provisioning services console\nRun this command:\n\"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe\" Citrix.PVS.snapin.dll\nOn Windows 2008 R2, you must also enable PowerShell remote commands. For background information, see this Microsoft article:\nhttps://technet.microsoft.com/en-us/library/hh849694.aspx\nIf your 2008 R2 OS does not have PowerShell remoting enabled, run the following PowerShell command on the PVS server:\nEnable-PSRemoting\n\n\n\nInstall the Unidesk Agent\n\n\nLog in as an administrator on the system where you are installing the agent.\nDownload the Unidesk Agent from the Unidesk Download page.\nCopy the \nUnidesk_agent_installer.exe\n file from the Unidesk Agent folder to a convenient location on the PVS server.\nRun the \nUnidesk_agent_installer.exe\n as Administrator, and when prompted, enter the path to the directory where you want to install the Unidesk Agent. The default location is \nC:\\\\Program Files (x86)\\Unidesk\\Agent\n.\nThe Unidesk Agent installer checks to see if all Prerequisites are present. If any prerequisites are missing, the installer reports this and exits without installing.\nThe installer prompts you for an Agent Port number. You can accept the default port number (8016) or specify a different one if the default port is already in use.\nThe installer prompts you for the credentials (\naddress\n, \nusername\n, and \npassword\n) for your Unidesk ELM. Register the Unidesk Agent with the ELM by entering the IP address and login credentials for a Unidesk Management Console (UMC) user on the ELM with Administrator privileges, (for example, the credentials you use to log into the UMC).\nNote:\n If the Unidesk ELM is not available yet or you choose not to register with it now, you can manually register at a later time using the procedure described in Register with the Unidesk ELM manually.\nClick \nFinish\n to exit the wizard.\n\n\n\nThe Unidesk Agent registration appears in the Audit log for the Management Service in the Unidesk Management Console.\n\n\nRegister with the Unidesk ELM manually\n\n\nIf the Unidesk Agent was not registered with a Unidesk ELM during installation, you can register it later by using the following procedure.\n\n\nTo manually register the Unidesk Agent with the ELM:\n\n\nAs an \nadministrator\n, log in to the server where you installed the Unidesk Agent.\nOpen a command window (cmd.exe) as administrator and navigate to the directory where the Unidesk Agent is installed. (The default location is \nC:\\\\Program Files (x86)\\Unidesk\\Agent\n.)\nRun the following command, using the IP address of the ELM where indicated:\nUnidesk.Agent.Service.exe register /i /e:\nIP_address_of_ELM\n /u:Administrator\n \nWhen prompted, enter the password for a user who has Administrator privileges in the Unidesk Management Console (UMC) on the ELM.\nWhen the registration process completes, a message appears informing you of the successful outcome. The Unidesk Agent registration appears in the Audit log for the Management Service in the UMC.\n\n\n\nIf the process does not succeed, examine the \n\\Unidesk\\Agent\\Logs\\unidesk.agent.log\n\n\nfile in the Unidesk Agent installation directory. You can also view Help for the Unidesk Agent command line options by running the following command: Unidesk.Agent.Service.exe /?.\n\n\nNext step\n\n\nConnect to a Directory Service\n\n\nConnect to a Directory Service\n\n\nIn this article:\n\n\nAbout connecting Unidesk to a directory service\nCreate a directory junction\nConnect to a Directory Service\n\n\n\nYou can configure Unidesk to connect to a Directory Service, for example, Active Directory. When you connect to your directory service, you will create one or more Directory Junctions to access specific domains or OUs. Unidesk does \nnot\n  modify the directory service you connect to. The Unidesk software caches the attributes for each directory service entry, so that if the connection to the directory service is lost temporarily, the software can use the cached information for management tasks.\n\n\nAbout connecting Unidesk to a directory service\n\n\nThe Unidesk Management Console Directory Tree displays a hierarchical view of Users and Groups. Each Directory Junction that you create specifies a starting node in the directory tree.\n\n\nOverlapping Directory Junctions\n\n\nOverlapping (or nested) Directory Junctions occur when you create multiple Directory Junctions that contain the same users and then import the users into the Unidesk directory tree. When overlapping occurs, each Directory Junction contains its own copy of the duplicate users.\n\n\nExample: Overlapping directory junctions\n\n\nAssume you create Directory Junction A that starts at the Marketing folder in a directory service tree. Next, you create Directory Junction B which starts at a folder above the Marketing folder. If you browse both Directory Junctions, you can see the Marketing users in both folders.\n\n\nUser attributes are imported from the directory service\n\n\nThe Unidesk software imports and caches user and group attributes from your directory service when:\n\n\nYou assign administrator privileges to a user.\nThe values of the attributes change in the directory service.\n\n\n\nThe attributes that the Unidesk software caches are read only. All changes to the attributes for directory service users come from the directory server.\n\n\nImported attributes are synchronized regularly\n\n\nThe Unidesk software synchronizes the information it caches for directory service users with the directory service every 12 hours. If the software discovers that a user is no longer an object in the directory service, it classifies the user as abandoned (you can view this information in the Information view for the user).\n\n\nCreate a directory junction\n\n\nCreate the folders where you want to place the Directory Junctions or decide which existing folder you want to use. You can add a Directory Junction folder to any existing folder in the Unidesk Management Console directory tree.\n\n\nBest Practice:\n  Avoid creating overlapping Directory Junctions, if possible. In some circumstances, deleting an overlapping Directory Junction can affect your ability to delete another Directory Junction that contains the same users.\n\n\nSelect \nUsers > Directory Service\n.\nSelect \nCreate Directory Junction\n in the Action bar. This opens the Create Directory Junction wizard.\nIn the Connection Details tab, specify the details for the directory server.\nDirectory Junction Name- This name becomes the name of the folder that you see in the tree view. You can use any name, including the name of a domain in your directory service tree.\nServer address - This is the name for the server you will use for the directory service. (IP Address or DNS Name)\nPort - Specify the port number for communicating with the directory server.\nSSL check box - Select this if you want to use Secure Sockets Layer (SSL) communication.\n If certificate errors occur, the wizard displays a list of these errors. If you know it is safe to ignore them, select \nIgnore Certificate Errors\n.\nTest Connection\n - Click to verify that the Unidesk ELM can connect to the directory service.\nIn the Authentication Details tab, enter the authentication details for a user who has permissions to search the directory service.\nBind Distinguished Name - To determine the correct syntax for the Bind DN or user name, see the documentation for your directory.\nExamples: \nThe following examples shows some of the ways you can specify a user for the directory service: \ndomain\\username \nor \nusername@domain.com\n.\nBind Password.\nTest Authentication - Click to verify that the connection to the directory server is valid.\nIn the Distinguished Name Details tab, specify where the software should start searching for users and groups in the remote directory service.\nBase Distinguished Name (DN) - The software starts searching for users and groups in the remote directory service. Once you establish a connection to the server for the directory service, the wizard displays a list of available DNs. You can select a DN from the list or enter the DN directly in the box.\nExample\n: Assume that you want to start the search at the Marketing Organizational Unit at the root of a domain. You would enter the following Base DN:\nOU=marketing, DC=root,DC=mydomain DC=com\nTest Base DN - Click to verify that the Base DN is valid.\nIn the Folder Location tab, select the folder in the Unidesk tree where you want to add the directory junction for the remote directory service.\nIn the Attribute Mapping tab, enter the names of directory service attributes that you want to map to the local attributes or use the default settings.\nNote: To change the mapping from local attributes back to default mappings, click Use Defaults.\nIn the Confirm and Complete tab, verify the Directory Junction settings, enter a comment if required, and click Create Directory Junction.\nIf you enter comments, they appear in the Information view Audit History.\n\n\n\nNext step\n\n\nAssign Unidesk Roles to users\n\n\nAssign Unidesk Roles to users\n\n\nIn this article:\n\n\nUnidesk Roles defined\nAssign Unidesk Roles to users\nNext step\n\n\n\nAbout Unidesk users, roles, and rights\n\n\nBuilt-in Administrator account\n\n\nWhen you first install the Unidesk ELM (appliance) and log onto the Unidesk Management Console (UMC), there is a \"built-in\" Administrator account that you can use to get started. This Administrator has the rights to perform all Unidesk operations. You can edit this user's properties, including the name, password, and contact info. Be sure to change the password for this built-in Administrator account as part of installing and configuring the Unidesk ELM.\n\n\nAD User accounts\n\n\nOther than the built-in Administrator account, all Unidesk users are actually AD users imported via one or more directory junctions. Once your directory junction(s) have been created, you can assign Unidesk Roles to each user, as described later in this topic. You can see which roles are assigned to a user in the User Details.\n\n\nUnidesk Roles defined\n\n\nUnidesk Roles determine which Unidesk modules a user can manage. Users assigned one or more Unidesk Roles can log into the UMC, and these users are listed on the Administrators tab (select \nUsers \n Administrators\n ).\n\n\nNote:\n  When upgrading from Unidesk 4.0.6 or earlier, users assigned the Machine Administrator Role in earlier releases will now be assigned the \nRead Only\n  Role. If the user needs more than read only access, reconfigure the user roles, as needed.\n\n\nRights by Role\n\n\nRole\nRights\nAdministrator\nCan do every operation available in the UMC.\nOnly users assigned the Administrator Role can edit user properties on the Users tab (Select \nUsers > Users\n).\nOnly administrators can configure ELM system settings. and manage licenses.\nManage App Layers\nCan create, edit, and delete application layers and versions.\nManage Elastic Layer Assignments\nCan add, update, and remove Elastic layer assignments.\nManage Image Templates\nCan create, edit and delete Image templates.\nCan add, update, and remove app layer assignments for image templates.\nCan update platform layer assignments for image templates.\nCan update OS layer assignments for image templates.\nManage OS Layers\nCan create, edit, and delete OS layers and versions.\nManage Platform Layers\nCan create, edit, and delete Platform layers and versions.\nPublish Layered Images\nCan publish layered images.\nCannot create or modify existing image templates.\nRead Only\nCan view information about any items in the UMC.\nCannot launch any wizards or make any changes.\nThe Read Only user cannot cancel any tasks.\n\n\n\nUser credentials for logging into the UMC\n\n\nWhen you assign Unidesk Roles to Directory Service users, they can use their Directory Service credentials to log into the UMC.\n\n\nWho can assign Unidesk Roles?\n\n\nYou can change a user's role if you are logged into the UMC as a user assigned the Administrator Role.\n\n\nAssign Unidesk Roles to users\n\n\nLog into the UMC.\nSelect \nUsers > Users\n.\nSelect a user and click \nEdit Properties\n. This opens the Edit User wizard.\nSkip to the Roles tab, and select one or more roles for this user. For details, see \nRights by Role\n above.\nIn the Confirm and Complete tab, click \nUpdate User\n. Any comments you enter will appear in the Information view Audit History.\n\n\n\nNext step\n\n\nCreate Layers\n\n\nEnable Unidesk Labs features\n\n\nIn this article:\n\n\nWelcome to Unidesk Labs\nEnable a Unidesk Labs feature\nLabs features in this release\n\n\n\nWelcome to Unidesk Labs\n\n\nWant to experiment with cool new features that are under development? Through the Unidesk Management Console, you can now see which features are available in Unidesk Labs in any given release. You can enable features you're interested in, try them out, and let us know what you think. The only caveat? Best not use Labs features in your production environment, as they are likely to evolve with the feedback we receive from users like you!\n\n\nIn the Learning Center, features that are available through Unidesk Labs are marked (Unidesk Labs) in the title. \nSome\n  Unidesk Labs features require enabling, as described in the next section, though in the current release, the features available through Labs do \nnot\n  need to be enabled.\n\n\nEnable a Unidesk Labs feature\n\n\nWhen a release includes a Unidesk Labs feature that you want to enable:\n\n\nLog into the UMC and select \nSystem > Settings and Configuration\n.\nSelect the check box for the feature you want to enable, and click \nSave\n. The feature's status changes to \nEnabled\n.\n\n\n\nYou can turn off the feature at any time by deselecting the check box and clicking \nSave\n .\n\n\nLabs features in this release\n\n\nTo find out which Labs features are available in this release, see the \nRelease Notes\n.\n\n\nEnable Unidesk Labs features\n\n\nIn this article:\n\n\nWelcome to Unidesk Labs\nEnable a Unidesk Labs feature\nLabs features in this release\n\n\n\nWelcome to Unidesk Labs\n\n\nWant to experiment with cool new features that are under development? Through the Unidesk Management Console, you can now see which features are available in Unidesk Labs in any given release. You can enable features you're interested in, try them out, and let us know what you think. The only caveat? Best not use Labs features in your production environment, as they are likely to evolve with the feedback we receive from users like you!\n\n\nIn the Learning Center, features that are available through Unidesk Labs are marked (Unidesk Labs) in the title. \nSome\n  Unidesk Labs features require enabling, as described in the next section, though in the current release, the features available through Labs do \nnot\n  need to be enabled.\n\n\nEnable a Unidesk Labs feature\n\n\nWhen a release includes a Unidesk Labs feature that you want to enable:\n\n\nLog into the UMC and select \nSystem > Settings and Configuration\n.\nSelect the check box for the feature you want to enable, and click \nSave\n. The feature's status changes to \nEnabled\n.\n\n\n\nYou can turn off the feature at any time by deselecting the check box and clicking \nSave\n .\n\n\nLabs features in this release\n\n\nTo find out which Labs features are available in this release, see the \nRelease Notes\n.\n\n\nUpgrade Unidesk\n\n\nAre you upgrading the Unidesk ELM and Agent, or your Unidesk license?\n\n\nUpgrade the Unidesk ELM and Agent\n\n\nIn this article:\n\n\nPrerequisites\nDownload the upgrade media to the Network File Share\nLoad the Unidesk upgrade\nUpgrade the Unidesk Agent (PVS Servers only)\n\n\n\nPrerequisites\n\n\nVerify that a Set up a network file share has been configured. You can confirm that this has been done by logging into the Unidesk Management Appliance (UMC), selecting \nSystem \n Settings and Configuration\n , and finding the Network File Share setting. If the file share has been configured, you can upgrade the ELM. If not, click Set up a network file share to configure a file share.\n\n\nDownload Packages\n\n\nPlatform\nPackage\nFiles included\nCitrix XenServer\nunidesk_upgrade_xenserver_pkg_4.x.x.zip\nupgrade_xenserver_elm_4.x.x.xx.vhd\nMS Azure\nunidesk_upgrade_azure_pkg_4.x.x.zip\nupgrade_azure_elm_4.x.x.xx.vhd\nMS Hyper-V\nunidesk_upgrade_hyperv_pkg_4.x.x.zip\nupgrade_hyperv_elm_4.x.x.xx.vhd\nVMware vSphere\nunidesk_upgrade_pkg_4.x.x.zip\nupgrade_vmware_elm_4.x.x.xx.vhd\nunidesk_agent_installer.exe\nNote:\n A Unidesk Agent upgrade is only required if you've installed the agent for your implementation, for example, if you are using PVS, or Connector Scripts.\n\n\n\nBack up the Unidesk ELM\n\n\nTake a snapshot or checkpoint of the Unidesk ELM.\n\n\n\nDownload the upgrade media to the Network File Share\n\n\nThe Unidesk 4 upgrade files to download include the ELM upgrade and the Unidesk Agent upgrade, which is used to upgrade the agent on PVS servers and on servers where Layered Images are enabled for Elastic Layers.\n\n\nIn a network browser, navigate to the \nUnidesk 4 Download\n page.\nDownload the Unidesk package for your platform to the \n\\Upgrade\n folder on the Network File Share.\nUnzip the package in \\Upgrade.\nCopy the Unidesk Agent upgrade to the server(s) where the agent is installed, and refer to Upgrade the Unidesk Agent below.\n\n\n\nLoad the Unidesk upgrade\n\n\nLog into the UMC, select \nSystem\n and click the \nUpgrade\n action to launch the Upgrade Wizard.\nOn the Upgrade Disk Details tab, click \nBrowse\n.\nNavigate to the upgrade file, and click \nChoose\n.\nVerify the Upgrade path, and click \nUpgrade\n. This starts the upgrade process, and opens a status page in the browser.\nOnce the upgrade has completed, the status changes to \"Upgrade Status: Complete.\"\nRefresh the Web page to return to the UMC.\nVerify that the upgrade was successful by clicking the \nAbout\n link in the UMC to confirm the version number.\n\n\n\nUpgrade the Unidesk Agent\n\n\nIn cases where the Unidesk Agent is required, for example when using PVS or Elastic Layers, upgrade the Unidesk Agent as follows.\n\n\nMake sure that you have copied the Unidesk Agent Upgrade file to the PVS server(s) where the agent is installed.\nDouble-click the Agent upgrade file, and follow the instructions for upgrading the agent.\n\n\n\nUpdate your Unidesk license\n\n\nIn this article:\n\n\nLog into the Unidesk site\nUpdate your Unidesk license (with web access to the ELM)\nUpdate your Unidesk license (without web access to the ELM))\n\n\n\nTo acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.\n\n\nLog into the Unidesk site\n\n\nIn a web browser, navigate to \nthe Unidesk website\n and click \nLogin\n.\nIf you have not yet registered with Unidesk, go to the Register section of the login page, enter your email address and click \nRegister.\nUnidesk sends a confirmation email message to the address you provided.\nOpen the confirmation email message from Unidesk, which contains the Subject line \"Confirming your registration at www.unidesk.com\", and click the link it contains or paste the link into a web browser.\nTo finish registering, fill out the fields in the \"Email address confirmed\" page and click the \nComplete registration\n button.\n\n\n\nUpdate your Unidesk license (\nwith\n  web access to the ELM)\n\n\nIf you receive a message that your license needs updating, and your Enterprise Layer Manager has web access:\n\n\nIn the License Expired message, click \nLicense\n. This opens the Update License wizard.\nSelect \nDownload your license now by entering your credentials for the www.unidesk.com website\n.\nEnter your credentials for the Unidesk website.\nOn the Confirm Your License tab, click \nFinish\n.\nYou can return to the Licensing wizard at any time by logging into the Unidesk Management Console and clicking \nAbout\n, and then the \nLicense\n tab.\n\n\n\nUpdate your Unidesk license (\nwithout\n  web access to the ELM))\n\n\nIf you receive a message that your license needs updating, and your Enterprise Layer Manager does \nnot\n  have web access:\n\n\nObtain a license file from Unidesk Sales or Support, and move the file to a drive that Enterprise Layer Manager can access.\nIf the License Expired message, is still open, click \nLicense\n in the message. If not, click \nAbout\n, then the \nUpdate License\n button. This opens the Update License wizard.\nSelect \nUpload your license file from a local drive\n.\nClick \nBrowse\n, and select the license file.\nOn the Confirm Your License tab, click \nFinish\n.\nYou can return to the Licensing wizard at any time by logging into the Unidesk Management Console and clicking \nAbout\n, and then the \nLicense\n tab.\n\n\n\nUnidesk Glossary\n\n\nThis section contains terminology across all platforms and operating systems that Unidesk supports. Note that some of the terms may not pertain to your specific environment.\n\n\nA\n\n\nApp Layer\n\n\nA virtual disk containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.\n\n\nC\n\n\nConnector\n\n\nConnectors are the interfaces to environments where layers are created and images are published. The type of platform connector determines the information required to create a specific Connector Configuration.\n\n\nConnector Configuration\n\n\nA stored set of values for connecting to a specific environment. A configuration typically includes credentials for authentication, a storage location, and any other information required to interface with the environment where you will be creating layers or publishing images.\n\n\nD\n\n\nDirectory Junction\n\n\nA connection to a base Distinguished Name in a directory service (such as Microsoft Active Directory). Adding a Directory Junction to the local tree allows you to assign Administrator privileges to users that are defined in the directory service instead of in the Unidesk Management Console.\n\n\nDirectory service\n\n\nA hierarchical repository of information about users, devices and services on a network server. Microsoft Active Directory and LDAP are examples of directory services.\n\n\nDirectory service user\n\n\nA user whose attributes reside in a remote directory service but is also visible in the Unidesk environment through the use of a directory junction. You can assign Unidesk Administrator privileges to users.\n\n\nDirectory tree\n\n\nA view of data in a hierarchical, tree-like structure. The Unidesk directory tree contains entries for users, groups, containers, and Virtual Machines. You can extend this view by adding connections to a remote directory service, such as Active Directory.\n\n\nE\n\n\nElastic Layer\n\n\nA Unidesk App Layer that the Unidesk administrator can deliver based on user entitlements when users log onto sessions or standalone desktops. Elastic Layers allow administrators to give each user his/her own unique set of applications, on top of the base Layered Image used across sessions (in the case of session hosts), and across floating pools/shared groups (in the case of desktops). This can drastically reduce the number of base Layered Images that administrators need to maintain.\n\n\nEnterprise Layer Manager (ELM)\n\n\nA virtual appliance that coordinates communication in the Unidesk environment, and hosts the Unidesk Management Console (UMC), the administrator interface for the Unidesk environment. The ELM also manages copies of all Layers.\n\n\nI\n\n\nImage Template\n\n\nAn Image Template saves the OS Layer, App Layer, and Platform Layer assignments you have chosen for a Layered Image, allowing you to use any combination of layers to provision any number of servers.\n\n\nL\n\n\nLayer\n\n\nA Unidesk layer captures a Windows Operating System, a Windows Application, or the configuration settings and tools required for Images to run on a particular platform in a virtual disk that can be combined with other layers to create a Layered Image. Layers are created from a simple install of the application or operating system. You can select any combination of Layers for each Layered Image. You can reuse the same layers in any combination to provision a variety of servers.\n\n\nLayered Image\n\n\nA bootable image composited from an OS Layer, a Platform Layer, and any number of App Layers. Layered Image(s) are published using Image Templates where you save your layer selections for a particular use, usually provisioning servers in a specific silo.\n\n\nLayering Management Console (LMC)\n\n\nThe Web-based management console that runs on the Enterprise Layer Manager (ELM). This console allows you to manage the App Layering components in your environment. You can use is to create Layers, publish Layered Images, and manage system settings.\n\n\nLocal Storage\n\n\nA Layer repository where the ELM creates, composites, and stores Layers and Layered Images. Local storage is used for temporary files during the creation of Layers and Layered Images, and for persistent files, for example, Layers and Image Templates. Administrators can define the Network File Share location that will be used for Elastic Layers in the UMC's System and Settings.\n\n\nO\n\n\nOS Disk\n\n\nThe virtual disk containing the Operating System that is imported to create an OS layer. To prepare the OS disk you will install and configure an Operating System on a virtual machine and install the Unidesk tools. The OS Disk is the virtual disk where the Operating System was installed.\n\n\nOS Layer\n\n\nA virtual disk containing the operating system. You can use an OS Layer with any compatible App Layers in any number of Layered Images. You can create a new Version of the OS Layer for every patch you need to roll out, and continue deploying every and all versions of the layer as you add patches.\n\n\nOS Machine\n\n\nThe Operating System (OS) Machine is a virtual machine that you create from which you can generate an OS Disk and an OS Layer.\n\n\nP\n\n\nPackaging Disk\n\n\nA bootable virtual disk used to create a Packaging Machine needed for creating or updating a Layer. The Packaging Disk always includes your OS Layer and may also include selected Application and Platform Layers.\n\n\nPackaging Machine\n\n\nA virtual machine that acts as a staging area for the creation of App Layers, App Layer Versions, and OS Layer Versions. The Packaging Machine is booted from a Packaging Disk using the credentials and location specified in the selected Connector Configuration.\n\n\nPlatform Layer\n\n\nA layer that includes configuration settings, tools, and other software required for Images to run on a particular platform. For example, a platform layer for vSphere would include vmTools. Platform Layers also remove leftover software from other platforms from your image.\n\n\nPrerequisite Layer\n\n\nAn application that is required when installing another application for a new Application Layer or Layer Version. For example, you would select your Microsoft Office App Layer as a Prerequisite Layer when installing a Microsoft Office plugin in a separate App Layer. Or, you would select your Java App Layer as a Prerequisite Layer when creating a Layer for an application that requires Java.\n\n\nS\n\n\nSession Container\n\n\nA Citrix technology that allows different users logged into the same Session Host to be assigned different versions of the same Elastic Layer, and ensures that those Layer versions do not conflict.\n\n\nTest drive: Publish to Citrix XenServer\n\n\nOnce Unidesk is set up, you can use this test drive to create your first layers in XenServer, and then publish a test image to Citrix PVS. This example uses Windows Server 2012, Citrix PVS 7, and Citrix XenApp 7.\n\n\nPlease download the Test Drive from this Unidesk \nforum article\n.\n\n\nIf you have any questions, please ask your Unidesk Solutions Architect for assistance.\n\n\nTest drive: Publish to PVS, XenApp 7 in vSphere\n\n\nIn this article:\n\n\nPlatforms used in this test drive\nComponents you will create\nPrerequisites\nPublish a test image with an OS Layer and a Platform Layer\nAdd your first App Layer and republish the Layered Image\n\n\n\nPlatforms used in this test drive\n\n\nCreate Layers in:\nvSphere\nPublish Layered Images to:\nPVS\nFor delivery to:\nXenApp users\n\n\n\nThis test drive leads you through the process of publishing a Layered Image as a vDisk to a PVS server. As this diagram shows, the hypervisor in this scenario is vSphere, and the connection broker is Citrix XenApp.\n\n\nComponents you will create\n\n\nComponent\nDescription\nOS Layer\nContains Windows Server 2012 R2\nUnidesk Tools are installed\nNetwork card is set to VMXNet3\nPlatform Layer\nLayer containing all platform-related software and settings\nCreated in vSphere using a VMware VM for the Packaging Machine\nApp Layer\nNotepad++\nImage Template\nCreated in two stages:\nStage 1: Includes OS Layer ; Platform Layer\nStage 2: Includes the addition of App Layer\nLayered Image\nImage Template\nOS Layer\nPlatform Layer\nApp Layer\nPVS vDisk\nContains the Unidesk Layered Image\n\n\n\nPrerequisites\n\n\nUnidesk\no\n Unidesk ELM installed on a server in your vSphere environment.\no\n Unidesk Tools downloaded from the Unidesk Download page and copied to a location that the Packaging Machine VM will be able to access.\nvSphere\no\n Access from the Packaging Machine VM in vSphere to the Unidesk Tools download, which is available on the Unidesk Download page.\no\n vSphere resource information for Unidesk \nvSphere Connector Configuration\n.\nCitrix XenApp\no\n XenApp Virtual Delivery Agent Installer for Windows Server OS. The XenApp version must match the version of the XenApp server on which the Layered Image will be used.\nPVS\no\n Unidesk Agent - Installed on all PVS servers used to access the PVS servers to which you will publish images. (Agent must be registered with the Unidesk ELM.)\no\n All PVS servers where the Unidesk Agent is installed must have the PVS Console installed.\no\n PVS Target Device Imaging software (version must match the PVS server to which the Layered Image will be published).\no\n PVS resource information for the Unidesk \nPVS Connector Configuration\n.\no\n Appropriate PowerShell Snap-in must be installed.\no\n When using KMS licensing, PVS requires that each target device has a unique CMID. For more about this, see the Citrix article, \nDemystifying KMS and Provisioning Services\n. The steps for rearming KMS are covered in the \nPlatform Layer instructions\n below.\n\n\n\nPublish a test image with an OS Layer and a Platform Layer\n\n\nIn this part of the test drive you will:\n\n\nStep 1: Create an OS Layer\nStep 2: Create a Platform Layer to include in Layered Images\nStep 3: Create an Image Template\nStep 4: Publish a Layered Image to PVS\nStep 5: Assign the new vDisk to a collection\n\n\n\nStep 1: Create an OS Layer\n\n\nIn this step you will create a vSphere VM to use as your OS Machine, and prepare the OS on it. Then you will download the OS .vmdk file to the Network File Share and import the OS Disk into the Unidesk OS Layer.\n\n\nIn vSphere, create a Windows Server 2012 R2 VM, specifying a network adaptor of VMXNet3.\nImportant:\n When creating the image, be sure to choose the default cluster allocation size of 4K.\nLog into the new VM.\nCheck to see if the operating system is configured with a VMXNet3 card, and if not, change the setting to VMXNet3. Then restart the system and ensure the new network adapter setting is working.\nInstall Windows Server 2012 \nSession Host role\n.\nDownload the Unidesk OS Machine Tools from the Unidesk Support Download Center.\nDouble-click the executable to copy the scripts and files to \nC:\\Windows\\Setup\\scripts\n.\nFrom the \nC:\\Windows\\Setup\\scripts\n folder, run the included Setup_x64.exe file on the VM to install the Unidesk tools.\nShut down the VM.\nRight-click the VM and select \nTemplate > Export OVF Template\n. This preserves any snapshots you may have made.\nIn the wizard that opens, select the name of the file that will be created, and the directory in which you would like to store the file and format: \"Folder of files (OVF)\". Files are downloaded to the Network File Share.\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n. This opens the Create OS Layer Wizard so you can set up the new Layer and import your operating system into it.\nFirst, specify a \nLayer Name\n and \nVersion\n in the Layer Details tab.\nIn the Connector tab, select the \nNetwork File Share\n where you downloaded the vSphere .vmdk files. Once connected to the file share, you can select the operating system to import.\nIn the OS Disk Details tab, click \nBrowse\n to select the *.vmdk file.\nIn the Icon Assignment tab, select the 2012 icon for this Layer.\nIn the Confirm and Complete tab, make sure the details of the OS Layer are correct, and click \nCreate Layer\n.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console (UMC) displays a \nDeployable\n  status.\n\n\nStep 2: Create a Platform Layer to include in Layered Images\n\n\nPlatform Layers contain the software and settings required to either:\n\n\nCreate other Layers in your hypervisor environment, or\nPublish and run your Layered Images in the target environment\n\n\n\nBy putting all platform-specific software and settings into Platform Layers, your other Layers and Image Templates are free of any platform-specific software, and can be used to create Layered Images for multiple environments.\n\n\nNow you will create a Platform Layer to use in your Layered Images. This Platform Layer helps to ensure that Layered Images run correctly in your environment.\n\n\nFor this test drive, the platform software and settings you will include in the Platform Layer are for vSphere, PVS, and XenApp. Using the Create Platform Layer wizard in the UMC, you will:\n\n\nDeploy a Packaging Machine in vSphere.\nInstall the platform software, configure platform settings, and verify the Layer.\nRearm KMS (assuming your OS image was activated using KMS).\nFinalize the Platform Layer by importing the Packaging Machine.\n\n\n\nHere's how:\n\n\nSelect \nLayers > Platform Layers\n and then \nCreate Platform Layer\n from the Action bar to open the Create Platform Layer wizard.\nOn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nOn the OS Layer tab, select the OS Layer you created earlier.\nOn the Connector tab, click \nNew\n to add a vSphere Connector Configuration for creating the Packaging Machine VM. Use the \nprerequisite\n vSphere Connector Configuration \ninformation\n to complete the fields. Click \nTEST\n to verify the connection, then click \nSAVE\n.\nOn the Platform Types tab, select \nThis platform layer will be used for publishing Layered Images\n, and select the hypervisor, Provisioning Service, and Connection Broker where you will publish your Layered Images.\nOn the Packaging Disk tab, notice the Packaging Disk \nFile name\n. This disk will be used for the Packaging Machine (the VM) where you will install the platform tools and configure the settings.\nIn the Icon Assignment tab, select one of the default icons.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description. Once the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment. Example:\nLog into your vSphere web client, then use the information displayed in the Create Platform Layer Task (shown above) to navigate to the Packaging Machine in vSphere.\nPower on the Packaging Machine, and remote log into it. Remote log into the Packaging Machine with the User account you used to create the operating system.\nDomain join the Packaging Machine VM.\nInstall your vmTools, and configure the vSphere settings as you want them to be when the Packaging Machine starts.\nRun the PVS Target Device Installation software. In the installation wizard, take the default settings, except on the last page of the wizard, deselect the Launch Imaging Wizard checkbox.\nImportant:\n Do not run the device Imaging Wizard.\nRun the PVS Device optimization tool.\nInstall the XenApp Virtual Delivery Agent for Windows Server OS using the default settings. For the Master device option, choose MCS/PVS.\nVerify the Rearm count on the OS by running slmgr /dlv from a command prompt.\nslmgr /dlv\nRearm KMS:\nslmgr /rearm\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process. If there is an outstanding operation, wait for it to complete.\nOnce any pending operations are complete, if the Finalize process tells you to reboot the machine, be sure to rearm KMS again.\nShut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > Platform Layers\n, then select the Platform Layer and click \nFinalize\n.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nWhen the new task becomes \nDeployable\n , you can add your new layers to an Image Template.\n\n\nStep 3: Create an Image Template\n\n\nCreate an Image Template that includes the same OS Layer as you used in the Platform Layer you just created.\n\n\nSelect \nImages\n and click \nCreate Template\n. The Create Template Wizard opens.\nType a name for the template and select an icon for the Layer.\nIn the OS Layer tab choose the OS Layer.\nSkip the App Layer Assignment tab for now. You'll add App Layers in the next part of this test drive.\nOn the Connector tab, select the PVS Connector Configuration. If you don't have one yet, click \nNew\n to open the Citrix PVS Connector Configuration page, and enter the information, as described \nhere\n.\nOn the Platform Layer tab, select the Platform Layer that contains the PVS and XenApp software and settings.\nOn the Layered Image Disk tab, edit the Layered Image Disk Filename, and keep the default values for the rest of the settings.\nOn the Confirm and Complete tab, click \nCreate Template\n.\n\n\n\nNext, you can publish the Layered Image using this template.\n\n\nStep 4: Publish a Layered Image to PVS\n\n\nSelect \nImages\n. Your Template is displayed.\nSelect the Template and click \nPublish Layered Image\n. This opens the Publish Layered Image wizard.\nConfirm and complete the wizard, then expand the Task bar at the bottom of the window and monitor the task. When the task is \nDone\n, the vDisk is ready to add to a collection.\n\n\n\nStep 5: Assign the new vDisk to a collection\n\n\nAccess the target PVS server via the PVS Console. The new vDisk should appear under the targeted PVS store (refresh may be required).\nTest the new vDisk by assigning it to a device.\nUsing Citrix PVS best practices, assign the new vDisk to a collection of targeted devices.\n\n\n\nNow that you have tested your Layered Image in PVS, it's time to add an App Layer to the image.\n\n\nAdd your first App Layer and republish the Layered Image\n\n\nIn this part of the test drive you will:\n\n\nStep 1: Create a Platform Layer for packaging other layers\nStep 2: Create an App Layer\nStep 3: Publish a new Layered Image containing the new App Layer\n\n\n\nSimilar to the process for creating a Platform Layer, you will prepare an App Layer in the UMC, deploy a Packaging Machine VM in vSphere where you install Notepad++, then import the VM into the new layer. You will add this layer to your Image Template, and publish a new version of the Layered Image.\n\n\nStep 1: Create a Platform Layer for packaging other layers\n\n\nThe Platform Layer for packaging layers is where you install the tools and settings specific to a particular hypervisor. Putting platform-specific software on the Platform Layer means that your App Layers do not need to include it, and therefore can be used on multiple platforms.\n\n\nUsing the UMC, you will prepare this layer and deploy a Packaging Machine VM in vSphere. On the Packaging Machine, you will install the hypervisor software and configure the hypervisor settings, as needed. Finally, you will import the Packaging Machine to create the Platform Layer for packaging layers.\n\n\nSelect \nLayers > Platform Layers\n and then \nCreate Platform Layer\n from the Action bar to open the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nIn the OS Layer tab, select the OS Layer you created earlier.\nIn the Connector tab, the \nvSphere\n Connector Configuration.\nOn the Packaging Disk tab, notice the Packaging Disk \nFile name\n. This disk will be used for the Packaging Machine (the VM) where you will install the platform tools and configure the settings.\nIn the Icon Assignment tab, select one of the default icons.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description. Once the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment. Example:\nLog into your vSphere web client, then use the information displayed in the Packaging Disk Task (shown above) to navigate to the Packaging Machine in vSphere.\nPower on the Packaging Machine, and remote log into it. Remote log in to the Packaging Machine with the User account you used to create the operating system.\nDomain join the Packaging Machine VM.\nInstall your vmTools, and configure the vSphere settings as you want them to be when the Packaging Machine for this layer starts.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process. If there is an outstanding operation, wait for it to complete.\nOnce any pending operations are complete, shut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > Platform Layers\n, then select the Platform Layer and click \nFinalize\n.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nStep 2: Create an App Layer\n\n\nSelect \nLayers > App Layers\n and then \nCreate App Layer\n from the Action bar to open the Create App Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nIn the OS Layer tab, select the OS Layer you created earlier.\nIn the Connector tab, choose the vSphere \nConnector Configuration\n you used to create the Platform Layer for packaging other layers.\nOn the Platform Layer tab, choose the Platform Layer you just created.\nOn the Packaging Disk tab, enter a \nFile name\n for the Packaging Disk. This disk will be used for the Packaging Machine (the VM) where you will install the application.\nIn the Icon Assignment tab, select one of the supplied icons for the layer, or if you'd like to use the application icon, you can browse for it and import it into this tab.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the task to expand it. Once complete, the Task bar displays the location of the Packaging Disk or Machine in your environment.\nLog into your vSphere web client, then use the information displayed in the above Task to navigate to the Packaging Machine in vSphere.\nPower on the Packaging Machine, and remote log into it. Remote log in to the Packaging Machine with the User account you used to create the operating system in vSphere.\nInstall the application, leaving the application and the Packaging Machine in the state you want it to be for the user.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to expedite the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nhere\n.\nOnce any pending operations are complete, shut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > App Layers\n, and select \nFinalize\n in the Action bar.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nOnce the App Layer task is marked \nDeployable\n , you can add the new App Layer to your Image Template.\n\n\nStep 3: Publish a new Layered Image containing the new App Layer\n\n\nSelect \nImages\n, then select your Image Template and click \nEdit Template\n.\nIn the Edit Template wizard, select the Application Assignment tab and select the \nNotepad++ Layer\n.\nSkip the Confirm and Complete tab, and click Save Template Changes to save the updated template.\nBack in the Images module, select the Template again and click \nPublish Layered Image\n. This opens the Publish Layered Image wizard.\nConfirm the settings and click \nPublish Layered Image\n.\nMonitor the tasks for completion.\nOnce the task is complete, access the target PVS server via the PVS Console. The new vDisk should appear under the targeted PVS store (refresh may be required).\nAssign the new vDisk either to a new or existing collection.\n\n\n\nTest drive: Publish to PVS for XenApp 6.5 users\n\n\nOnce Unidesk is set up, you can use this test drive to create your first layers in vSphere, and then publish a test image to Horizon View. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.\n\n\nPlease download the Test Drive from this Unidesk \nforum article\n.\n\n\nIf you have any questions, please ask your Unidesk Solutions Architect for assistance.\n\n\nTest drive: Publish to MCS for Nutanix AHV\n\n\nOnce Unidesk is set up, you can use this test drive to create your first layers in Nutanix AHV, and then publish a test image to Citrix MCS. This example uses Windows 10 64-bit, Citrix MCS, and Citrix XenDesktop 7.\n\n\nPlease download the Test Drive from this Unidesk \nforum article\n.\n\n\nIf you have any questions, please ask your Unidesk Solutions Architect for assistance.\n\n\nTest drive: Publishing to Azure RDSH\n\n\nIn this article:\n\n\nPlatforms used in this test drive\nComponents you will create\nPrerequisites\nPublish a test image with an OS Layer and a Platform Layer\nAdd your first App Layer and republish the Layered Image\n\n\n\nPlatforms used in this test drive\n\n\nCreate Layers in:\nAzure\nPublish Layered Images to:\nAzure RDSH\nFor delivery to:\nAzure users\n\n\n\nThis test drive leads you through the process of publishing a Layered Image as a virtual disk to an Azure server. the hypervisor in this scenario is Azure, and the connection broker is Azure.\n\n\nComponents you will create\n\n\nComponent\nDescription\nOS Layer\nContains Windows Server 2012 R2\nUnidesk Tools are installed\nPlatform Layer\nLayer containing all platform-related software and settings\nCreated in Azure using an Azure VM for the Packaging Machine\nApp Layer\nNotepad++\nImage Template\nCreated in two stages:\nStage 1: Includes OS Layer ; Platform Layer\nStage 2: Includes the addition of App Layer\nLayered Image\nImage Template\nOS Layer\nPlatform Layer\nApp Layer\nAzure virtual disk\nContains the Unidesk Layered Image\n\n\n\nPrerequisites\n\n\nUnidesk\no\n Unidesk ELM installed on a server in your Azure environment.\no\n Unidesk Tools downloaded from the Unidesk Download page and copied to a location that the Packaging Machine VM will be able to access.\nOS for images\no\n OS for Layered Images. You need a Unidesk-supported \noperating system\n to import into an OS Layer. This OS will be used to build your Layered Images.\nAzure\no\n Azure account and subscription. To deploy and configure the Unidesk ELM, you will need the credentials for an account that has administrative access to your Azure subscription. For more information, refer to the \nMicrosoft Azure Sign in page\n.\n\n\n\nPublish a test image with an OS Layer and a Platform Layer\n\n\nIn this part of the test drive you will:\n\n\nStep 1: Create an OS Layer\nStep 2: Create a Platform Layer for Publishing Layered Images\nStep 3: Create an Image Template\nStep 4: Publish a Layered Image to Azure RDSH\nStep 5: Provision a Session Host\n\n\n\nStep 1: Create an OS Layer\n\n\nIn this step you will create an Azure VM to use as your OS Machine, and prepare the OS on it. You will then use an Azure Connector Configuration to import the OS image into a new OS Layer.\n\n\nIn the \nMicrosoft Azure portal\n, create a new VM from the \"Windows Server Remote Desktop Session Host Windows Server 2012 R2\" image (\nNew > Virtual Machine > Windows Server Remote Desktop Session Host Windows Server 2012 R2\n).\nImportant:\n When creating the image, be sure to choose the default cluster allocation size of 4K.\nChoose \nResource Manager\n from the \nSelect a deployment model\n option list and click \nCreate\n.\nNote:\n Unidesk for Azure does \nnot\n support the \nClassic\n option from the \nSelect a deployment model\n option list.\nCreate the OS machine by completing the Create virtual machine wizard.\nThe name of the new server machine you specify must comply with Azure naming conventions.\nThe User name and Password of the new server machine you specify becomes the User name and Password of any Packaging Machines that are subsequently created containing this OS Layer.\nBe sure that the value for the Resource group location matches the Storage account location that you configured in the Platform Connector Configuration.\nReboot the new machine, and log into it remotely.\nOn the new machine, turn off Windows Automatic Updates (\nControl Panel > System and Security > Windows Update > Change Settings\n).\nIn a web browser, navigate to the \nUnidesk Download Center\n, and in the Tools section, download the Unidesk OS Machine Tools.\nIn Windows Explorer, navigate to the C:\\Windows\\OEM directory, and rename or delete the \"Unattend.wsf\" file.\nOn the new machine, install the Unidesk drivers by running \nsetup_x64.exe\n.\nEnsure that this machine is \nnot\n joined to a domain, as Session Hosts join a domain when you provision them from a Layered Image.\nPerform any pending reboots to the OS machine, and shut down the new OS machine.\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n. This opens the Create Operating System Layer Wizard.\nFirst, specify a \nLayer Name\n and \nVersion\n in the Layer Details tab.\nIn the Connector tab, select the \nAzure Connector Configuration\n, which is where you downloaded the Azure files. Once connected to the file share, you can select the operating system to import.\nIn the Import Disk Details tab, enter the name of the Azure Resource Group that contains the OS disk, and the name of the OS disk, both required values.\nNote:\n If you specified a file share on the Connector tab, enter the name of the OS disk residing on that file share or click \nBrowse\n to select it.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\nWhen the task completes, the new OS Layer in the Unidesk Management Console (UMC) displays a \nDeployable\n status.\n\n\n\nStep 2: Create a Platform Layer for Publishing Layered Images\n\n\nThe Platform Layer is where you will install software specific to an environment. Putting all platform-specific software in a Platform Layer allows you to reuse OS and App Layers in Layered Images on multiple platforms. The platforms for this test drive include Azure and Azure RDSH.\n\n\nUsing the Create Platform Layer wizard in the UMC, you will:\n\n\nDeploy a Packaging Machine in Azure.\nInstall all platform software and tools.\nOnce the Layer is ready, rearm KMS. Assuming your OS image was activated using KMS, you'll rearm KMS when creating the Platform Layer. (This also applies to when you add a version to the Platform Layer.)\nImport the Packaging Machine to create the Platform Layer.\n\n\n\nHere's how to create the Platform Layer:\n\n\nSelect \nLayers > Platform Layers\n and then \nCreate Platform Layer\n to open the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nIn the OS Layer tab, select the OS Layer you created.\nIn the Connector tab, click \nNew\n to add an \nAzure Connector Configuration information\n for creating the Packaging Machine VM. Use the \nprerequisite\n Azure account and subscription information to complete the fields. Click \nTEST\n to verify the connection, then click \nSAVE\n.\nIn the Platform Types tab, select \nThis Platform Layer: will be used for creating and updating Layers\n. For about this choice, see Platform Layer Essentials.\nFrom the Hypervisor menu, select \nAzure\n.\nOn the Packaging Disk tab, notice the Packaging Disk \nFile name\n. This disk will be used for the Packaging Machine (the VM) where you will install the hypervisor tools and configure the settings.\nIn the Icon Assignment tab, select one of the default icons.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description. Once the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment. Example:\nLog into the Azure portal (https://portal.azure.com) from your web browser.\nClick the link in the Create Platform Layer Task (shown above) to navigate to the Packaging Machine in Azure. (You must be logged into Azure for the link to work.)\nOn the Custom deployment panel, complete the required fields for customizing your Azure parameters.\nPackaging Machine Name - must conform to Azure VM name requirements.\nSize - the Azure VM size of the packaging machine.\nVirtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.\nRemote log in to the Packaging Machine you created in Azure. Be sure to log in using the User account you used to create the OS in Azure.\nInstall your Azure tools, and configure the Azure settings as you want them to be when the Packaging Machine for this layer starts.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process. If there is an outstanding operation, wait for it to complete.\nOnce any pending operations are complete, if the Finalize process tells you to reboot the machine, be sure to rearm KMS again.\nShut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > Platform Layers\n, then select the Platform Layer and click \nFinalize\n.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nWhen the new task becomes \nDeployable\n , you can add your new layers to an Image Template.\n\n\nStep 3: Create an Image Template\n\n\nCreate an Image Template that includes the same OS Layer as you used in the Platform Layer you just created.\n\n\nSelect \nImages\n and click \nCreate Template\n. The Create Template Wizard opens.\nType a name for the template and select an icon for the Layer.\nIn the OS Layer tab choose the OS Layer.\nOn the Confirm and Complete tab, click \nCreate Template\n.\n\n\n\nNext, you can publish the Layered Image using this template.\n\n\nStep 4: Publish a Layered Image to Azure RDSH\n\n\nSelect \nImages\n. Your Template is displayed.\nSelect the Template and click \nPublish Layered Image\n. This opens the Publish Layered Image wizard.\nOn the Connector tab, select the Azure RDSH Connector Configuration. If you don't have one yet, click \nNew\n to open the Azure RDSH Connector Configuration page, and enter the information, as described \nhere\n.\nOn the Platform Layer tab, select the Platform Layer that contains the Azure software and settings.\nOn the Layered Image Disk tab, edit the Layered Image Disk Filename, and keep the default values for the rest of the settings.\nConfirm and complete the wizard, then expand the Task bar at the bottom of the window and monitor the task. When the task is \nDone\n, the Layered Image virtual disk is ready.\n\n\n\nStep 5: Provision a Session Host\n\n\nIn the \nCustom deployment\n  template, enter the information to provision a Azure RD Session Host.\n\n\nComplete the Session Host Parameters shown below, using the host's Fully Qualified Domain Name (FQDN).\nSelect the Azure Resource Group.\nSpecify the Resource Group Location.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will not be deployed and you will have to reattempt deployment.\nReview the legal terms, and if you accept them, click \nCreate\n. This creates a Session Host provisioned with the Layered Image in Azure.\nWhile Azure creates the virtual machine, you can track the progress under Virtual Machines in the hub menu.\nPower off the Session Host, power it back on, and add it to an RDS collection. Please see the \nTechNet Reference\n for details.\n\n\n\nOnce you have tested your Layered Image in Azure, it's time to add an App Layer to the image.\n\n\nAdd your first App Layer and republish the Layered Image\n\n\nIn this part of the test drive you will:\n\n\nStep 1: Create a Platform Layer for packaging other layers\nStep 2: Create an App Layer\nStep 3: Publish a new Layered Image containing the new App Layer\n\n\n\nSimilar to the process for creating a Platform Layer, you will prepare an App Layer in the UMC, deploy a Packaging Machine VM in Azure where you install Notepad++, then import the VM into the new layer. You will add this layer to your Image Template, and publish a new version of the Layered Image.\n\n\nStep 1: Create a Platform Layer for packaging other layers\n\n\nThe Platform Layer for packaging layers is where you install the tools and settings specific to a particular hypervisor. Putting platform-specific software on the Platform Layer means that your App Layers do not need to include it, and therefore can be used on multiple platforms.\n\n\nUsing the UMC, you will prepare this layer and deploy a Packaging Machine VM in Azure. On the Packaging Machine, you will install the hypervisor software and configure the hypervisor settings, as needed. Finally, you will import the Packaging Machine to create the Platform Layer for packaging layers.\n\n\nSelect \nLayers > Platform Layers\n and then \nCreate Platform Layer\n from the Action bar to open the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nIn the OS Layer tab, select the OS Layer you created earlier.\nIn the Connector tab, the \nAzure\n Connector Configuration.\nOn the Packaging Disk tab, notice the Packaging Disk \nFile name\n. This disk will be used for the Packaging Machine (the VM) where you will install the platform tools and configure the settings.\nIn the Icon Assignment tab, select one of the default icons.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description. Once the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment. Example:\nLog into the Azure portal (https://portal.azure.com) from your web browser.\nClick the link in the Create Platform Layer Task (shown above) to navigate to the Packaging Machine in Azure. (You must be logged into Azure for the link to work.)\nOn the Custom deployment panel, complete the required fields for customizing your Azure parameters.\nPackaging Machine Name - must conform to Azure VM name requirements.\nSize - the Azure VM size of the packaging machine.\nVirtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.\nInstall the Azure tools, and configure the Azure settings as you want them to be when the Packaging Machine for this layer starts.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process. If there is an outstanding operation, wait for it to complete.\nOnce any pending operations are complete, shut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > Platform Layers\n, then select the Platform Layer and click \nFinalize\n.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nStep 2: Create an App Layer\n\n\nSelect \nLayers > App Layers\n and then \nCreate App Layer\n from the Action bar to open the Create App Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values.\nIn the OS Layer tab, select the OS Layer you created earlier.\nIn the Connector tab, choose the Azure \nConnector Configuration\n you used to create the Platform Layer for packaging other layers.\nOn the Platform Layer tab, choose the Platform Layer you just created.\nOn the Packaging Disk tab, enter a \nFile name\n for the Packaging Disk. This disk will be used for the Packaging Machine (the VM) where you will install the application.\nIn the Icon Assignment tab, select one of the supplied icons for the layer, or if you'd like to use the application icon, you can browse for it and import it into this tab.\nIn the Confirm and Complete tab, review the settings and click \nCreate Layer\n.\nExpand the Tasks bar at the bottom of the UI, and double-click the task to expand it. Once complete, the Task bar displays the location of the Packaging Disk or Machine in your environment.\nLog into the Azure portal (https://portal.azure.com) from your web browser.\nClick the link in the Create App Layer Task (shown above) to navigate to the Packaging Machine in Azure. (You must be logged into Azure for the link to work.)\nOn the Custom deployment panel, complete the required fields for customizing your Azure parameters.\nPackaging Machine Name - must conform to Azure VM name requirements.\nSize - the Azure VM size of the packaging machine.\nVirtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.\nInstall the application, leaving the app and the Packaging Machine in the state you want it to be for the user.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages about the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to expedite the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nhere\n.\nOnce any pending operations are complete, shut down the Packaging Machine by double-clicking the \nShutdown For Finalize\n icon again.\nReturn to the UMC, and select \nLayers > App Layers\n, and select \nFinalize\n in the Action bar.\n Use the Task bar to monitor when the layer becomes deployable.\n\n\n\nOnce the App Layer task is marked \nDeployable\n , you can add the new App Layer to your Image Template.\n\n\nStep 3: Publish a new Layered Image containing the new App Layer\n\n\nSelect \nImages\n, then select your Image Template and click \nEdit Template\n.\nIn the Edit Template wizard, go to the Application Assignment tab and select the \nNotepad++ Layer\n. Then complete the wizard to save the template.\nBack in the Images module, select the Template again and click \nPublish Layered Image\n. This opens the Publish Layered Image wizard.\nIn the Publish Layered Image wizard, select the Azure RDSH Connector Configuration you created earlier.\nIn the Platform Layer, select the layer you created earlier.\nConfirm the settings and click \nPublish Layered Image\n.\nMonitor the tasks for completion.\nOnce the task is complete, access the target Azure server via the Azure Portal. The new virtual disk should appear under the targeted Azure store (refresh may be required).\nAssign the new virtual disk either to a new or existing collection.\n\n\n\nTest drive: Publish to VMware Horizon View\n\n\nOnce Unidesk is set up, you can use this test drive to create your first layers in vSphere, and then publish a test image to Horizon View. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.\n\n\nPlease download the Test Drive from this Unidesk \nforum article\n.\n\n\nIf you have any questions, please ask your Unidesk Solutions Architect for assistance.\n\n\nTest drive: Publish to Microsoft RDS in Hyper-V\n\n\nOnce Unidesk is set up, you can use this test drive to create your first layers in Hyper-V, and then publish a test image to MS RDS. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.\n\n\nPlease download the Test Drive from this Unidesk \nforum article\n.\n\n\nIf you have any questions, please ask your Unidesk Solutions Architect for assistance.\n\n\nLayer Essentials\n\n\nIn this article:\n\n\nOS Layers\nPlatform Layers\nApp Layers\nUser Layers (Unidesk Labs)\nVerifying Layers\n\n\n\nOS Layers\n\n\nWhat is an OS Layer?\n\n\nAn OS Layer includes the software and settings for the operating system that you deploy as part of your other layers and ultimately, your Layered Images. Once you have prepared the OS disk for deployment, you can create a Unidesk Operating System Layer by importing the OS disk into a new Layer.\n\n\nWhy layer my OS image?\n\n\nWith an OS Layer, you can install your operating system once, and update it by adding a new Version to the Layer whenever there's a new patch or update. You can deploy this layer, or a version of it, in every image you publish. This allows you to maintain one OS image and use it to provision all of your servers.\n\n\nCan I deploy more than one OS Layer?\n\n\nIf you need to support more than one operating system, for example, if you need both Windows Server 2012 R2 and Windows Server 2008 R2, you can create more than one OS Layer. However, each App Layer is only compatible with the OS Layer you use to create it, and if you deploy two OS Layers, you will also need to deploy a compatible App Layer for each one. Further, in future releases when deploying Elastic Layers to users, those layers will only be compatible with users' desktops that use the same OS Layer.\n\n\nIf you can support your users with a single OS Layer, the work associated with creating and updating App Layers will be much reduced.\n\n\nCan I deploy more than one version of the same OS Layer?\n\n\nEach time you need to deploy operating system patches and updates, you will do so by adding a new Version to the OS Layer. You can continue to publish Layered Images using any version of the OS Layer.\n\n\nWhat do I need to create an OS Layer?\n\n\nThe prerequisites for creating an OS Layer include:\n\n\nA \nUnidesk-supported operating system\nUnidesk ELM and network file share installed and configured\n\n\n\nHow do I start?\n\n\nSee the steps to \nCreate an OS Layer\n.\n\n\nPlatform Layers\n\n\nA Platform Layer is a layer that includes platform-specific configuration settings, tools, and other software required for your OS and Apps to be installed in or to run in a particular environment.\n\n\nTypes of Platform Layers\n\n\nA Platform Layer for \nPackaging\n (required in some cases, see below)\nPlatform Layer for \nPublishing\n (always required)\n\n\n\nPlatform Layer for packaging layers and versions\n\n\nThe only time you need a Platform Layer for \nPackaging\n  layers is when your OS image was created on a different hypervisor than the one where you are building your other layers. When \ncreating an App Layer or Layer Version\n , or OS Versions, the purpose of the Platform Layer is to ensure that any hypervisor-related software and settings are available during the installation of the application(s) on that layer, if needed. If you choose to use a Platform Layer for Packaging a layer, the hypervisor-related software will only be used during layer packaging, and has \nno effect\n  on where you can \npublish\n  the layer as part of a Layered Image.\n\n\nPlatform Layer for publishing Layered Images\n\n\nA Platform Layer for \nPublishing\n  is \nrequired\n  when you publish Layered Images. The purpose of the Platform Layer for Publishing is to include the settings and software that the Layered Image needs to be \ndeployed in your environment\n . When creating a Platform Layer for Publishing, Unidesk removes unselected (and unnecessary) tools and software related to the platforms you are \nnot\n  publishing to. This is to prevent any unnecessary platform software from slowing down the Layered Image when it runs in the target environment.\n\n\nGet started with Platform Layers\n\n\nFor details about creating Platform Layers, see Create a Platform Layer .\n\n\nApp Layers\n\n\nWhat is an App Layer?\n\n\nAn App Layer is a virtual disk containing one or more applications that you can use in Layered Images. You can combine an App Layer with any other App Layers and a Platform Layer, as long as the OS Layer used to create the App Layer is selected.\n\n\nWith most applications, creating an App Layer is simple. In a few cases, it's best to start with tips from experienced users, so the Unidesk Forum includes \nApplication Layer Recipes\n that you can search for tips about a particular application before you start.\n\n\nGet started with App Layers\n\n\nTo create an App Layer, you use the Create App Layer wizard to deploy a Packaging Machine in your environment and install the application on the Packaging Machine, leaving the application in the state you want it to be in for users. Then you finalize the Layer.\n\n\nTo get started with App Layers, see Create an App Layer.\n\n\nUser Layers (Unidesk Labs)\n\n\nA User Layer is a virtual disk where a user's app data and configuration settings are saved. User Layers are created when you:\n\n\nPublish a Layered Image with \nElastic Layering\n set to \nApplication and User Layers\n.\nUsers log into their desktops on the above Layered Image.\n\n\n\nWith User Layers enabled on the Layered Image, users can install applications locally on their desktops, and the apps and their data will be saved in the User Layer.\n\n\nLearn more about how to User Layers (Unidesk Labs).\n\n\nVerifying Layers\n\n\nIf there are Layer integrity messages during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized. The new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nCreate Layers\n\n\nOnce Unidesk is installed and set up, you can install your software in Layers.\n\n\nBefore you start\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM)\n\n\nSet up Unidesk\n\n\nInstall your software in reusable Unidesk Layers\n\n\nCreate an OS Layer\nCreate a Platform Layer\nCreate an App Layer\n\n\n\nNext Step\n\n\nPublish a Layered Image\n\n\nCreate and update OS Layers\n\n\nStart by preparing your OS image for use in Unidesk, then import it to create your OS Layer. Then use the instructions listed below to update the layer.\n\n\nPrepare an OS image\n\n\nOn which platform are you preparing the OS?\n\n\nPrepare the OS Image (vSphere)\n\n\nThis topic explains how to prepare an OS Image for the Unidesk environment, using the \nOS Machine Tools\n  available for download on the Unidesk \nDownload\n page.\n\n\nNotes:\n\n\nThe OS Image should \nnot\n be in a domain.\nThe OS Image should get its IP address from DHCP.\nUsing Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image.\nEnsure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools.\nThe Paravirtual SCSI controller is \nnot\n supported. You must use the default controller (SCSI BusLogic) for the OS to be functional. Unidesk supports the LSI Logic SAS controller type. If you subsequently change the SCSI controller type to anything else, such as VMware Paravirtual SCSI controller, the OS Layer import will fail.\n\n\n\nWhich operating system are you using?\n\n\nChoose the operating system you are using for the OS Image:\n\n\nWindows Server 2012 R2 (Session Host)\nWindows Server 2008 R2\nWindows 10\nWindows 7 \n\n\n\nPrepare a Windows Server 2012 R2 image (Session Host)\n\n\nSTEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine\n\n\nIn the vSphere client:\n\n\n Create a VM for the OS image.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nImportant:\n You can have just \none network device\n for the virtual machine, and it must be the VMXNET 3 network adapter, as the default E1000 adapter (or even a ghost NIC leftover from an E1000 adapter) can cause customization timeout errors on the VM when attempting to boot the image in environments such as Citrix PVS, Citrix MCS, or VMware Horizon View.\nConfigure a virtual hard disk that is large enough for a Windows operating system installation, and make sure it is accessible by the Unidesk Management Appliance.\nInstall Windows Server 2012 R2.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nInstall VMware Tools on your OS image.\n\n\n\nSTEP 2: Copy the Unidesk OS Machine Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select \nEnable\n. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimization.cmd) that will be run to optimize the image during Desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a VMware snapshot of it, so that you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\nThe installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 2008 R2 image\n\n\nSTEP 1: Set up a Windows Server 2008 R2 OS Image on a virtual machine\n\n\nIn the vSphere client:\n\n\n Create a VM for your OS image, making sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nImportant:\n You can have just \none network device\n for the virtual machine, and it must be the VMXNET 3 network adapter, as the default E1000 adapter (or even a ghost NIC leftover from an E1000 adapter) can cause customization timeout errors on the VM when attempting to boot the image in environments such as Citrix PVS, Citrix MCS, or VMware Horizon View.\nIf you are using Citrix PVS or VMware Horizon View, install Windows Server 2008 R2 Service Pack 1 (SP1).\nNotes:\n \nIf you do not install SP1, an error occurs when you try to install View Agent in the virtual machine.\nWhen creating the image, be sure to choose the default cluster allocation size of 4K.\nIf using PVS:\nIn the VM properties, make sure the PCI slot number is 192, as shown below (mouse over the image to enlarge it):\nInstall KB2550978 hotfix:\nhttps://support.microsoft.com/en-us/kb/2550978\nRun cmd as Administrator, and enter the following commands:\nset devmgr_show_nonpresent_devices=1run devmgmt.msc in the same cmd window\nNote:\n You must run these commands, or the next command will not show hidden devices (ghost NICs)\nSelect \nView >Show hidden devices \n in Device Manager. This shows dead NICs as grayed out.\nUninstall the dead NIC and reboot the system.\nInstall VMware Tools on the OS image.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts, see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows Server 2008 R2\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a VMware snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a VMware snapshot of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 10 image\n\n\nWhen preparing the OS Image for import into a Unidesk Operating System Layer, you can speed up start times by \nremoving Windows 10 built-in applications\n. If you do, we recommend removing these applications either on the OS Image itself, or on the Operating System Layer.\n\n\nSTEP 1: Set up a Windows 10 image on a virtual machine\n\n\nIn the vSphere client:\n\n\n Create a VM for your OS image.\nImportant:\n When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates:\nLog into the VM.\nSelect \nComputer Config > Administrative Templates > Windows Components > Windows Updates > Config Auto Updates\n.\nSet this to \nDisabled\n.\nThe Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nIf using KMS licensing, run a command window as Administrator, and enter these commands:\nslmgr /skms \nslmgr /rearmrebootslmgr /ipk XXXX-YOUR-KMS-KEY-XXXXslmgr /ato\nInstall the VMware Tools on the OS image.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk Desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join Desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add Desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk Desktops, both to segregate the Desktop from other machines and to avoid applying virtual Desktop-specific GPOs to other types of machines.\nIf you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nYou can enable the Administrator account on each Unidesk Desktop by selecting Enable. Remember to also enable this account in your OS Image or Operating System Layer version. You can also enable the Administrator account for your OS Image and then have it disabled in the deployed Desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account \ncannot\n be preconfigured in the OS Image.\nYou can create a Desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime Zone\nIf your time zone is not listed, you can add it to the \nOther\n box. Be sure to use the \ntime zone\n, \nnot\n the display setting.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the optimizations.exe tool and choose \nRun as administrator\n. This creates a .cmd file (optimizations.cmd) that will be run during Desktop creation to optimize the image.\nFollow the instructions to run the optimizations.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Install .Net Framework 3.5.1\n\n\nThe .Net Framework is a software framework provided by Microsoft that is required for many 3rd party applications to run. To install this feature, follow the steps below.\n\n\nOn the Start menu, select \nControl Panel > Programs and Features\n.\nIn the left panel select \nTurn Windows features on or off.\n A window opens.\nSelect \n.NET Framework 3.5\n, click \nOK\n, and wait for the installation to complete.\nImportant:\n Even if .NET is already installed, continue with the rest of these steps.\nExit the Control Panel.\nIn Notifications in the right-side of your taskbar, click \nAll Settings\n, and open the Windows 10 Settings app.\nSelect Settings > Update ; Security.\nCheck for updates, and install all updates available.\nExit Settings.\nOpen an administrator-level command prompt, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework\\v4.nnnnnngen update /force\nWait for the command to complete, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework64\\v4.nnnnnngen update /force\nExit the command prompt.\n\n\n\nSTEP 6: If using PVS, follow these steps to avoid ghost NICs.\n\n\nInstall KB2550978 hotfix.\nReboot the VM,\nEnter the commands:\nset devmgr_show_nonpresent_devices=devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 7: Create a backup copy of the OS Image\n\n\nOnce the OS Image is ready, create a copy of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a backup copy before installing the Unidesk software onto the OS Image. Without this backup copy, returning to this state requires rebuilding the image.\n\n\nSTEP 8: Install the Unidesk software onto the OS Image\n\n\nRun setup_x64.exe from c:\\Windows\\setup\\scripts.\n\n\n\nOnce this is done, you are ready to create a Unidesk Operating System Layer.\n\n\nPrepare a Windows 7 image\n\n\nSTEP 1: Set up a Windows 7 OS Image on a virtual machine\n\n\nIn the vSphere client:\n\n\n Create a VM for your OS Image.\nImportant: When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nMake sure you have installed VMware Tools on the OS image.\n\n\n\nSTEP 2: Mount or copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts,see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows 2008 R2\nUsing PowerShell for Advanced Domain Join Operations\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: If using PVS, follow these steps to avoid ghost NICs\n\n\nInstall KB2550978 hotfix.\nReboot the VM,\nEnter the commands:\nset devmgr_show_nonpresent_devices=1devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 6: Create a VMware snapshot of the OS Image\n\n\nCreate a VMware snapshot of the OS image so you can return to this state at any time.\nImportant:\n It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\n\nSTEP 7: Install the Unidesk software onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare the OS Image (Azure)\n\n\nThis topic explains how to prepare an OS Image for the Unidesk environment.\n\n\nPrepare a Windows 2012 R2 image (Session Host)\n\n\nThis topic explains how to prepare an OS Image for Session Hosts in the Unidesk environment.\n\n\nNotes:\n \n\n\nThe OS Image should \nnot\n be in a domain.\nThe OS Image should get its IP address from DHCP.\nEnsure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools.\n\n\n\nSTEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine\n\n\nIn the Azure Portal, create a new VM from the \"Windows Server Remote Desktop Session Host Windows Server 2012 R2\" image (\nNew > Compute > Virtual Machine > From Gallery > Windows Server Remote Desktop Session Host Windows Server 2012 R2\n).\nWhen specifying the Size of the virtual machine, we recommend you select A2 or larger.\nImportant:\n When specifying the Cloud Service, select the same Cloud Service that contains your [[[Undefined variable Unidesk.MA]]].\nSelect the same Storage Account that contains your appliances, unless your appliances are in \nPremium Storage\n, in which case you must use a \nStandard Storage\n group.\nLog into the new VM, open a Windows PowerShell window, and run the \nEnable-PSRemoting\n command.\nRestart the new VM.\n\n\n\nSTEP 2: Apply Windows Updates\n\n\nApply all Windows Updates to the image so that it is at the most current Microsoft patch level and complete any reboot processes that Windows Updates may require.\n\n\n\nSTEP 3: Copy the Unidesk Tools onto the OS Image\n\n\nCopy the Unidesk_OS_Machine_Tools RAR file onto the OS Image. You can find these tools in the Unidesk Download center.\nRun the RAR file. This copies the tools to the C:windows\\setup\\scripts directory.\n\n\n\nSTEP 4: Install the Unidesk tools onto the OS Image\n\n\nIn the c:\\Windows\\Setup\\Scripts folder, run Unidesk setup_x64.exe.\n \n \n The installation prompts for the location of the Management Appliance \nIP address\n and the location of the unattend.xml file (the default location is c:\\windows\\panther).\nNote: Do \nnot\n run the UnattendBuilder included with the tools.\n\n\n\nSTEP 5: Run NGen\n\n\nAbout Microsoft NGen operations\n\n\nNGen is the Microsoft \"Native Image Generator\". It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nForce an NGen operation to the foreground\n\n\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible.\n\n\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nEnsure that all NGen processes have run to completion. Optionally, you can now shut down the OS Image VM.\n\n\n\nOnce you have completed these steps, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare the OS Image (Nutanix AHV)\n\n\nThis topic explains how to prepare an OS Image for the Unidesk environment, using the \nOS Machine Tools\n  available for download on the Unidesk \nDownload\n page.\n\n\nNotes:\n\n\nThe OS Image should \nnot\n be in a domain.\nThe OS Image should get its IP address from DHCP.\nEnsure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools.\nUsing Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image.\n\n\n\nWhich operating system are you using?\n\n\nChoose the operating system you are using for the OS Image:\n\n\nWindows Server 2016 (Session Host)\nWindows Server 2012 R2 (Session Host)\nWindows Server 2008 R2 \nWindows 10\nWindows 7 \n\n\n\nPrepare a Windows Server 2016 image (Session Host)\n\n\nSTEP 1: Set up a Windows Server 2016 OS Image on a virtual machine\n\n\nIn the Prism Console:\n\n\nSelect \nTask > VM\n, and switch to \nTable View\n to see the existing VMs.\nClick \n+Create VM\n in the upper right corner, and enter the specifics about the new VM:\nEnter a \nName\n and add a \nDescription\n.\nSelect the number of \nVCPUs\n.\nSet the \nCores per CPU\n.\nSet \nMemory\n.\nSelect \nDisks\n, and create a VM with three disks. The first CD-ROM is the ISO for the OS, the second CD-ROM is for the Nutanix VIRTIO drivers that allow the Nutanix VM to access the disk where you install the OS. To start, one CD-ROM is assigned.\nEdit the values for the assigned CD-ROM:\nFor Operation, select \nClone from ADSF file\n.\nFor Bus Type, select \nIDE\n.\nEnter the \npath\n to your Windows ISO. The path is the combination of the Storage Container and the ISO Name. For example:\n/ISOStore/en_windows_16_enterprise_version_1511_x64_dvd_7224901.iso\nClick \nUpdate\n.\nAdd another disk by clicking the \n+Add New Disk\n button:\nSet the Type to \nCDROM\n.\nSet the Operation to \nClone from ADSF file\n.\nSet the Bus Type to \nIDE\nEnter the path to the Windows VIRTIO Drivers. For example:\n/ISOStore/virtio-win-0.1.102.iso\nClick \nAdd\n.\nClick the \n+Add New Disk\n button.\nSet the Type to \nDisk\n.\nSet the Operation to \nAllocate on Container.\nSet the Bus Type to \nSCSI\n.\nSelect the Container you want to use.\nEnter the \nSize\n \nClick \nAdd\n.\nClick \n+Add new Nic\n.\nEnter the \nVLAN Name\n.\nClick \nSave\n.\nPower on the VM:\nSelect \nTasks > VM\n.\nSwitch to the Table View to see existing VMs.\nSelect the VM in the Table, and click \nPower On\n.\nLaunch the Console by selecting the VM and clicking \nLaunch Console\n. When the VM boots it begins to install the Windows OS from the ISO disk. When the VM boots it will \nbegi\nn to install the Windows OS from the ISO disk.\nWhen asked, \"Where do you want to install Windows?\" notice that even though you added a disk in the VM creation wizard, there is no disk.\nSelect the Load Driver option, and select Browse.\nSelect the CD with the virtio-win-0.1.1 drivers.\nSelect the vioscsi folder, and choose the folder for your Windows OS.\nOnce the driver is installed, select the hard drive that you added earlier and finish installing the OS.\nAfter the OS is installed, manually install the VirtIO drivers:\nLaunch Device Manager.\nSelect \nOther Devices\n, right-click \nEthernet Controller\n and choose \nUpdate Driver Software\n.\nBrowse My Computer, and choose the \nVirtIO CD\n. The ethernet drivers are stored in the \nNetKVM\n folder.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\n\n\n\nSTEP 2: Copy the Unidesk OS Machine Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select \nEnable\n. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimization.cmd) that will be run to optimize the image during Desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a snapshot of it, so that you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\nThe installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows Server 2012 R2 image (Session Host)\n\n\nSTEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine\n\n\nIn the Prism Console:\n\n\nSelect \nTask > VM\n, and switch to \nTable View\n to see the existing VMs.\nClick \n+Create VM\n in the upper right corner, and enter the specifics about the new VM:\nEnter a \nName\n and add a \nDescription\n.\nSelect the number of \nVCPUs\n.\nSet the \nCores per CPU\n.\nSet \nMemory\n.\nSelect \nDisks\n, and create a VM with three disks. The first CD-ROM is the ISO for the OS, the second CD-ROM is for the Nutanix VIRTIO drivers that allow the Nutanix VM to access the disk where you install the OS. To start, one CD-ROM is assigned.\nEdit the values for the assigned CD-ROM:\nFor Operation, select \nClone from ADSF file\n.\nFor Bus Type, select \nIDE\n.\nEnter the \npath\n to your Windows ISO. The path is the combination of the Storage Container and the ISO Name. For example:\n/ISOStore/en_windows_12_enterprise_version_1511_x64_dvd_7224901.iso\nClick \nUpdate\n.\nAdd another disk by clicking the \n+Add New Disk\n button:\nSet the Type to \nCDROM\n.\nSet the Operation to \nClone from ADSF file\n.\nSet the Bus Type to \nIDE\nEnter the path to the Windows VIRTIO Drivers. For example:\n/ISOStore/virtio-win-0.1.102.iso\nClick \nAdd\n.\nClick the \n+Add New Disk\n button.\nSet the Type to \nDisk\n.\nSet the Operation to \nAllocate on Container.\nSet the Bus Type to \nSCSI\n.\nSelect the Container you want to use.\nEnter the \nSize\nClick \nAdd\n.\nClick \n+Add new Nic\n.\nEnter the \nVLAN Name\n.\nClick \nSave\n.\nPower on the VM:\nSelect \nTasks > VM\n.\nSwitch to the Table View to see existing VMs.\nSelect the VM in the Table, and click \nPower On\n.\nLaunch the Console by selecting the VM and clicking \nLaunch Console\n. When the VM boots it begins to install the Windows OS from the ISO disk. When the VM boots it will \nbegi\nn to install the Windows OS from the ISO disk.\nWhen asked, \"Where do you want to install Windows?\" notice that even though you added a disk in the VM creation wizard, there is no disk.\nSelect the Load Driver option, and select Browse.\nSelect the CD with the virtio-win-0.1.1 drivers.\nSelect the vioscsi folder, and choose the folder for your Windows OS.\nOnce the driver is installed, select the hard drive that you added earlier and finish installing the OS.\nAfter the OS is installed, manually install the VirtIO drivers:\nLaunch Device Manager.\nSelect \nOther Devices\n, right-click \nEthernet Controller\n and choose \nUpdate Driver Software\n.\nBrowse My Computer, and choose the \nVirtIO CD\n. The ethernet drivers are stored in the \nNetKVM\n folder.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\n\n\n\nSTEP 2: Copy the Unidesk OS Machine Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select \nEnable\n. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimization.cmd) that will be run to optimize the image during Desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a snapshot of it, so that you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\nThe installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 2008 R2 image\n\n\nSTEP 1: Set up a Windows Server 2008 R2 OS Image on a virtual machine\n\n\nIn the Prism Console:\n\n\nSelect \nTask > VM\n, and switch to \nTable View\n to see the existing VMs.\nClick \n+Create VM\n in the upper right corner, and enter the specifics about the new VM:\nEnter a \nName\n and add a \nDescription\n.\nSelect the number of \nVCPUs\n.\nSet the \nCores per CPU\n.\nSet \nMemory\n.\nSelect \nDisks\n, and create a VM with three disks. The first CD-ROM is the ISO for the OS, the second CD-ROM is for the Nutanix VIRTIO drivers that allow the Nutanix VM to access the disk where you install the OS. To start, one CD-ROM is assigned.\nEdit the values for the assigned CD-ROM:\nFor Operation, select \nClone from ADSF file\n.\nFor Bus Type, select \nIDE\n.\nEnter the \npath\n to your Windows ISO. The path is the combination of the Storage Container and the ISO Name. For example:\n/ISOStore/en_windows_08_enterprise_version_1511_x64_dvd_7224901.iso\nClick \nUpdate\n.\nAdd another disk by clicking the \n+Add New Disk\n button:\nSet the Type to \nCDROM\n.\nSet the Operation to \nClone from ADSF file\n.\nSet the Bus Type to \nIDE\nEnter the path to the Windows VIRTIO Drivers. For example:\n/ISOStore/virtio-win-0.1.102.iso\nClick \nAdd\n.\nClick the \n+Add New Disk\n button.\nSet the Type to \nDisk\n.\nSet the Operation to \nAllocate on Container.\nSet the Bus Type to \nSCSI\n.\nSelect the Container you want to use.\nEnter the \nSize\nClick \nAdd\n.\nClick \n+Add new Nic\n.\nEnter the \nVLAN Name\n.\nClick \nSave\n.\nPower on the VM:\nSelect \nTasks > VM\n.\nSwitch to the Table View to see existing VMs.\nSelect the VM in the Table, and click \nPower On\n.\nLaunch the Console by selecting the VM and clicking \nLaunch Console\n. When the VM boots it begins to install the Windows OS from the ISO disk. When the VM boots it will \nbegi\nn to install the Windows OS from the ISO disk.\nWhen asked, \"Where do you want to install Windows?\" notice that even though you added a disk in the VM creation wizard, there is no disk.\nSelect the Load Driver option, and select Browse.\nSelect the CD with the virtio-win-0.1.1 drivers.\nSelect the vioscsi folder, and choose the folder for your Windows OS.\nOnce the driver is installed, select the hard drive that you added earlier and finish installing the OS.\nAfter the OS is installed, manually install the VirtIO drivers:\nLaunch Device Manager.\nSelect \nOther Devices\n, right-click \nEthernet Controller\n and choose \nUpdate Driver Software\n.\nBrowse My Computer, and choose the \nVirtIO CD\n. The ethernet drivers are stored in the \nNetKVM\n folder.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts, see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows Server 2008 R2\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a VMware snapshot of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 10 image\n\n\nWhen preparing the OS Image for import into a Unidesk Operating System Layer, you can speed up start times by \nremoving Windows 10 built-in applications\n. If you do, we recommend removing these applications either on the OS Image itself, or on the Operating System Layer.\n\n\nSTEP 1: Set up a Windows 10 image on a virtual machine\n\n\nIn the Prism console:\n\n\n Create a VM for your OS image.\nImportant:\n When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates:\nLog into the VM.\nSelect \nComputer Config > Administrative Templates > Windows Components > Windows Updates > Config Auto Updates\n.\nSet this to \nDisabled\n.\nThe Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nIf using KMS licensing, run a command window as Administrator, and enter these commands:\nslmgr /skms \nslmgr /rearmrebootslmgr /ipk XXXX-YOUR-KMS-KEY-XXXXslmgr /ato\nInstall the VMware Tools on the OS image.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk Desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join Desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add Desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk Desktops, both to segregate the Desktop from other machines and to avoid applying virtual Desktop-specific GPOs to other types of machines.\nIf you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nYou can enable the Administrator account on each Unidesk Desktop by selecting Enable. Remember to also enable this account in your OS Image or Operating System Layer version. You can also enable the Administrator account for your OS Image and then have it disabled in the deployed Desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account \ncannot\n be preconfigured in the OS Image.\nYou can create a Desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime Zone\nIf your time zone is not listed, you can add it to the \nOther\n box. Be sure to use the \ntime zone\n, \nnot\n the display setting.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the optimizations.exe tool and choose \nRun as administrator\n. This creates a .cmd file (optimizations.cmd) that will be run during Desktop creation to optimize the image.\nFollow the instructions to run the optimizations.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Install .Net Framework 3.5.1\n\n\nThe .Net Framework is a software framework provided by Microsoft that is required for many 3rd party applications to run. To install this feature, follow the steps below.\n\n\nOn the Start menu, select \nControl Panel > Programs and Features\n.\nIn the left panel select \nTurn Windows features on or off.\n A window opens.\nSelect \n.NET Framework 3.5\n, click \nOK\n, and wait for the installation to complete.\nImportant:\n Even if .NET is already installed, continue with the rest of these steps.\nExit the Control Panel.\nIn Notifications in the right-side of your taskbar, click \nAll Settings\n, and open the Windows 10 Settings app.\nSelect Settings > Update ; Security.\nCheck for updates, and install all updates available.\nExit Settings.\nOpen an administrator-level command prompt, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework\\v4.nnnnnngen update /force\nWait for the command to complete, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework64\\v4.nnnnnngen update /force\nExit the command prompt.\n\n\n\nSTEP 6: If using PVS, follow these steps to avoid ghost NICs.\n\n\nEnter the commands:\nset devmgr_show_nonpresent_devices=devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 7: Create a backup copy of the OS Image\n\n\nOnce the OS Image is ready, create a copy of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a backup copy before installing the Unidesk software onto the OS Image. Without this backup copy, returning to this state requires rebuilding the image.\n\n\nSTEP 8: Install the Unidesk software onto the OS Image\n\n\nRun setup_x64.exe from c:\\Windows\\setup\\scripts.\n\n\n\nOnce this is done, you are ready to create a Unidesk Operating System Layer.\n\n\nPrepare a Windows 7 image\n\n\nSTEP 1: Set up a Windows 7 OS Image on a virtual machine\n\n\nIn the Prism console:\n\n\n Create a VM for your OS Image.\nImportant: When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nMake sure you have installed VMware Tools on the OS image.\n\n\n\nSTEP 2: Mount or copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts,see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows 2008 R2\nUsing PowerShell for Advanced Domain Join Operations\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: If using PVS, follow these steps to avoid ghost NICs\n\n\nInstall KB2550978 hotfix.\nReboot the VM,\nEnter the commands:\nset devmgr_show_nonpresent_devices=1devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 6: Create a snapshot of the OS Image\n\n\nCreate a snapshot of the OS image so you can return to this state at any time.\nImportant:\n It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\n\nSTEP 7: Install the Unidesk software onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare the OS Image (XenServer)\n\n\nThis topic explains how to prepare an OS Image for the Unidesk environment, using the \nOS Machine Tools\n  available for download on the Unidesk \nDownload\n page.\n\n\nNotes:\n\n\nThe OS Image should \nnot\n be in a domain.\nThe OS Image should get its IP address from DHCP.\nUsing Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image.\nEnsure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools.\nXenCenter uses Port 5900 to access the console on each VM. Make sure that this port is open on your OS image. Otherwise, the packaging machines or publish images the console will not work until you reboot the VM.\n\n\n\nWhich operating system are you using?\n\n\nChoose the operating system you are using for the OS Image:\n\n\nWindows Server 2012 R2 (Session Host)\nWindows Server 2008 R2 \nWindows 10\nWindows 7 \n\n\n\nPrepare a Windows Server 2012 R2 image (Session Host)\n\n\nSTEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine\n\n\nIn the XenServer client:\n\n\n Create a VM for the OS image.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nConfigure a virtual hard disk that is large enough for a Windows operating system installation, and make sure it is accessible by the Unidesk Management Appliance.\nInstall Windows Server 2012 R2.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nInstall XenServer Tools on your OS image.\n\n\n\nSTEP 2: Copy the Unidesk OS Machine Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select \nEnable\n. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimization.cmd) that will be run to optimize the image during Desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a snapshot of it, so that you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\nThe installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 2008 R2 image\n\n\nSTEP 1: Set up a Windows Server 2008 R2 OS Image on a virtual machine\n\n\nIn the XenServer client:\n\n\n Create a VM for your OS image, making sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nIf you are using Citrix PVS or VMware Horizon View, install Windows Server 2008 R2 Service Pack 1 (SP1).\nNotes:\n \nWhen creating the image, be sure to choose the default cluster allocation size of 4K.\nIf using PVS:\nInstall KB255098 hitfix.\nReboot the VM.\nEnter the commands:\nset devmgr_show_nonpresent_devices=1devmgmt.msc\nUninstall any dead (guost) NICs.\nReboot the system.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nInstall XenTools on the OS image.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts, see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows Server 2008 R2\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Create a snapshot of the OS Image\n\n\nOnce the OS Image is ready, create a VMware snapshot of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\nSTEP 6: Install the Unidesk tools onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nPrepare a Windows 10 image\n\n\nWhen preparing the OS Image for import into a Unidesk Operating System Layer, you can speed up start times by \nremoving Windows 10 built-in applications\n. If you do, we recommend removing these applications either on the OS Image itself, or on the Operating System Layer.\n\n\nSTEP 1: Set up a Windows 10 image on a virtual machine\n\n\nIn the XenServer client:\n\n\n Create a VM for your OS image.\nImportant:\n When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates:\nLog into the VM.\nSelect \nComputer Config > Administrative Templates > Windows Components > Windows Updates > Config Auto Updates\n.\nSet this to \nDisabled\n.\nThe Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nIf using KMS licensing, run a command window as Administrator, and enter these commands:\nslmgr /skms \nslmgr /rearmrebootslmgr /ipk XXXX-YOUR-KMS-KEY-XXXXslmgr /ato\nInstall the VMware Tools on the OS image.\n\n\n\nSTEP 2: Copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk Desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join Desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add Desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk Desktops, both to segregate the Desktop from other machines and to avoid applying virtual Desktop-specific GPOs to other types of machines.\nIf you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nLocal Administrator account\nYou can enable the Administrator account on each Unidesk Desktop by selecting Enable. Remember to also enable this account in your OS Image or Operating System Layer version. You can also enable the Administrator account for your OS Image and then have it disabled in the deployed Desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account \ncannot\n be preconfigured in the OS Image.\nYou can create a Desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime Zone\nIf your time zone is not listed, you can add it to the \nOther\n box. Be sure to use the \ntime zone\n, \nnot\n the display setting.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the optimizations.exe tool and choose \nRun as administrator\n. This creates a .cmd file (optimizations.cmd) that will be run during Desktop creation to optimize the image.\nFollow the instructions to run the optimizations.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: Install .Net Framework 3.5.1\n\n\nThe .Net Framework is a software framework provided by Microsoft that is required for many 3rd party applications to run. To install this feature, follow the steps below.\n\n\nOn the Start menu, select \nControl Panel > Programs and Features\n.\nIn the left panel select \nTurn Windows features on or off.\n A window opens.\nSelect \n.NET Framework 3.5\n, click \nOK\n, and wait for the installation to complete.\nImportant:\n Even if .NET is already installed, continue with the rest of these steps.\nExit the Control Panel.\nIn Notifications in the right-side of your taskbar, click \nAll Settings\n, and open the Windows 10 Settings app.\nSelect Settings > Update ; Security.\nCheck for updates, and install all updates available.\nExit Settings.\nOpen an administrator-level command prompt, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework\\v4.nnnnnngen update /force\nWait for the command to complete, and enter the following commands:\ncd \\windows\\Microsoft.Net\\Framework64\\v4.nnnnnngen update /force\nExit the command prompt.\n\n\n\nSTEP 6: If using PVS, follow these steps to avoid ghost NICs.\n\n\nEnter the commands:\nset devmgr_show_nonpresent_devices=devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 7: Create a backup copy of the OS Image\n\n\nOnce the OS Image is ready, create a copy of it so you can return to this state at any time.\n\n\nImportant: It is critical to create a backup copy before installing the Unidesk software onto the OS Image. Without this backup copy, returning to this state requires rebuilding the image.\n\n\nSTEP 8: Install the Unidesk software onto the OS Image\n\n\nRun setup_x64.exe from c:\\Windows\\setup\\scripts.\n\n\n\nOnce this is done, you are ready to create a Unidesk Operating System Layer.\n\n\nPrepare a Windows 7 image\n\n\nSTEP 1: Set up a Windows 7 OS Image on a virtual machine\n\n\nIn the XenServer client:\n\n\n Create a VM for your OS Image.\nImportant: When creating the image, be sure to choose the default cluster allocation size of 4K.\n Configure the virtual machine hardware settings, for example, the NIC and video memory.\nDisable Windows System Restore and Windows Automatic Updates. The Unidesk\n system handles restore points for you, and Unidesk layer versions allow you to control when updates occur.\nMake sure you have installed VMware Tools on the OS image.\n\n\n\nSTEP 2: Mount or copy the Unidesk Tools onto the OS Image\n\n\nDownload\n the Unidesk_OS_Machine_Tools ZIP file onto the OS Image.\nExtract the Unidesk_OS_Machine_Tools_\nx.x.x\n to c:\\windows\\setup\\scripts.\n\n\n\nSTEP 3: (Optional) Create an answer file for unattended installation on Unidesk desktops\n\n\nIn the c:\\windows\\setup\\scripts folder, right-click the unattend.exe tool and choose \nRun as administrator\n. The unattend builder form opens.\nComplete the unattend form.\nProduct key activation\nFor KMS activation, select KMS Server.\nFor KMS with a Multiple Activation Key (MAK), select KMS with MAK and enter the MAK.\nFor Retail Licensing with a MAK, select Retail with MAK, and the MAK.\nDomain Join\nSelect Enable if you want to configure the unattend.xml file to join desktops to a specific domain. If you plan to use AD join scripts, ensure Enable is \nnot\n selected.\nYou can add desktops to the Computer's container in Active Directory by deleting the OU entry. However, we recommend that you use an alternate OU for Unidesk desktops, both to segregate the desktop from other machines and to avoid applying virtual desktop-specific GPOs to other types of machines.\n If you are supporting multiple OUs within one or more domains, you can join machines in different Domains or OUs by creating different unattend.xml files in different application layers.\nFor information about domain join scripts,see the following Support articles:\nDebugging Domain Join Problems in Windows 7 and Windows 2008 R2\nUsing PowerShell for Advanced Domain Join Operations\nLocal Administrator account\nIf you want to use the unattend.xml file to enable the Administrator account on each Unidesk desktop, select Enable. Remember to also enable this account in your OS Image or Operating System Layer revision. It is possible to enable the Administrator account for your OS Image and then have it disabled in the deployed desktops by clearing the check box.\nIf you want to add an alternate Administrator account, select Enable and enter the account information. This account cannot be pre-configured in the OS Image.\nYou can create a desktop where the Administrator is disabled and the alternate administrator is created and enabled. However for this to work, the Administrator account must be enabled in the OS Image and it cannot be renamed.\nTime zone\nSelect the time zone. If your time zone is not listed, you can add it to the Other box. Be sure to use the time zone, \nnot\n the display setting. A list of time zone settings can be found \nhere\n.\nDisabling automatic activation\nSelect this option if you plan to use the Microsoft Volume Activation Management Tool.\nClick \nSave File\n.\n\n\n\nSTEP 4: (Optional) Optimize the OS Image for the Unidesk environment\n\n\nIn the c:\\windows\\setup\\scripts folder, run the Optimize executable to create a .cmd file (optimize.cmd) that will be run to optimize the image during desktop creation.\nFollow the instructions to run the optimize.cmd file on the OS Image. This removes installation-specific drivers and settings.\nIf you are using the Unidesk Optimizer script and you are enabling the View Persona feature, you must go to the section of the Optimizer script called \nDisable Unnecessary Services to Save Memory and CPU\n, \ndeselect\n the option to \nDisable Offline File Service\n, and click \nSave File\n. This is because View Persona folder redirection requires Offline files to be enabled, and by default, the Unidesk Optimizer turns off Offline files, which are not a requirement for Unidesk.\n\n\n\nSTEP 5: If using PVS, follow these steps to avoid ghost NICs\n\n\nInstall KB2550978 hotfix.\nReboot the VM,\nEnter the commands:\nset devmgr_show_nonpresent_devices=1devmgmt.msc\nRemove any ghost NICs.\nReboot the system.\n\n\n\nSTEP 6: Create a snapshot of the OS Image\n\n\nCreate a snapshot of the OS image so you can return to this state at any time.\nImportant:\n It is critical to create a snapshot before installing the Unidesk software onto the OS Image. Without this snapshot, returning to this state requires rebuilding the image.\n\n\n\nSTEP 7: Install the Unidesk software onto the OS Image\n\n\nIn the Unidesk_OS_Machine_Tools folder, run the Unidesk setup_x86.exe (32-bit) or setup_x64.exe (64-bit).\n \n \n The installation prompts for the location of the unattend.xml file (the default location is c:\\windows\\panther).\n\n\n\nOnce this is done, you are ready to \ncreate a Unidesk Operating System Layer\n.\n\n\nCreate an OS Layer\n\n\nWhere are you importing the OS from?\n\n\nCreate an OS Layer (vSphere)\n\n\nIn this article:\n\n\nBefore you start\nPrepare your OS Image\nImport the OS Image into a new OS Layer\nReference: Create OS Wizard values\n\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nTo create an OS Layer, you need to create a virtual machine in vSphere to serve as the OS Machine, download the OS to a network file share, and then import theOS into Unidesk to create the OS Layer.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer, you'll need to:\n\n\nDeploy the Unidesk ELM\nConfigure a Network File Share\n\n\n\nPrepare your OS Image\n\n\nIn vSphere, create a Windows Server 2012 R2 VM, specifying a network adaptor of \nVMXNet3\n.\nLog into the new VM.\nCheck to see if the operating system is configured with a VMXNet3 card, and if not, change the setting to VMXNet3. Then restart the system and ensure the new network adapter setting is working.\nTurn off Windows Automatic Updates.\nDownload the \nUnidesk OS Machine Tools\n.\nIf you are not going to be publishing to PVS or Azure, you should run the Unattend.exe to build your unattend.xlm file for use in machine creation.\nDouble-click the executable to copy the scripts and files to \nC:\\Windows\\Setup\\scripts\n.\nCreate a snapshot of the VM.\nFrom the \nC:\\Windows\\Setup\\scripts\n folder, run the included Setup_x64.exe file on the VM to install the Unidesk tools.\nShut down the new VM.\nLog into a system that has access to the ELM's Network File Share.\nOpen the vCenter console and find VM.\nRight-click the VM and select \nTemplate > Export OVF Template\n. This preserves any snapshots you may have done.\nIn the wizard that opens, select the name of the file that will be created, and the directory in which you would like to store the file and format: \"Folder of files (OVF)\". Files are downloaded to the Network File Share.\n\n\n\nImport the OS Image into a new OS Layer\n\n\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n in the Action bar. This opens the Create Operating System Layer Wizard.\nIn the Layer Details tab, specify a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can enter \nDescriptions\n of the Layer and Version, and change the \nMax Layer Size\n to accommodate the OS you are going to import. For details, see more about these values \nbelow\n.\nIn the Connector tab, select the file share where you downloaded the vSphere OVF file that you exported in the above procedure.\nIn the OS Disk Details tab, click \nBrowse\n to select the OVF file that you downloaded to your file share.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console displays a \"Deployable\" status.\n\n\nReference: Create OS Wizard values\n\n\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the Layer.\nVersion Description\n - (Optional) Enter a description of the version.\nMax Layer Size\n - (Optional) Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 100 gigabytes. If the version you are creating could requires more space, change this to a realistic value.\nSelect a Connector configuration\n - (Required) Specify a Unidesk Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to vSphere or PVS, select the vSphere or PVS connector with the credentials required to access the account. If the Connector Configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Connector configuration, select it and click \nEdit\n.\nPackaging Disk Filename\n - (Required) The name of the Packaging Machine you created in your environment.\n\n\n\nCreate an OS Layer (Azure)\n\n\nIn this article:\n\n\nBefore you start\nCreate an OS Machine in Azure\nPrepare the OS Image (Windows 2012 R2)\nImport the OS Image into a new OS Layer\n\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you need.\n\n\nThe OS Layer is created using a virtual machine in your infrastructure and the Windows Operating System that you want to use for your Layered Images. You can import the OS from your Azure environment or from the Network File Share attached to the Unidesk ELM.\n\n\nNote:\n  The OS image \nmust\n  be created from a Microsoft ISO, rather than an existing template.\n\n\nBefore you start\n\n\nDeploy ELM from the Microsoft Azure Marketplace\nConfigure a Network File Share\n\n\n\nCreate an OS Machine in Azure\n\n\nTo create an OS Layer, you create a virtual machine in Azure, prepare the OS in Azure, and then import the resulting OS Disk into Unidesk to create the OS Layer.\n\n\nIn the \nMicrosoft Azure portal\n, create a new VM from the \"Windows Server Remote Desktop Session Host Windows Server 2012 R2\" image (\nNew > Compute > Virtual Machine > From Gallery > Windows Server Remote Desktop Session Host Windows Server 2012 R2\n).\nChoose \nResource Manager\n from the \nSelect a deployment model\n option list and click \nCreate\n.\nNote:\n Unidesk for Azure does not support the \nClassic\n option from the \nSelect a deployment model\n option list.\nComplete the Create virtual machine wizard to create the OS machine.\nThe name of the new server machine you specify must comply with Azure naming conventions.\nThe User name and Password of the new server machine you specify becomes the User name and Password of any Packaging Machines that are subsequently created containing this OS Layer.\nBe sure that the value for the Resource group location matches the Storage account location that you configured in the Platform Connector Configuration.\n\n\n\nPrepare the OS Image (Windows 2012 R2)\n\n\nAfter the new server machine has been successfully created, reboot the machine, and log into it remotely.\nTurn off Windows Automatic Updates (\nControl Panel > System and Security > Windows Update > Change Settings\n).\nFrom the new machine, open a web browser, navigate to the \nUnidesk Download Center\n and download the Unidesk OS Machine Tools.\nRename or delete the \"Unattend.wsf\" file in the C:\\Windows\\OEM directory.\nNote:\n Do \nnot\n use the Unattend.exe, as this is \nnot\n needed and will cause issues with Azure.\nOn the new server machine, run the setup_x64.exe file to install the Unidesk drivers on the OS Machine.\nEnsure that this machine is \nnot\n joined to a domain.\nNote:\n Session Hosts will join a domain when you provision them from a Layered Image.\nOptionally, you can shut down the new OS machine.\nNotes:\nBefore you can import the OS Disk (as described in the following section), the state of the OS Machine must be either Stopped, Stopped (deallocated), or Running. Unidesk cannot import the OS Disk if the OS machine is in a Starting or Updating state.\nYou must perform any pending reboots to the OS machine before importing the OS Disk.\n\n\n\nImport the OS Image into a new OS Layer\n\n\nTo import an OS disk into Unidesk:\n\n\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n in the Action bar. This opens the Create Operating System Layer Wizard.\nIn the Layer Details tab, specify a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can enter \nDescriptions\n of the Layer and Version, and change the \nMax Layer Size\n to accommodate the OS you are going to import. For details, see more about these values \nbelow\n.\nIn the Connector tab, choose a \nConnector Configuration\n for the platform where you'll be publishing your Layered Images. If the configuration you need is not listed, add a \nNew\n one and select it from this list. For information about creating a new Platform Connector Configuration, see \nCreate a Connector Configuration\n.\nNote:\n Alternatively, if you have a *.vhd file of the OS disk in your Network File Share, you can select the file share instead of a Unidesk Connector.\nIn the Import Disk Details tab, enter the name of the Azure Resource Group that contains the OS disk and the name of the OS disk, both required values.\nNote:\n If you specified a file share on the Connector tab, enter the name of the OS disk residing on that file share or click \nBrowse\n to select it.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console displays a \"Deployable\" status.\n\n\nReference: Create Operating System Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for, for example, 2012_64_OS. Layer Names can be from 1 to 100 characters in length.\nLayer Description\n - (Optional) Enter a description of the OS Layer.\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the OS Layer. It may be useful to include the date in the version name. Version names can be from 1 to 100 characters in length.\nVersion Description\n - (Optional) Enter a description of the OS version.\nMax Layer Size\n - (Optional) Lets you specify how large the OS is that you are going to import. The default is 30 GB.\nSelect a Connector Configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connect, select it and click \nEdit\n.\nResource Group\n - (Required) The name of the Azure Resource Group containing the OS Import disk.\nVirtual Machine Name\n - (Required) The name of the server machine you created in Azure.\nOS Disk\n - (Required) If you chose a file share in the Connector tab, enter the path to the *.vhd file here or click \nBrowse\n to select it.\nIcon Assignment\n - You can select a default image or browse to select an image of your own. Icon images must have a .jpg or a .png file format.\n\n\n\nCreate an OS Layer (Nutanix AHV)\n\n\nIn this article:\n\n\nBefore you start\nImport the OS Image into a new OS Layer\n\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the \nsupported\n Windows OS that you use for your Layered Images.\n\n\nTo create an OS Layer, you create a virtual machine in Nutanix AHV to serve as the OS Machine, and import it into the new OS Layer.\n\n\nBefore you start\n\n\nAssuming you have \ninstalled\n and \nset up\n the Unidesk Enterprise Layer Manager (ELM Install the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV), you'll need to:\n\n\nPrepare\n a clean OS image.\n\n\n\nImport the OS Image into a new OS Layer\n\n\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n in the Action bar. This opens the Create Operating System Layer Wizard.\nIn the Layer Details tab, specify a \nLayer Name\n and \nVersion\n, both required values. You can enter \nDescriptions\n of the Layer and Version, and change the \nMax Layer Size\n to accommodate the OS you are going to import.\nIn the Connector tab, choose a Nutanix AHV \nConnector Configuration\n that specifies where your clean OS is located. If the configuration you need is not listed, add a \nNew\n one and then select it from this list. For information about adding this Connector Configuration, see \nCreate a Connector Configuration\n.\nIn the OS Disk Details tab, click the \nSelect Virtual Machine\n field. The Virtual Machine field appears.\nClick in the \nVirtual Machine\n field to reveal a list of all VMs.\nSelect a VM from the list, or start by typing the name to filter the list to VMs that contain the search text, and then select the VM.\nClick \nOK\n. The selected VM is validated to ensure that:\nThe VM has a single OS disk attached as a SCSI disk. (Attaching the OS disk as IDE is not supported.)\nThe OS disk can be downloaded via the storage container where that disk resides. The storage container housing the OS disk:\nDoes \nnot\n need to be the same as the configured storage container.\nMust\n be configured so the ELM is in its white list of clients allowed to perform an NFS mount. If the ELM does \nnot\n have permissions to mount the VM's storage container, you must correct this through the Nutanix UI.\nIf there are problems with the VM or OS Disk, an error is displayed. Otherwise, you are returned to the wizard where the VM's name, and the size of the OS disk are listed.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console displays a \"Deployable\" status.\n\n\nCreate an OS Layer (XenServer)\n\n\nIn this article:\n\n\nBefore you start\nPrepare your OS Image\nImport the OS Image into a new OS Layer\n\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nTo create an OS Layer, you create a virtual machine in XenServer to serve as the OS Machine, then export the OS to the ELM's network file share, and import the OS into Unidesk to create the OS Layer.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer, you'll need to:\n\n\nDeploy the Unidesk ELM\nConfigure a Network File Share for the ELM\n\n\n\nPrepare your OS Image\n\n\nIn XenServer, create a Windows Server 2012 R2 VM, specifying a valid network adaptor.\nLog into the new VM.\nTurn off Windows Automatic Updates.\nDownload the \nUnidesk OS Machine Tools\n.\nIf you are not going to be publishing to PVS or Azure, you should run the Unattend.exe to build your unattend.xlm file for use in machine creation.\nDouble-click the executable to copy the scripts and files to \nC:\\Windows\\Setup\\scripts\n.\nCreate a snapshot of the VM.\nFrom the \nC:\\Windows\\Setup\\scripts\n folder, run the included Setup_x64.exe file on the VM to install the Unidesk tools.\nShut down the new VM.\nLog into a system that has access to the ELM's Network File Share.\nLog into XenCenter and select the Infrastructure view.\nShut down the VM, then right-click the VM and choose \nExport\n.\nFor the Location value, select the ELM's \nNetwork File Share\n.\nFor the Format, choose the \nOVF/OVA Package\n.\nComplete the wizard, no specific values required for the remaining choices. The Export runs.\nTo see the status of the Export, click the \nNotifications\n view in the bottom left corner of the XenCenter UI.\nIn the wizard that opens, select the name of the file that will be created, the directory in which you would like to store the file, and the format \nFolder of files (OVF)\n. The files are downloaded to the Network File Share.\n\n\n\nImport the OS Image into a new OS Layer\n\n\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n in the Action bar. This opens the Create Operating System Layer Wizard.\nIn the Layer Details tab, specify a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can enter \nDescriptions\n of the Layer and Version, and change the \nMax Layer Size\n to accommodate the OS you are going to import. For details, see more about these values \nbelow\n.\nIn the Connector tab, select the Network File Share where you downloaded the XenServer .VHD files.\nIn the OS Disk Details tab, click \nBrowse\n to select the *.VHD file that you downloaded to your file share.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console displays a \"Deployable\" status.\n\n\nCreate an OS Layer (network file share)\n\n\nIn this article:\n\n\nCreate an OS Machine\nPrepare the OS\nImport the OS Disk\n\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images. You can import the OS from the Network File Share attached to the Unidesk ELM.\n\n\nCreate an OS Machine\n\n\nTo create an OS Layer:\n\n\nPrepare the OS in your hypervisor\nCreate a VM in your hypervisor to serve as the OS Machine.\nImport the resulting OS Disk into Unidesk to create the OS Layer.\n\n\n\nPrepare the OS\n\n\nTo prepare the OS image:\n\n\nAfter the new server machine has been successfully created, reboot the machine, and log into it remotely.\nTurn off Windows Automatic Updates (\nControl Panel -> System and Security -> Windows Update -> Change Settings\n).\nFrom the new machine, open a web browser, navigate to the \nUnidesk Download Center\n for your platform, and download the Unidesk OS Machine Tools.\nRename or delete the \"Unattend.wsf\" file in the C:\\Windows\\OEM directory.\nOn the new server machine, run the setup_x64.exe file to install the Unidesk drivers on the OS Machine.\nEnsure this machine is \nnot\n joined to a domain.\nNote:\n Session Hosts will join a domain when you provision them from a Layered Image.\n(Optional) Shut down the new OS Machine.\nNotes:\nYou must perform any pending reboots to the OS machine before importing the OS Disk.\nCopy the OS image to the Network File Share for importing into a new OS Layer.\n\n\n\nImport the OS Image\n\n\nTo import an OS disk into Unidesk:\n\n\nIn the Unidesk ELM, select \nLayers > OS Layers\n and click \nCreate OS Layer\n in the Action bar. This opens the Create Operating System Layer Wizard.\nIn the Layer Details tab, specify a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can enter \nDescriptions\n of the Layer and Version, and change the \nMax Layer Size\n to accommodate the OS you are going to import. For details, see more about these values \nbelow\n.\nIn the Connector tab, choose \nNetwork File Share. \nIn the Import Disk Details tab, enter the required values. Enter the name of the OS disk residing on the file share, or click \nBrowse\n to select it.\nIn the Icon Assignment tab, select an icon image to assign to this Layer.\nIn the Confirm and Complete tab, review the details of the OS Layer, enter a comment if required, and click \nCreate Layer\n. If you enter comments, they appear in the Information view Audit History.\n\n\n\nWhen the task completes, the new OS Layer in the Unidesk Management Console displays a \nDeployable\n  status.\n\n\nReference: Create Operating System Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for, for example, 2012_64_OS. Layer Names can be from 1 to 100 characters in length.\nLayer Description\n - (Optional) Enter a description of the OS Layer.\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the OS Layer. It may be useful to include the date in the version name. Version names can be from 1 to 100 characters in length.\nVersion Description\n - (Optional) Enter a description of the OS version.\nMax Layer Size\n - (Optional) Lets you specify how large the OS is that you are going to import. The default is 30 GB.\nSelect a Connector Configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connect, select it and click \nEdit\n.\nResource Group\n - (Required) The name of the Azure Resource Group containing the OS Import disk.\nVirtual Machine Name\n - (Required) The name of the server machine you created in Azure.\nOS Disk\n - (Required) If you chose a file share in the Connector tab, enter the path to the *.vhd file here or click \nBrowse\n to select it.\nIcon Assignment\n - You can select a default image or browse to select an image of your own. Icon images must have a .jpg or a .png file format.\n\n\n\nAdd a version to an OS Layer\n\n\nWhere are you creating this App Layer Version?\n\n\nAdd a version to an OS Layer (XenServer)\n\n\nIn this article:\n\n\nBefore you start \nAdd a Version to an OS Layer\nDeploy a Packaging Machine\nInstall your changes\nVerify the Layer and shut down the Packaging Machine\nFinalize the OS Layer\nReference: Create OS Version Wizard values\n\n\n\nThe Unidesk OS Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer version, you'll need to:\n\n\nConfigure a fileshare\n\n\n\nAdd a version of an OS Layer\n\n\nTo add a version of an OS Layer, take the following steps:\n\n\nIn the Unidesk Management Console, select \nLayers > OS Layers.\nSelect or right-click an OS Layer icon and click \nAdd Version\n. This opens the Create OS Version Wizard.\n(Required) In the Version Details tab, enter a Version identifier. This can be the application version, or anything you choose.\nIn the Connector tab, select a \nConnector configuration\n for the platform where you'll be publishing your Layered Images. You can also modify an existing configuration by selecting it and clicking \nEdit\n. If you have not yet created a Connector Configuration or if the configuration you need is not present, click \nNew\n to create a new \nConnector Configuration\n and select it from this list.\nIn the Platform Layer tab, select a Platform Layer that contains the tools and hardware settings that you need to install and package the OS when adding a Layer Version. Once created, the new Layer Version can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nConfirm and Complete tab - Verify your settings and click \nCreate Version\n. Unidesk runs the task of creating a new OS version. When the task completes, it shows a status of \nAction Required\n. When you double-click the task to expand it, the task contains the following text (refer to the image in the next section): \n\"The Packaging Disk has been published. The virtual machine '\n<\n...>' can be found in folder '\n<\n...>' in datacenter '\n<\n...>'. Power on this virtual machine to install your application. When the installation is complete, power off the virtual machine before clicking Finalize on the Action bar.\"\n\n\n\nNext, you can deploy a Packaging Machine for this OS Layer version.\n\n\nDeploy a Packaging Machine to XenServer\n\n\nThe Packaging Machine is a virtual machine where you install any updates or applications you want to include in the OS Layer. It is strongly recommended that you use a unique Packaging Machine for each Layer. The Packaging Machine is a temporary VM that will be deleted once the OS Layer has been finalized.\n\n\nThe Task Description (example shown in the last step above) contains directions to navigate to the location in XenServer where the Packaging Machine for this Layer has been created.\n\n\nTo create your Packaging Machine in XenServer, begin with the expanded Packaging Disk task shown in step 2 below.\n\n\nLog into your XenServer web client.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task (example shown below) to navigate to the Packaging Machine.\nThe Packaging Machine will be powered on.\n\n\n\nInstall the OS update\n\n\nRemote log into the Packaging Machine in XenServer. Be sure to log in with the User account you used to create the OS in XenServer.\nInstall any updates or applications you want to include in the new OS Layer version, such as Windows Updates or anti-virus applications.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you will shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote: If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the OS Layer\n\n\nOnce the Packaging Machine is created and any apps or updates installed, you'll need to finalize the layer.\n\n\nNote:\n  When you finalize a new version of an OS Layer, Unidesk deletes the Packaging Machine so as not to incur more costs.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nIn the Layers module, select the Layer.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nReference: Create OS Version Wizard values\n\n\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the Layer.\nVersion Description\n - (Optional) Enter a description of the version.\nMax Layer Size\n - (Optional) Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 100 gigabytes. If the version you are creating could requires more space, change this to a realistic value.\nSelect a Platform Connector configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connector configuration, select it and click \nEdit\n.\nPackaging Disk Filename\n - (Required) The name of the Packaging Machine you created in Azure.\n\n\n\nAdd a version to an OS Layer (Azure)\n\n\nIn this article:\n\n\nBefore you start \n\n\nAdd a Version to an OS Layer\n\n\nDeploy a Packaging Machine\n\n\nInstall your changes\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nFinalize the OS Layer\n\n\nReference: Create OS Version Wizard values\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer version, you'll need to:\n\n\nConfigure a fileshare\n\n\n\nAdd a version of an OS Layer\n\n\nTo add a version of an OS Layer, take the following steps:\n\n\nIn the Unidesk UMC, select \nLayers > OS Layers.\nSelect or right-click an OS Layer icon and click \nAdd Version\n. This opens the Create OS Version Wizard.\n(Required) In the Version Details tab, enter a version identifier. This can be the application version, or anything you choose.\nIn the Connector tab, select a \nConnector Configuration\n for the platform where you'll be publishing your Layered Images. If you have not yet created a Platform Connector configuration or if the configuration you need is not present, click \nNew\n to create a new \nConnector Configuration\n and select it from this list.\nPackaging Disk tab - Specify the file name and format of the packaging disk.\nConfirm and Complete tab - Verify your settings and click \nCreate Version\n. Unidesk runs the task of creating a new OS version. When the task completes, it shows a status of Action Required and contains the following text:\n\"The Packaging Disk has been published to Azure. Click \nhere\n to create a Packaging Machine and install your app. When the app installation is complete, finish creating the new Layer Version by clicking Finalize on the Action bar.\"\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task. In the description, either Click here, or copy the link to Azure portal where the Packaging Disk has been published. Click the link in the task to open the Custom deployment window in Azure. Unidesk has pre-populated the fields of the Custom VM window with default values. Log into Azure and create the VM.\nLog into the new VM and install any apps on it that you want to include in the new version of the OS, such as Windows Updates or anti-virus software.\n\n\n\nNext, you can deploy a Packaging Machine for this OS Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install any applications or updates you want to include in this Layer. Typically, we recommend using a unique VM for each Layer.\n\n\nAzure environment\n\n\nTo deploy your Packaging Machine to Azure:\n\n\nClick the link (shown in red below) in the Unidesk Management Console task to open the Azure portal to the Custom deployment area where you can create the virtual machine that you will use as your Unidesk Packaging Machine.\nNote:\n We recommend that you log into the Microsoft Azure account that has the same Subscription before clicking the link or pasting it into a browser.\nComplete the required fields for customizing your Azure parameters.\n\n\n\nNotes:\n \n\n\nUnidesk does not recommend using less than two CPUs for the Packaging Machine. Consequently, the machine size must be at least A2.\nOn the Custom deployment panel, ensure that the value for the Resource Group location matches the Storage location you specified earlier.\n\n\n\nInstall your changes\n\n\nThis section explains how to install your changes on the Packaging Machine you created in Azure.\n\n\nTo make changes to this version of the OS Layer:\n\n\nRemote log into the Packaging Machine you created in Azure.\nNote:\n The User Name and Password to use when you log into the Packaging Machine are the same User Name and Password that were used when the OS Machine was created for the current OS Layer.\nInstall any updates or applications you want to include in the new OS Layer version, such as Windows Updates or anti-virus applications.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, shut down the Packaging Machine when you have verified that the Layer is ready to finalize as described in the following section.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote: If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the OS Layer\n\n\nOnce the Packaging Machine is created and any apps or updates installed, you'll need to finalize the layer.\n\n\nNote:\n  When you finalize a new version of an OS Layer, Unidesk deletes the Packaging Machine so as not to incur more costs.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nIn the Layers module, select the layer.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nReference: Create OS Version Wizard values\n\n\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the Layer.\nVersion Description\n - (Optional) Enter a description of the version.\nMax Layer Size\n - (Optional) Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 100 gigabytes. If the version you are creating could requires more space, change this to a realistic value.\nSelect a Platform Connector configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connector configuration, select it and click \nEdit\n.\nPackaging Disk Filename\n - (Required) The name of the Packaging Machine you created in Azure.\n\n\n\nAdd a version to an OS Layer (Nutanix AHV)\n\n\nIn this article:\n\n\nBefore you start \nAdd a Version to an OS Layer\nDeploy a Packaging Machine\nInstall your changes\nVerify the Layer and shut down the Packaging Machine\nFinalize the OS Layer\nReference: Create OS Version Wizard values\n\n\n\nThe Unidesk OS Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer version, you'll need to:\n\n\nConfigure a fileshare\n\n\n\nAdd a version of an OS Layer\n\n\nTo add a version of an OS Layer, take the following steps:\n\n\nIn the Unidesk Management Console, select \nLayers > OS Layers.\nSelect or right-click an OS Layer icon and click \nAdd Version\n. This opens the Create OS Version Wizard.\n(Required) In the Version Details tab, enter a Version identifier. This can be the application version, or anything you choose.\nIn the Connector tab, select a \nConnector configuration\n for the platform where you'll be publishing your Layered Images. You can also modify an existing configuration by selecting it and clicking \nEdit\n. If you have not yet created a Connector Configuration or if the configuration you need is not present, click \nNew\n to create a new \nConnector Configuration\n and select it from this list.\nExample: If you're using the Nutanix AHV environment to create the Layer, select the \nNutanix AHV\n connector with the credentials and location required to access the Nutanix Storage Container where you want to build the Layer.\nIn the Platform Layer tab, select a Platform Layer that contains the tools and hardware settings that you need to install and package the OS when adding a Layer Version. Once created, the new Layer Version can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nConfirm and Complete tab - Verify your settings and click \nCreate Version\n. Unidesk runs the task of creating a new OS version. When the task completes, it shows a status of \nAction Required\n. When you double-click the task to expand it, the task contains the following text (refer to the image in the next section): \n\"The Packaging Disk has been published. The virtual machine '\n<\n...>' can be found in folder '\n<\n...>' in datacenter '\n<\n...>'. Power on this virtual machine to install your application. When the installation is complete, power off the virtual machine before clicking Finalize on the Action bar.\"\n\n\n\nNext, you can deploy a Packaging Machine for this OS Layer version.\n\n\nAccess the Packaging Machine in Nutanix AHV\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the \nCreate Platform Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in Prism.\nInstall the app for your Layer. This may require a reboot as part of the installation. Once complete, you should see that you have access to the tools, as well as all of the \ndata\n available under the Performance tab for your VM.\n\n\n\nDeploy a Packaging Machine to Nutanix AHV\n\n\nThe Packaging Machine is a virtual machine where you install any updates or applications you want to include in the OS Layer. It is strongly recommended that you use a unique Packaging Machine for each Layer. The Packaging Machine is a temporary VM that will be deleted once the OS Layer has been finalized.\n\n\nThe Task Description (example shown in the last step above) contains directions to navigate to the Storage Container in Nutanix AHV, where the Packaging Machine for this Layer has been created.\n\n\nTo create your Packaging Machine in Nutanix AHV, begin with the expanded Packaging Disk task shown in step 2 below.\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task (example shown below) to navigate to the Packaging Machine.\nThe Packaging Machine will be powered on.\nUse the instructions in the Task Description to navigate to the Packaging Machine in Prism.\n\n\n\nInstall the OS update\n\n\nRemote log into the Packaging Machine in Nutanix AHV. Be sure to log in with the User account you used to create the OS in Nutanix AHV.\nInstall any updates or applications you want to include in the new OS Layer version, such as Windows Updates or anti-virus applications.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state in which you want it to be in for the user.\n\n\n\nNext, you will shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote: If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the OS Layer\n\n\nOnce the Packaging Machine is created and any apps or updates installed, you'll need to finalize the layer.\n\n\nNote:\n  When you finalize a new version of an OS Layer, Unidesk deletes the Packaging Machine so as not to incur more costs.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nIn the Layers module, select the Layer.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nReference: Create OS Version Wizard values\n\n\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the Layer.\nVersion Description\n - (Optional) Enter a description of the version.\nMax Layer Size\n - (Optional) Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 100 gigabytes. If the version you are creating could requires more space, change this to a realistic value.\nSelect a Platform Connector configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connector configuration, select it and click \nEdit\n.\nPackaging Disk Filename\n - (Required) The name of the Packaging Machine you created in Azure.\n\n\n\nAdd a version to an OS Layer (vSphere)\n\n\nIn this article:\n\n\nBefore you start \n\n\nAdd a Version to an OS Layer\n\n\nDeploy a Packaging Machine\n\n\nInstall your changes\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nFinalize the OS Layer\n\n\nReference: Create OS Version Wizard values\n\n\nThe Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.\n\n\nThe OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.\n\n\nBefore you start\n\n\nBefore you can create an OS Layer version, you'll need to:\n\n\nConfigure a fileshare\n\n\n\nAdd a version of an OS Layer\n\n\nTo add a version of an OS Layer, take the following steps:\n\n\nIn the Unidesk Management Console, select \nLayers > OS Layers.\nSelect or right-click an OS Layer icon and click \nAdd Version\n. This opens the Create OS Version Wizard.\n(Required) In the Version Details tab, enter a Version identifier. This can be the application version, or anything you choose.\nIn the Connector tab, select a \nPlatform Connector configuration\n for the platform where you'll be publishing your Layered Images. You can also modify an existing configuration by selecting it and clicking \nEdit\n. If you have not yet created a Platform Connector configuration or if the configuration you need is not present, click \nNew\n to create a new \nConnector Configuration\n and select it from this list.\nIn the Platform Layer tab, select a Platform Layer that contains the tools and hardware settings that you need to install and package an application when adding a Layer Version. Once created, the new Layer Version can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nConfirm and Complete tab - Verify your settings and click \nCreate Version\n. Unidesk runs the task of creating a new OS version. When the task completes, it shows a status of Action Required. When you double-click the task to expand it, the task contains the following text (refer to the image in the next section): \n\"The Packaging Disk has been published. The virtual machine '\n<\n...>' can be found in folder '\n<\n...>' in datacenter '\n<\n...>'. Power on this virtual machine to install your application. When the installation is complete, power off the virtual machine before clicking Finalize on the Action bar.\"\n\n\n\nNext, you can deploy a Packaging Machine for this OS Layer.\n\n\nDeploy a Packaging Machine to vSphere\n\n\nThe Packaging Machine is a virtual machine where you install any updates or applications you want to include in the OS Layer. It is strongly recommended that you use a unique Packaging Machine for each Layer. The Packaging Machine is a temporary VM that will be deleted once the OS Layer has been finalized.\n\n\nThe Task Description (example shown in the last step above) contains directions to navigate to the location in vSphere where the Packaging Machine for this Layer has been created.\n\n\nTo create your Packaging Machine in vSphere, begin with the expanded Packaging Disk task shown in step 2 below.\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task (example shown below) to navigate to the Packaging Machine.\nThe Packaging Machine will be powered on.\n\n\n\nInstall the OS update\n\n\nRemote log into the Packaging Machine in vSphere. Be sure to log in with the User account you used to create the OS in vSphere.\nInstall any updates or applications you want to include in the new OS Layer version, such as Windows Updates or anti-virus applications.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you will shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote: If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the OS Layer\n\n\nOnce the Packaging Machine is created and any apps or updates installed, you'll need to finalize the layer.\n\n\nNote:\n  When you finalize a new version of an OS Layer, Unidesk deletes the Packaging Machine so as not to incur more costs.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nIn the Layers module, select the layer.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nReference: Create OS Version Wizard values\n\n\nVersion\n - (Required) This can be the version of the OS Layer or a version you assign to the Layer. This value is displayed in the Details view of the Layer.\nVersion Description\n - (Optional) Enter a description of the version.\nMax Layer Size\n - (Optional) Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 100 gigabytes. If the version you are creating could requires more space, change this to a realistic value.\nSelect a Platform Connector configuration\n - (Required) Specify a Unidesk Platform Connector for the platform where you'll be publishing your Layered Images. For example, if you're publishing to Azure RD Session Host, select the Azure RDSH connector with the credentials required to access the account. If the configuration you need is not listed, add a \nNew\n one and select it from this list. If you want to change the settings of a Platform Connector configuration, select it and click \nEdit\n.\nPackaging Disk Filename\n - (Required) The name of the Packaging Machine you created in Azure.\n\n\n\nCreate a Platform Layer\n\n\nWhich \nConnector\n  are you using to create this Platform Layer?\n\n\nFor more about Platform Layers, see \nLayer Essentials: Platform Layers\n\n\nCreate a Platform Layer (Azure connector)\n\n\nIn this article:\n\n\nCreate a Platform Layer (Azure connector)\nPrepare a new Platform Layer\nDeploy a Packaging Machine\nInstall the platform software\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nA Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.\n\n\n\nPrerequisites\n\n\nWhen creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the \ntype\n  of Platform Layer you choose to create.\n\n\nType of Platform Layer\nPrerequisites\nPublishing Layered Images\nSoftware installers, and settings you use for your:\nHypervisor\nProvisioning service\nConnection broker\nPackaging Layers\nThe software and settings for your:\nHypervisor\nFor example, your hypervisor installer and settings.\nNote:\n You only need a Platform Layer for \npackaging\n Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, add a \nNew\nConnector Configuration\n and select it from this list.\nExample: If you are creating the layer in a vSphere environment, select the vSphere connector with the information needed to access the location where you will package this layer.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer: to create and update layers, or to publish Layered Images. For more about these choices, see Platform Layers.\nFrom the dropdown menus, select the platform(s) you are using.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install the app(s) you want to include in this Layer. It is strongly recommended that you use a unique Packaging Machine for each Layer. The Packaging Machine is a temporary VM that will be deleted once the Layer has been finalized.\n\n\nDeploy a Packaging Machine to Azure\n\n\nThe Task Description (example shown in the last step above) contains a link to the location in the Azure portal where the Packaging Machine for this Layer has been published.\n\n\nTo create your Packaging Machine in Azure, begin with the expanded Packaging Disk Task shown in the last step above.\n\n\nLog into the Azure portal (https://portal.azure.com) from your web browser.\nIn the expanded Packaging Disk Task shown below, copy the full URL and paste it into the web browser where you logged into the Azure portal. This opens the Microsoft Azure portal to the \nCustom deployment\n template where you can create the virtual machine that you will use as your Unidesk Packaging Machine.\nNote:\n We recommend copying the full URL instead of using the Click \nhere\n link.\nOn the Custom deployment panel, complete the required fields for customizing your Azure parameters.\nPackaging Machine Name - must conform to Azure VM name requirements.\nSize - the Azure VM size of the packaging machine.\nVirtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.\n\n\n\nInstall the platform software\n\n\nThis section explains how to install your application(s) on the Packaging Machine you created in Azure. Keep in mind that the state of the software before you finalize the layer is what users experience when they access it.\n\n\nTo install the application(s):\n\n\nRemote log in to the Packaging Machine you created in Azure. Be sure to log in using the User account you used to create the OS in Azure.\nInstall the Azure hypervisor software, along with any drivers, boot-level applications, or files that you need for packaging Layers in Azure.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the software you install requires any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the platform software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the layer.\n\n\nNote:\n  When you finalize a Platform Layer, Unidesk deletes the Packaging Machine.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nIn the Layers module, select the layer.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nCreate a Platform Layer (Citrix MCS for vSphere)\n\n\nIn this article:\n\n\n \nPrepare a new Platform Layer\nDeploy a Packaging Machine\nCreate a Platform Layer (Citrix MCS for vSphere)\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nA Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to Citrix MCS in vSphere with XenApp as the broker would include the MCS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).\n\n\nThis article explains the next steps to create a Platform Layer, based on your connector and platform choices. If you need more information than is included here, check these other Unidesk sources: \nLayer essentials (Unidesk Learning Center)\n and the \nUnidesk Forum\n.\n\n\nA Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - A Platform Layer for \npublishing\n is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - A Platform Layer for \npackaging\n is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.\n\n\n\nPrerequisites\n\n\nWhen creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the \ntype\n  of Platform Layer you choose to create.\n\n\nType of Platform Layer\nPrerequisites\nPublishing Layered Images\nSoftware installers, and settings you use for your:\nHypervisor\nProvisioning service\nConnection broker\nPackaging Layers\nThe software and settings for your:\nHypervisor\nFor example, your hypervisor installer and settings.\nNote:\n You only need a Platform Layer for \npackaging\n Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.\n\n\n\nCitrix MCS prerequisites\n\n\nWhen creating a Platform Layer for publishing images to an MCS environment, you need:\n\n\nAn OS Layer\nNetwork access to Unidesk Tools\nAccess from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page).\nCitrix Virtual Delivery Agent (VDA) installed on the Platform Layer\nThe Citrix VDA installer for the Windows OS you are using must be installed on the Platform Layer.\nCitrix Desktop Delivery Controller (DDC)\nThe Citrix DDC software must be installed on the server where the Layered Image will be published.\nAs part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the following:\nUnidesk Agent\n - Installed and running on the DDC. This allows Unidesk to run the script on the DDC.\nPowerShell Snap-in\n - Appropriate PowerShell Snap-in must be installed on the DDC.\nCitrix resource information\nThe Citrix info listed in this \nMCS Connector Configuration\n topic.\n\n\n\nPrepare a new Platform Layer\n\n\nTo create a Platform Layer you prepare the layer using the Create Platform Layer wizard, deploy a Packaging Machine in your environment, install the tools and configure the settings for MCS, and finalize the Layer.\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you are creating the layer in your vSphere environment, select the vSphere connector with the information needed to access the temporary storage location where you will package this layer.\nIn the Recipe Associations tab, select all of the platforms to which you will be publishing the Layered Image.\nExample: If you want to use this Platform Layer to publish Layered Images to both vSphere and Azure, select both environments.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new Platform Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nThe Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine.\nPower on the Packaging Machine.\n\n\n\nInstall the required platform tools\n\n\nThis section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.\n\n\nPlatform software to install\n\n\nYou need the installers for your hypervisor, provisioning service, and connection broker.\n\n\nIf you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.\n\n\nKeep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.\n\n\n\nCreate a Platform Layer (Citrix MCS for Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nPrepare a new Platform Layer\nInstall the required platform tools\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nFor cross-platform deployments, a Platform Layer includes the platform software and settings required to deploy images in your environment.\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Use this type of Platform Layer when publishing Layered Images to a platform other than the one where you created the OS Layer.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment. Use this type of Platform Layer when creating Layers on a platform other than the one from which you imported the OS for your OS Layer.\n\n\n\nPrerequisites\n\n\nCitrix MCS prerequisites\n\n\nWhen creating a Platform Layer for publishing images to an MCS environment, you need:\n\n\nAn OS Layer\nNetwork access to Unidesk Tools\nAccess from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page).\nCitrix Virtual Delivery Agent (VDA) installed on the Platform Layer\nThe Citrix VDA installer for the Windows OS you are using must be installed on the Platform Layer.\nCitrix Desktop Delivery Controller (DDC)\nThe Citrix DDC software must be installed on the server where the Layered Image will be published.\nAs part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the following:\nUnidesk Agent\n - Installed and running on the DDC. This allows Unidesk to run the script on the DDC.\nPowerShell Snap-in\n - Appropriate PowerShell Snap-in must be installed on the DDC.\nCitrix resource information\nThe Citrix info listed in this \nMCS Connector Configuration\n topic.\n\n\n\nNutanix AHV (Acropolis) prerequisites\n\n\nNutanix Prism account and privileges\nA Nutanix Prism account (new or existing) to use for Unidesk.\nThe account must have privileges to perform the following operations:\nVM operations:\nclone\ndelete\npower on/off\nattach virtual disks\nImage operations:\ncreate\nupdate (aka upload)\ndelete\nVirtual disks\ncreate\nattach to VMs\nNutanix AHV software and settings\nAccess to the VM Mobility Tools to install on the layer.\nNutanix AHV resource information\nThe Acropolis Server info listed in \nNutanix AHV Connector Configuration\n or \nMCS for Nutanix AHV Connector Configuration\n.\nNutanix AHV Connector\n \nWhen creating Layers for the Nutanix environment, you must use a Nutanix AHV Connector Configuration. The MCS for Nutanix AHV Connector does not support Layer creation.\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, Click \nNew\n, select an \nMCS for Nutanix AHV\n Connector from this list, and \nAdd a Configuration\n for it.\nImportant:\n The MCS for Nutanix AHV Connector can \nonly\n be used to publish Layered Images, \nnot\n to create Layers.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer: to create and update layers, or to publish Layered Images. For more about these choices, see Platform Layers.\nFrom the drop-down menus, select the hypervisor, provisioning service, and connection broker you are using, in this case, \nNutanix AHV \n and \nCitrix MCS\n.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment (example task message shown below).\n\n\n\nNext, you can access the Packaging Machine for your Layer, and install the software for your environment.\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment(s). It is a temporary VM that will be deleted once the new Platform Layer has been finalized. When the Unidesk software powers on the Packaging Machine for you.\n\n\nAccess the Packaging Machine in Nutanix AHV\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the \nCreate Platform Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in Prism.\n\n\n\nInstall the required platform tools\n\n\nIf you created the OS Layer on a hypervisor other than Nutanix, install the VM Mobility Tools. (If the OS was created in Nutanix, it already has the tools installed.) The tools installation may require multiple reboots. Once complete, you should see that you have access to the tools, as well as all of the \ndata\n  available under the Performance tab for your VM.\n\n\nWhen installing your platform software on the Packaging Machine, keep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nTo install the tools for the selected platform:\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the platform software and tools, along with any drivers, boot-level applications, or files needed.\nIf this Platform Layer is going to be used for publishing Layered Images, install and configure your hypervisor, provisioning service, and connection broker tools and settings.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nInstall an empty \nflag\n file called \nShutdown_published_Image.txt\n in the following directory:\n  c:\\windows\\setup\\scripts\\kmsdir\nThis enables automated shutdown of the OS.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe \nShutdown for Finalize\n  task will remain in the \nAction Required\n  state until you finalize the Layer.\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the tools are installed and ready to finalize, and you have shut down the machine, you'll need to finalize the layer.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers > Platform Layers\n, and select the Platform Layer you just prepared.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nCreate a Platform Layer (PVS)\n\n\nIn this article:\n\n\nBefore you start\nPrepare a new Platform Layer\nDeploy a Packaging Machine\nCreate a Platform Layer (PVS)\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nA Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.\n\n\n\nTo create a Platform Layer you prepare the layer using the Create Platform Layer wizard, deploy a Packaging Machine in your environment, install the tools and configure the settings for PVS, and finalize the Layer.\n\n\nBefore you start\n\n\nPlatform Layer Prerequisites\n\n\nAn OS Layer\n\n\n\nPVS Prerequisites\n\n\nIPv6 must be \ndisabled\n on the OS Layer.\n \nIf IPv6 is not disabled on your OS Layer, add a new Version to the OS Layer and disable IPv6 in the new Version.\nIMPORTANT:\n If you disable IPv6 on the \nPlatform Layer\n instead of on the \nOS Layer\n, the resulting PVS machines will lose their network connection and hang when they are booted.\nUnidesk Agent\nThe Unidesk Agent must be installed on all PVS servers used to access the PVS servers to which you will publish images. (Each Agent must be registered wit the Unidesk ELM.)\nPVS servers where the Unidesk Agent is installed\nThe PVS Console must be installed on all PVS servers where the Unidesk Agent is installed.\nPVS Target Device Imaging software\nThe PVS Target Device Imaging software must be available to install on the Platform Layer. The version must match the PVS server where the Layered Image will be published.\nPVS resource information\nThe PVS info listed in this \nPVS Connector Configuration\n topic.\nPowerShell Snap-in\nAppropriate PowerShell Snap-in must be installed.\nUnique CMID for each target device (if using KMS)\nWhen using KMS licensing, PVS requires that each target device has a unique CMID. For the full story, check out this Citrix article, \nDemystifying KMS and Provisioning Services\n. Rearming KMS is covered in the steps to Create a Platform Layer.\nAny additional PVS settings you use in your environment\nAny settings you need to configure PVS on your Platform Layer so that it matches the environment where the Layered Image will be used.\n\n\n\nRequired Tools and Settings\n\n\nUnidesk Tools download\nPVS settings\nKMS settings\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you are creating the layer in your vSphere environment, select the vSphere connector with the information needed to access the temporary storage location where you will package this layer.\nIn the Recipe Associations tab, select all of the platforms to which you will be publishing the Layered Image.\nExample: If you want to use this Platform Layer to publish Layered Images to both vSphere and Azure, select both environments.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new Platform Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nThe Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine.\nPower on the Packaging Machine.\n\n\n\nInstall the required platform tools\n\n\nThis section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.\n\n\nPlatform software to install\n\n\nYou need the installers for your hypervisor, provisioning service, and connection broker.\n\n\nIf you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.\n\n\nKeep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.\n\n\n\nCreate a Platform Layer (XenServer Connector)\n\n\nIn this article:\n\n\n \nPrepare a new Platform Layer\n \n \n \n\n\n\nA Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - A Platform Layer for \npublishing\n is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - A Platform Layer for \npackaging\n is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.\n\n\n\nPrerequisites\n\n\nWhen creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the \ntype\n  of Platform Layer you choose to create.\n\n\nType of Platform Layer\nPrerequisites\nPublishing Layered Images\nSoftware installers, and settings you use for your:\nHypervisor\nProvisioning service\nConnection broker\nPackaging Layers\nThe software and settings for your:\nHypervisor\nFor example, your hypervisor installer and settings.\nNote:\n You only need a Platform Layer for \npackaging\n Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.\n\n\n\nCitrix XenServer prerequisites\n\n\nXenServer account and privileges\nA XenServer account (new or existing) to use for Unidesk.\nThe account must have XenServer privileges to:\nCreate and remove virtual disks.\nCopy and delete layers on virtual disks using XenServer file APIs.\nCitrix XenServer software and settings\nAccess to the XenServer Tools to install on the layer.\nXenServer resource information\nThe XenServer info listed in \nCitrix XenServer Connector Configuration\n.\nNetwork access to Unidesk OS Machine Tools\nWhen you create Layer or add a Version to it, the Unidesk Management Console (UMC) uses a Connector Configuration to create a VM called a Packaging Machine for the Layer you are building. The Packaging Machine \nmust\n have access to the Unidesk OS Machine Tools download, which is available on the Unidesk Download page.\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, Click \nNew\n, select your platform from this list, and \nAdd a Configuration\n for it.\nExample:\n If you are creating the layer in a XenServer environment, select the XenServer connector with the information needed to access the location where you will package this layer.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer: to create and update layers, or to publish Layered Images. For more about these choices, see Platform Layers.\nFrom the dropdown menus, select the platform(s) you are using.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nAt the bottom of the UI, expand the Tasks bar and double-click the task to show the full task description.\nOnce the task is complete, the location of the Packaging Disk is shown (example task message shown below).\n\n\n\nNext, you can deploy the \nPackaging Machine\n  for your Layer. The Packaging Machine is a temporary virtual machine where you install the software to include in the Layer being created.\n\n\nPower on the Packaging Machine in Citrix XenServer\n\n\nLog into your XenServer client.\nBack in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the \nCreate Platform Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in your XenCenter client.\nWhile in the Infrastructure View, select your Packaging Machine's \nVM\n from the list of machines.\nIn the XenCenter UI in the panel on the right, choose the \nConsole\n option for the VM.\nPower on the VM.\nSelect the \nClick here to create a DVD drive\n link.\nPower cycle the VM (yes, you have to in order to get the DVD Drive).\nAt the top of the console window, click the \nDVD Drive 1\n drop down menu and select the \nxs-tools.iso\n.\nInstall the XenTools. This will require multiple reboots as part of the tools installation. Once complete, you should see that you have access to all \nXenTools\n, as well as all of the \ndata\n available under the Performance tab for your VM.\nNote:\n The XenCenter console uses \nRFB\n for it's console connection, which uses \nPort 5900\n. On Windows 2008 and Windows 7, this port is closed in the Firewall by default and should be opened so you can use the console to access any VMs\n\n\n\nInstall the platform tools on the Packaging Machine\n\n\nWhether you are creating a Platform Layer or adding a version to it:\n\n\nRemote log in to the Packaging Machine. Be sure to log in using the User account you used to create the OS.\nInstall the platform software and tools, along with any drivers, boot-level applications, or files needed. Keep in mind that the state of the software before you finalize the layer is what the image will use.\nIf this Platform Layer is going to be used for packaging new layers, install and configure your hypervisor tools and settings.\nIf this Platform Layer is going to be used for publishing Layered Images, install and configure your hypervisor, provisioning service, and connection broker tools and settings.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in for users:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\nWhen using PVS, if your OS image was activated using KMS, rearm KMS \njust before you shut down\nVerify the Rearm count on the OS by running slmgr /dlv from a command prompt. The Rearm count must \nnot\n be zero.\nslmgr /dlv\nRearm KMS:\nslmgr /rearm\n\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the software is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation. For details, see Verifying Layers.\nIf you are using KMS licensing, once any pending operations are complete, be sure to rearm KMS yet again \njust before you shutdown\n. First, enter this command to verify that the Rearm count is > 0:\nslmgr /dlv\nThen, rearm KMS:\nslmgr /rearm\nDouble-click the \nShutdown For Finalize\n icon again to shut down the Packaging Machine.\n\n\n\nThe Layer should be ready to finalize.\n\n\nDuring the shutdown for finalization\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nTo finalize the Layer, you import the installed software into the Platform Layer you prepared in the Unidesk Management Console (UMC).\n\n\nReturn to the UMC.\nSelect \nLayers > Platform Layers\n.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nCreate a Platform Layer (Network File Share Connector)\n\n\nIn this article:\n\n\nPrerequisites\nPrepare a new Platform Layer\nDeploy a Packaging Machine\nInstall the required platform tools\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nA Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).\n\n\nWhen do you need a Platform Layer?\n\n\nWhen creating your App Layers and OS Layer Versions, you will need a Platform Layer for Packaging Layers, if you imported your OS image (aka gold image) from a different hypervisor than the one where the ELM is installed.\nWhenever you publish a Layered Image, you will need a Platform Layer for Publishing.\n\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required)\nThese Layers include the software and settings required for a Layered Image to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases)\nThese Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.\n\n\n\nPrerequisites\n\n\nPrerequisites for creating a Platform Layer for Packaging Layers\nYou need the \nhypervisor\n software for your environment.\nPrerequisites for creating a Platform Layer for publishing Layered Images\nYou need the \nhypervisor\n prerequisites, plus the prerequisites for the \nprovisioning service\n and/or \nconnection broker\n software for your environment.\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose the \nNetwork File Share\n for your Connector Configuration.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer:\nFor creating and updating Layers - \nOnly\n required if you will create Layers on a different hypervisor than the one from which you imported your OS.\nFor publishing Layered Images - Required whenever you publish Layered Images.\nFor more about these choices, see Platform Layer Essentials.\nIf this Platform Layer is for:\nCreating and updating Layers - Select the Hypervisor where you will be creating and updating (packaging) Layers.\nPublishing Layered Images - Select the Hypervisor, Provisioning Service, and Connector Broker that make up the environment where you will be \npublishing\n images.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nA Boot disk and a Packaging disk are created, and the Tasks bar displays instructions to navigate to them.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the disks have been created, the Task bar displays the location of the disks on the Network File Share: /Unidesk/Packaging Disks.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a temporary VM where you install the platform tools you want to include in the Layer.\n\n\nCreate the Packaging Machine\n\n\nThe Task Description (example shown in the last step above) contains the location in your environment where the disks for this Layer have been created.\n\n\nLog into the client for your hypervisor.\nLocate the Packaging disks in the following directory on the Network File Share:\n\\Unidesk\\Packaging Disks\nCopy the disks to the hypervisor where you will install the software for the Layer.\nNote:\n Even if the Packaging Disks in \\Unidesk\\Packaging Disks are already in the hypervisor where you will be installing the tools, we recommend copying the disks to another location. This is because when you use the disk to create a new VM, the directory will quickly become crowded with files generated by your hypervisor.\nImportant:\n Do not copy the disk to the Finalize folder until it is ready to finalize. A disk in the Finalize folder cannot be attached to the new VM that you are going to create next.\nIn your hypervisor, create a VM from the \nBoot\n disk and name it \nLayer_Name\nBoot\n.\nxxx\n.\nIn your hypervisor, select the VM, and attach the disk called \nLayer_Name\nPkg\n.\nxxx\n to the VM.\nCreate a virtual machine using the Packaging Disk as the boot disk. This is the Packaging Machine where you will install the application(s) to include in the layer.\nPower on the Packaging Machine.\n\n\n\nInstall the required platform tools\n\n\nThis section explains how to install the tools your Layered Images will need to run your the target platform onto the Packaging Machine you just created. Keep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nTo install the tools for the selected platform:\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nCopy the Packaging Machine to the Finalize folder on the Network File Share:\n\\Unidesk\\Finalize\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the platform tools are installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nReturn to the Unidesk Management Console (UMC).\nSelect \nLayers > Platform Layers\n.\nSelect the Layer to finalize, and then select \nFinalize\n on the Action bar. The Layer is finalized and becomes Deployable.\n\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers > Platform Layers\n.\nSelect the Platform Layer you just prepared, and select \nFinalize\n in the Action bar.\n Monitor the Task bar and verify that the layer becomes deployable.\n\n\n\nCreate a Platform Layer (Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nPrepare a new Platform Layer\nInstall the required platform tools\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nFor cross-platform deployments, a Platform Layer includes the platform software and settings required to deploy images in your environment.\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Use this type of Platform Layer when publishing Layered Images to a platform other than the one where you created the OS Layer.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment. Use this type of Platform Layer when creating Layers on a platform other than the one from which you imported the OS for your OS Layer.\n\n\n\nPrerequisites\n\n\nNutanix AHV (Acropolis) prerequisites\n\n\nNutanix Prism account and privileges\nA Nutanix Prism account (new or existing) to use for Unidesk.\nThe account must have privileges to perform the following operations:\nVM operations:\nclone\ndelete\npower on/off\nattach virtual disks\nImage operations:\ncreate\nupdate (aka upload)\ndelete\nVirtual disks\ncreate\nattach to VMs\nNutanix AHV software and settings\nAccess to the VM Mobility Tools to install on the layer.\nNutanix AHV resource information\nThe Acropolis Server info listed in \nNutanix AHV Connector Configuration\n or \nMCS for Nutanix AHV Connector Configuration\n.\nNutanix AHV Connector\n \nWhen creating Layers for the Nutanix environment, you must use a Nutanix AHV Connector Configuration. The MCS for Nutanix AHV Connector does not support Layer creation.\n\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, Click \nNew\n, select a Nutanix AHV Connector from this list, and \nAdd a Configuration\n for it.\nImportant:\n You must use a Nutanix AHV Connector to create a Layer in Nutanix. The MCS for Nutanix AHV Connector can only be used for publishing Layered Images, not for creating Layers.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer: to create and update layers, or to publish Layered Images. For more about these choices, see Platform Layers.\nFrom the dropdown menus, select the platform(s) you are using.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment (example task message shown below).\n\n\n\nNext, you can access the Packaging Machine for your Layer, and install the software for your environment.\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment(s). It is a temporary VM that will be deleted once the new Platform Layer has been finalized. When the Unidesk software powers on the Packaging Machine for you.\n\n\nAccess the Packaging Machine in Nutanix AHV\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the \nCreate Platform Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in Prism.\n\n\n\nInstall the required platform tools\n\n\nIf this is a Platform Layer for Publishing and you created the OS Layer using a different hypervisor than Nutanix AHV, install the VM Mobility Tools. (If the OS was created in Nutanix, it already has the tools installed.) The tools installation may require multiple reboots. Once complete, you should see that you have access to the tools, as well as all of the \ndata\n  available under the Performance tab for your VM.\n\n\nIf this is a Platform Layer for Packaging a Layer, install the application software, and configure the app settings as you want them to be for the user.\n\n\nWhen installing your platform software on the Packaging Machine, keep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nTo install the tools for the selected platform:\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the platform software and tools, along with any drivers, boot-level applications, or files needed.\nIf this Platform Layer is going to be used for packaging new layers, install and configure your hypervisor tools and settings.\nIf this Platform Layer is going to be used for publishing Layered Images, install and configure your hypervisor, provisioning service, and connection broker tools and settings.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nInstall an empty \nflag\n file called \nShutdown_published_Image.txt\n in the following directory:\n  c:\\windows\\setup\\scripts\\kmsdir\nThis enables automated shutdown of the OS.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe \nShutdown for Finalize\n  task will remain in the \nAction Required\n  state until you finalize the Layer.\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the tools are installed and ready to finalize, and you have shut down the machine, you'll need to finalize the layer.\n\n\nWhen a layer is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers > Platform Layers\n, and select the Platform Layer you just prepared.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nCreate a Platform Layer (VMware Horizon for vSphere)\n\n\nIn this article:\n\n\n \nPrepare a new Platform Layer\nDeploy a Packaging Machine\nCreate a Platform Layer (VMware Horizon for vSphere)\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nA Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to VMware Horizon in vSphere with XenDesktop as the broker would include the VMware View Agent, vmTools, and other platform-related software..\n\n\nThis article explains the next steps to create a Platform Layer, based on your connector and platform choices. If you need more information than is included here, check these other Unidesk sources: \nLayer essentials (Unidesk Learning Center)\n and the \nUnidesk Forum\n.\n\n\nA Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - A Platform Layer for \npublishing\n is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - A Platform Layer for \npackaging\n is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.\n\n\n\nPrerequisites\n\n\nWhen creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the \ntype\n  of Platform Layer you choose to create.\n\n\nType of Platform Layer\nPrerequisites\nPublishing Layered Images\nSoftware installers, and settings you use for your:\nHypervisor\nProvisioning service\nConnection broker\nPackaging Layers\nThe software and settings for your:\nHypervisor\nFor example, your hypervisor installer and settings.\nNote:\n You only need a Platform Layer for \npackaging\n Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.\n\n\n\nVMware Horizon View Composer prerequisites\n\n\nWhen creating a Platform Layer for publishing images to an MCS environment, you need:\n\n\nAn OS Layer\nNetwork access to Unidesk Tools\nAccess from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page).\nVMware View Agent installed on the Platform layer\nThe VMware View Agent installer for the Windows OS you are using must be installed on the Platform Layer.\nUnidesk Agent and PowerShell Snap-in, if using a Script as part of the Connector Configuration\n \nAs part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the Unidesk Agent and PowerShell Snap-in installed and running.\nVMware Horizon View Composer resource information\nThe Horizon View info listed in this \nVMware Horizon for vSphere Connector Configuration\n topic.\nvSphere resource information\nThe vSphere info listed in \nvSphere Connector Configuration\n.\nvSphere software and settings\nAccess to the vSphere software to install on the layer.\n\n\n\nPrepare a new Platform Layer\n\n\nTo create a Platform Layer you prepare the layer using the Create Platform Layer wizard, deploy a Packaging Machine in your environment, install the tools and configure the settings for Horizon View, and finalize the Layer.\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you are creating the layer in your vSphere environment, select the vSphere connector with the information needed to access the temporary storage location where you will package this layer.\nIn the Recipe Associations tab, select all of the platforms to which you will be publishing the Layered Image.\nExample: If you want to use this Platform Layer to publish Layered Images to both vSphere and Azure, select both environments.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new Platform Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nThe Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine.\nPower on the Packaging Machine.\n\n\n\nInstall the required platform tools\n\n\nThis section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.\n\n\nPlatform software to install\n\n\nYou need the installers for your hypervisor, provisioning service, and connection broker.\n\n\nIf you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.\n\n\nKeep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.\n\n\n\nCreate a Platform Layer (vSphere connector)\n\n\nIn this article:\n\n\nPrerequisites\nPrepare a new Platform Layer\nConnect to and log into the Packaging Machine\nInstall the required platform tools\nVerify the Layer and shut down the Packaging Machine\n \n\n\n\nA Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).\n\n\nYou can create two kinds of Platform Layers:\n\n\nPlatform Layers for \npublishing Layered Images\n (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment.\nPlatform Layers for \npackaging Layers\n (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.\n\n\n\nThe general steps for creating a Platform Layer are:\n\n\nPrepare a Platform Layer\nConnect to and log into the Packaging Machine\nInstall the Platform Software\nVerify the Layer and Shutdown the Packaging Machine\nCopy the Packaging Machine to the ELM's Network File Share (if needed)\nFinalize the Layer\n\n\n\nPrerequisites\n\n\nvSphere prerequisites\n\n\nNetwork access to Unidesk Tools\nAccess from the Packaging Machine VM in vSphere to the Unidesk Tools download (available on the Unidesk Download page).\nvSphere software and settings\nAccess to the vSphere software to install on the layer.\nvSphere resource information\nThe vSphere info listed in \nvSphere Connector Configuration\n.\n\n\n\nOther prerequisites\n\n\nIf you are creating a Platform Layer to use when publishing Layered Images, you need the above prerequisites plus the prerequisites for the provisioning service and connection broker software for your environment.\n\n\nPrepare a new Platform Layer\n\n\nSelect \nLayers > Platform Layers\n and select \nCreate Platform Layer\n in the Action bar. This opens the Create Platform Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values.\nIn the OS Layer tab, select the OS Layer you want to associate with this Platform Layer.\nIn the Connector tab, choose a Connector Configuration for the platform where you are creating this layer. If the configuration you need isn't listed, Click \nNew\n, select your platform from this list, and \nAdd a Configuration\n for it.\nExample:\n If you are creating the layer in a vSphere environment, select the vSphere connector with the information needed to access the location where you will package this layer.\nIn the Platform Types tab, select the radio button that describes the purpose of this Platform Layer: to create and update layers, or to publish Layered Images. For more about these choices, see Platform Layers.\nFrom the dropdown menus, select the platform(s) you are using.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the tools, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment (example task message shown below).\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nThe Packaging Machine is a virtual machine where you install the tools for your selected environment(s). It is a temporary VM that will be deleted once the new Platform Layer has been finalized. When the Unidesk software powers on the Packaging Machine for you.\n\n\nConnect to and log into the Packaging Machine\n\n\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full task description.\nOnce the Packaging Disk has been created, the Task bar displays the location of the Packaging Disk in your environment (example task message shown below).\n\n\n\nInstall the required platform tools\n\n\nThis section explains how to install your platform software onto the Packaging Machine. Keep in mind that the state of the software before you finalize the layer is what the image will use.\n\n\nTo install the tools for the selected platform:\n\n\nRemote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS.\nInstall the platform software and tools, along with any drivers, boot-level applications, or files needed.\nIf this Platform Layer is going to be used for packaging new layers, install and configure your hypervisor tools and settings.\nIf this Platform Layer is going to be used for publishing Layered Images, install and configure your hypervisor, provisioning service, and connection broker tools and settings.\nIf a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be in when the image is booted:\nIf the tools you install require any post-installation setup or registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nTo finalize the Layer, you import the installed software into the Platform Layer you prepared in the Unidesk Management Console (UMC).\n\n\nReturn to the UMC.\nSelect \nLayers > Platform Layers\n.\nSelect \nFinalize\n in the Action bar.\nMonitor the Task bar to verify that the action completes successfully and that the layer is deployable.\n\n\n\nApp Layers\n\n\nWould you like to create an App Layer, assign one to Layered Images or to specific users, or learn how to layer some of the more challenging apps (most are easy to layer)?\n\n\nCreate an App Layer\n\n\nWhat type of Connector are you using to create this App Layer?\n\n\nCreate an App Layer (vSphere)\n\n\nIn this article:\n\n\nBefore you start\n\n\nPrepare a new App Layer\n\n\nInstall the software on the Packaging Machine\n\n\nFinalize the Layer\n\n\nReference: Create App Layer Wizard values\n\n\nAn App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.\n\n\nTo create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.\n\n\nA Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.\n\n\nBefore you start\n\n\nRequirements\n\n\nTo create an App Layer, you need:\n\n\nCreate an OS Layer\n\n\n\nOptional\n\n\nBefore you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.\n\n\nPrerequisite Layer\nPlatform Layer (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer)\nRun Once Script\n\n\n\nIf the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.\n\n\nPrerequisite Layer\n\n\nPrerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers \nshould only be used if they are required\n , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.\n\n\nReasons to consider using Prerequisite Layers:\n\n\nThe application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer.\nThe add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer.\nTwo applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.\n\n\n\nNote:\n  Some of these issues can also be handled by putting the two applications in the same layer.\n\n\nPlatform Layer (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer)\n\n\nIf you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, you should consider creating a Platform Layer with the hypervisor tools and hardware settings that will make it easy to install and package applications in your environment.\n\n\nRun Once Script\n\n\nYou can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.\n\n\nLayer Caching for faster App Layer creation\n\n\nIf you will be creating multiple App Layers that use the same OS Layer, Prerquisite Layer(s), and Platform Layer, you can save significant time by setting the Layer Disk Cache Size in the vSphere Connector. If Cache Size is set to a value greater than 0, the first time you create an App Layer with a specific OS Layer, Prerequisite Layer(s) and Platform Layer, Unidesk will save a template in the cache that consists of the boot disk and the empty packaging disk. The next time you create an App Layer that uses the same OS Layer, Prerequisite Layer(s) and Platform Layer, Unidesk will re-use this template, thereby significantly cutting the time it takes to create this App Layer in half.\n\n\nPlease note that if you create an App Layer that uses a different OS Layer, Prerequisite Layer(s) or Platform Layers from what is saved in the template, Unidesk will create a new template and store it in cache.\n\n\nThe size that you need to set for your cache depends on how many different combinations of OS Layers, Prerequisite Layer(s), Platform Layer combinations and therefore how many cached templates you will use as you layer various Apps. To estimate the space required for each template you can you can determine how much space a Boot disk will use by selecting the i for the OS Layer you are using and observing the Maximum Layer Size value in the Version Information section.\n\n\nLikewise, you can obtain the Pkg disk size for an existing Application/Platform layer using the same approach. When creating new layers, you can set the Max Layer Size used by setting the Max Layer Size (GB) field in the Create Layer Wizard. By looking at the size of your existing layers, and estimating how many layers you are going to be creating/editing you can determine how large to set the Cache Size in your connector configuration.\n\n\nPrepare a new App Layer\n\n\nSelect \nLayers > App Layers\n and select \nCreate Layer\n in the Action bar. This opens the Create Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this App Layer.\n(Optional) In the Prerequisite Layers tab, if the application you are layering requires other App Layers to be present during installation, select the \nInclude Prerequisite Layers\n check box, and pick the necessary App Layer(s).\nNotes:\n \nPrerequisite layers are used while installing applications, and are \nnot included\n in the App Layer.\nPrerequisite layers are \nnot\n included by default when adding a new \nVersion\n to this App Layer. So, when you add a new Version to this App Layer, you must choose the Prerequisite Layers again, if needed.\nThe App Layer you are creating and each of its Prerequisite Layers must be associated with the selected OS Layer.\nIn the Connector tab, choose a \nPlatform Connector Configuration\n that contains the credentials for the platform where you plan to build the Layer, along with the storage location. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you're using the vSphere environment to create the Layer, select the vSphere connector with the credentials and location required to access the location where you want to build the Layer.\nIn the Platform Layer tab you can select a Platform Layer containing the tools and hardware settings that you need to install and package an application during Layer creation. This selection is only used during layer creation. Once created, the Layer can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History. Once the Packaging Disk has been created, the Task bar displays instructions to navigate to the Packaging Machine in vSphere.\n\n\n\nNext, you can log into the Packaging Machine for your Layer, and install the software for the layer on it.\n\n\nInstall the software on the Packaging Machine\n\n\nWhen you've completed the Layer wizard, Unidesk creates a Packaging Machine in your environment, in the location defined in the Connector Configuration. The Packaging Machine is a virtual machine where you install the software to be included in the layer.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new Platform Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, expand the Tasks bar at the bottom of the UI, and double-click the \nCreate App Layer\n task to see the full Task Description.\nUse the instructions in the Task Description to navigate to the Packaging Machine in your vSphere web client.\nThe Packaging Machine will be powered on.\n\n\n\nInstall the Application(s)\n\n\nWhen installing your application(s) on the Packaging Machine, leave each application as you want users to see it when they log in. The state of the applications when you finalize the layer is what users experience when they access the application. More guidance about this is included in the steps below.\n\n\nRemote log in to the Packaging Machine in vSphere. Be sure to log in with the User account you used to create the OS in vSphere.\nInstall the applications, along with any drivers, boot-level applications, or files that the user will need with it.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the software has been installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar. The Finalize wizard appears.\n(Optional) On the Script Path wizard tab, you can enter the path to a Run Once Script located on a server on your network.\nIf the App Layer is elastically assigned, the Run Once script will be executed the first time the app is used.\nIf the App Layer is included in a Layered Image, the Run Once script will be executed the first time the Layered Image is booted.\nClick \nFinalize\n to finish creating the Layer.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is ready to be deployed.\n\n\n\nReference: Create App Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for.\nLayer Description\n - (Optional) Description of the Layer\nVersion\n - (Required) This can be the version of the application or a version you assign to the Layer. This value is displayed in the Details view of the Layer. Keep in mind that you'll add a new version to this layer whenever you update the app(s) included in it, and this is where the version will be described.\nVersion Description\n - (Optional) Enter a description of the version.\nSpecify the Max Layer Size\n - Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 10 gigabytes. If the application you are installing could eventually require more space, change this to an appropriate value.\n\n\n\nCreate an App Layer (Azure)\n\n\nIn this article:\n\n\nBefore you start\nPrepare a new App Layer\nDeploy a Packaging Machine\nInstall the Application(s)\nVerify the Layer and shut down the Packaging Machine\nFinalize the Layer\n\n\n\nAn App Layer includes one or more installed applications that you can use in your Layered Images. You can create any number of App Layers, each with one or more applications. When it's time to update an app, you can add a new version to the layer. When you are ready to deliver the application updates to users, you can update your Image Templates, republish your Layered Images, and provision your servers with the new Layered Image.\n\n\nTo create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine, then install the application(s). Once the application(s) are installed, you finalize the Layer.\n\n\nBefore you start\n\n\nRequirements\n\n\nTo create an App Layer, you need:\n\n\nCreate an OS Layer\n\n\n\nOptional\n\n\nBefore you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.\n\n\nCreate Prerequisite Layers\n \nCreate a Platform Layer (Azure connector)\nRun Once Script\n\n\n\nIf the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.\n\n\nDoes this App Layer require Prerequisite Layers?\n\n\nPrerequisite Layers provide a mechanism to include existing Application Layers on the Packaging Disk when creating or adding a version to an Application Layer. Prerequisite Layers \nshould only be used if they are required\n , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future. Prerequisite Layers can be required for several reasons:\n\n\nIf the software installed in one layer is required by the current layer's application just to be installed. For example, if you are installing an application that requires Java and you have Java in a separate layer.\nIf the software to be installed adds settings of an existing application. For example, when installing an Office add-in, Microsoft Office must first be installed.\nIf two applications modify the same registry key and the second application must add to a key and not replace it. For example, two application that both modify logon keys in Windows like a Citrix Agent and Imprivata.\n\n\n\nNote:\n  Some of these issues can also be handled by putting the two applications in the same layer rather than using prerequisite layers.\n\n\nRun Once Script\n\n\nYou can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.\n\n\nPrepare a new App Layer\n\n\nSelect \nLayers > App Layers\n and select \nCreate Layer\n in the Action bar. This opens the Create Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the OS Layer you want to associate with this App Layer.\nIn the Prerequisite Layers tab, if the application you are layering requires other App Layers to be present during installation, select the \nInclude Prerequisite Layers\n check box, and pick the necessary App Layer(s).\nNotes:\n \nPrerequisite layers are \nnot included\n in the App Layer being created.\nPrerequisite layers are \nnot included\n when adding a new \nVersion\n to this App Layer. So, when you add a new Version to this App Layer, you must choose the Prerequisite Layers again.\nThe App Layer you are creating and each of its Prerequisite Layers must be associated with the selected OS Layer.\nIn the Connector tab, choose a \nPlatform Connector Configuration\n that contains the credentials for the platform where you plan to build the Layer, along with the storage location. If the configuration you need isn't listed, add a \nNew\nConnector Configuration\n and select it from this list.\nExample: If you're using the Azure environment to create the Layer, select the Azure connector with the credentials and location required to access the location where you want to build the Layer.\nIn the Platform Layer tab you can select a Platform Layer containing the tools and hardware settings that you need to install and package an application during Layer creation. This selection is only used during layer creation. Once created, the Layer can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History. Once the Packaging Disk has been created, the Task bar displays a link to the Packaging Disk on the Azure portal. You will use this link to deploy the Packaging Machine.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task. The task expands to show the full task description. This description contains a link to the location in the Azure portal where the Packaging Machine for this Layer has been published.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a virtual machine where you install the app(s) you want to include in this Layer. It is strongly recommended that you use a unique Packaging Machine for each Layer. The Packaging Machine is a temporary VM that will be deleted once the Layer has been finalized.\n\n\nDeploy a Packaging Machine to Azure\n\n\nThe Task Description (example shown in the last step above) contains a link to the location in the Azure portal where the Packaging Machine for this Layer has been published.\n\n\nTo create your Packaging Machine in Azure, begin with the expanded Packaging Disk Task shown in the last step above.\n\n\nLog into the Azure portal (https://portal.azure.com) from your web browser.\nIn the expanded Packaging Disk Task shown below, copy the full URL and paste it into the web browser where you logged into the Azure portal. This opens the Microsoft Azure portal to the \nCustom deployment\n template where you can create the virtual machine that you will use as your Unidesk Packaging Machine.\nNote:\n We recommend copying the full URL instead of using the Click \nhere\n link.\nOn the Custom deployment panel, complete the required fields for customizing your Azure parameters.\nPackaging Machine Name - must conform to Azure VM name requirements.\nSize - the Azure VM size of the packaging machine.\nVirtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.\n\n\n\nInstall the Application(s)\n\n\nThis section explains how to install your application(s) on the Packaging Machine you created in Azure. Keep in mind that the state of the app before you finalize the layer is what users experience when they access it.\n\n\nTo install the application(s):\n\n\nRemote log in to the Packaging Machine you created in Azure. Be sure to log in using the User account you used to create the OS in Azure.\nInstall the applications, along with any drivers, boot-level applications, or files that the user will need with it.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you'll need to shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, the next step is to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the software has been installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar. The Finalize wizard appears.\n(Optional) On the Script Path wizard tab, you can enter the path to a Run Once Script located on a server on your network.\nIf the App Layer is elastically assigned, the Run Once script will be executed the first time the app is used.\nIf the App Layer is included in a Layered Image, the Run Once script will be executed the first time the Layered Image is booted.\nClick \nFinalize\n to finish creating the Layer.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is ready to be deployed.\n\n\n\nReference: Create App Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for.\nLayer Description\n - (Optional) Description of the Layer\nVersion\n - (Required) This can be the version of the application or a version you assign to the Layer. This value is displayed in the Details view of the Layer. Keep in mind that you'll add a new version to this layer whenever you update the app(s) included in it, and this is where the version will be described.\nVersion Description\n - (Optional) Enter a description of the version.\nSpecify the Max Layer Size\n - Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 10 gigabytes. If the application you are installing could eventually require more space, change this to an appropriate value.\n\n\n\nCreate an App Layer (vSphere)\n\n\nIn this article:\n\n\nBefore you start\n\n\nPrepare a new App Layer\n\n\nDeploy a Packaging Machine\n\n\nInstall the Application(s)\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nFinalize the Layer\n\n\nAn App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When creating an Image Template to use for publishing a Layered Image, you can include an OS Layer, a Platform Layer, and any combination of App Layers, as long as the OS Layer used to create all of them is the same.\n\n\nTo create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application on it. Once the application is installed, you finalize the Layer.\n\n\nA Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine using the location and credentials you supply by selecting the Platform Target (hypervisor) and Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.\n\n\nBefore you start\n\n\nRequirements\n\n\nTo create an App Layer, you need:\n\n\nCreate an OS Layer\n (Contains the OS for this application.)\n\n\n\nOptional resources\n\n\nYou may want to create resources to facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.\n\n\nPrerequisite Layers\n \nPlatform Layer for Packaging Layers (Required if creating App Layers on a different hypervisor than the one from which you imported your OS Layer)\nRun Once Script\n\n\n\nPrerequisite Layers: What are they and do I need any?\n\n\nPrerequisite Layers provide a mechanism to include existing Application Layers on the Packaging Disk when creating or adding a version to an Application Layer. Prerequisite Layers \nshould only be used if they are required\n , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future. Prerequisite Layers can be required for several reasons:\n\n\nIf the software installed in one layer is required by the current layer's application just to be installed. For example, if you are installing an application that requires Java and you have Java in a separate layer.\nIf the software to be installed adds settings of an existing application. For example, when installing an Office add-in, Microsoft Office must first be installed.\nIf two applications modify the same registry key and the second application must add to a key and not replace it. For example, two application that both modify logon keys in Windows like a Citrix Agent and Imprivata.\n\n\n\nNote:\n  Some of these issues can also be handled by putting the two applications in the same layer rather than using prerequisite layers.\n\n\nPlatform Layer: What is it and do I need one?\n\n\nA Platform Layer is a Unidesk Layer that contains the tools and hardware settings needed to either install and package an application during Layer creation, or to publish a Layered Image for provisioning servers in a specific environment. You can create a different Platform Layer for each environment in which you are creating Layers, or publishing Layered Images.\n\n\nThere are two types of Platform Layers you can create: Platform Layers to use for Packaging other Layers, and Platform Layers for Publishing Layered Images.\n\n\nRun Once Script\n\n\nYou can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.\n\n\nPrepare a new App Layer\n\n\nSelect \nLayers > App Layers\n and select \nCreate Layer\n in the Action bar. This opens the Create Layer wizard.\nOn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nOn the OS Layer tab, select the OS Layer you want to associate with this App Layer.\n(Optional) On the Prerequisite Layers tab, if the application you are layering requires other App Layers to be present during installation, select the \nInclude Prerequisite Layers\n check box, and pick the necessary App Layer(s).\nNotes:\n \nPrerequisite layers are used while installing applications, and are \nnot included\n in the App Layer.\nPrerequisite layers are \nnot\n included by default when adding a new \nVersion\n to this App Layer. So, when you add a new Version to this App Layer, you must choose the Prerequisite Layers again, if needed.\nThe App Layer you are creating and each of its Prerequisite Layers must be associated with the selected OS Layer.\nOn the Connector tab, select \nNetwork File Share\n.\nOn the Platform Layer tab, you can select a Platform Layer for Packaging Layers, \nif\n you need one.\nNote:\n You \nonly\n need a Platform Layer for Packaging this Layer if you imported your OS from a different environment than the one where you will install the software on this Layer.\nOn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nOn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nOn the Confirm and Complete tab, review the App Layer details, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History.\nA Boot disk and a Packaging disk are created, and the Tasks bar displays instructions to navigate to them.\nExpand the Tasks bar at the bottom of the UI, and double-click the Packaging Disk task to show the full description. A message displays the location of the disks in your environment.\n\n\n\nNext, you can deploy the Packaging Machine for your Layer.\n\n\nDeploy a Packaging Machine\n\n\nThe Packaging Machine is a temporary VM where you install the app(s) you want to include in the Layer.\n\n\nCreate the Packaging Machine\n\n\nThe Task Description (example shown in the last step above) contains the location in your hypervisor environment where the disks for this Layer have been created.\n\n\nLog into your hypervisor.\nBack in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the location where the Boot Disk and Packaging Disk have been created.\nIn your hypervisor, create a VM from the Boot disk and name it \nLayer_Name\nBoot.\nxxx\n.\nUse the hypervisor to attach the disk called \nLayer_Name\nPkg.\nxxx\n to the VM you just created.\nImportant:\n Both disks you exported \nmust\n be attached to the IDE.\nPower on the VM. This is your Packaging Machine where you will install the app(s) to include in this Layer.\n\n\n\nInstall the Application(s)\n\n\nNow you can install your application(s) on the Packaging Machine. Keep in mind that the state of the app before you finalize the layer is what users experience when they access it, so it's important to leave the app as you want users to see it when they log in. More guidance about this is included in the steps below.\n\n\nTo install the application(s):\n\n\nRemote log in to the Packaging Machine in vSphere. Be sure to log in with the User account you used to create the OS in vSphere.\nInstall the applications, along with any drivers, boot-level applications, or files that the user will need with it.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nNext, you will shut down the Packaging Machine and verify that the Layer is ready to finalize.\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the software has been installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar. The Finalize wizard appears.\n(Optional) On the Script Path wizard tab, you can enter the path to a Run Once Script located on a server on your network.\nIf the App Layer is elastically assigned, the Run Once script will be executed the first time the app is used.\nIf the App Layer is included in a Layered Image, the Run Once script will be executed the first time the Layered Image is booted.\nClick \nFinalize\n to finish creating the Layer.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is ready to be deployed.\n\n\n\nReference: Create App Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for.\nLayer Description\n - (Optional) Description of the Layer\nVersion\n - (Required) This can be the version of the application or a version you assign to the Layer. This value is displayed in the Details view of the Layer. Keep in mind that you'll add a new version to this layer whenever you update the app(s) included in it, and this is where the version will be described.\nVersion Description\n - (Optional) Enter a description of the version.\nSpecify the Max Layer Size\n - Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 10 gigabytes. If the application you are installing could eventually require more space, change this to an appropriate value.\n\n\n\nCreate an App Layer (Nutanix AHV Connector)\n\n\nIn this article:\n\n\nBefore you start\nPrepare a new App Layer\nInstall the software on the Packaging Machine \nFinalize the Layer\nReference: Create App Layer Wizard values\n\n\n\nAn App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.\n\n\nTo create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.\n\n\nA Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.\n\n\nBefore you start\n\n\nRequirements\n\n\nTo create an App Layer, you need:\n\n\nCreate an OS Layer\n\n\n\nOptional\n\n\nBefore you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.\n\n\nPrerequisite Layer\nPlatform Layer (for cross-platform deployments) (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer)\nRun Once Script\n\n\n\nIf the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.\n\n\nPrerequisite Layer\n\n\nPrerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers \nshould only be used if they are required\n , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.\n\n\nReasons to consider using Prerequisite Layers:\n\n\nThe application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer.\nThe add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer.\nTwo applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.\n\n\n\nNote:\n  Some of these issues can also be handled by putting the two applications in the same layer.\n\n\nPlatform Layer (for cross-platform deployments)\n\n\nA Platform Layer is \nonly\n  required when creating App Layers on a hypervisor other than the one from which you imported your OS Layer.\n\n\nIf you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, it is strongly recommended that you create a Platform Layer containing the hypervisor tools and hardware settings you need to seamlessly install and package applications in your environment.\n\n\nRun Once Script\n\n\nYou can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.\n\n\nPrepare a new App Layer\n\n\nSelect \nLayers > App Layers\n and select \nCreate Layer\n in the Action bar. This opens the Create Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the \nOS Layer\n you want to associate with this App Layer.\n(Optional) In the Prerequisite Layers tab, if the application you are layering requires other App Layers to be present during installation, select the \nInclude Prerequisite Layers\n check box, and pick the necessary App Layer(s).\nNotes:\n \nPrerequisite layers are used while installing applications, and are \nnot included\n in the App Layer.\nPrerequisite layers are \nnot\n included by default when adding a new \nVersion\n to this App Layer. So, when you add a new Version to this App Layer, you must choose the Prerequisite Layers again, if needed.\nThe App Layer you are creating and each of its Prerequisite Layers must be associated with the selected OS Layer.\nIn the Connector tab, choose a \nConnector Configuration\n that contains the credentials for the platform where you plan to build the Layer, along with the storage location. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you're using the Nutanix AHV environment to create the Layer, select the \nNutanix AHV\n connector with the credentials and location required to access the location where you want to build the Layer.\nIn the Platform Layer tab you can select a Platform Layer containing the tools and hardware settings that you need to install and package an application during Layer creation. This selection is only used during layer creation. Once created, the Layer can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History. Once the Packaging Disk has been created, the Task bar displays instructions to navigate to the Packaging Machine in Nutanix AHV.\n\n\n\nNext, you can log into the Packaging Machine for your Layer, and install the software for the layer on it.\n\n\nAccess the Packaging Machine in Nutanix AHV\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the \nCreate App Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in Prism.\nInstall the app for your Layer. This may require a reboot as part of the installation. Once complete, you should see that you have access to the tools, as well as all of the \ndata\n available under the Performance tab for your VM.\n\n\n\nInstall the software on the Packaging Machine\n\n\nWhen you've completed the Layer wizard, Unidesk creates a Packaging Machine in your environment, in the location defined in the Connector Configuration. The Packaging Machine is a virtual machine where you install the software to be included in the layer.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new App Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nLog into Nutanix Prism.\nBack in the Unidesk Management Console, expand the Tasks bar at the bottom of the UI, and double-click the \nCreate App Layer\n task to see the full Task Description.\nUse the instructions in the Task Description to navigate to the Packaging Machine in Nutanix Prism.\nThe Packaging Machine will be powered on.\n\n\n\nInstall the Application(s)\n\n\nWhen installing your application(s) on the Packaging Machine, leave each application as you want users to see it when they log in. The state of the applications when you finalize the layer is what users experience when they access the application. More guidance about this is included in the steps below.\n\n\nRemote log in to the Packaging Machine in Nutanix AHV. Be sure to log in with the User account you used to create the OS in Nutanix AHV.\nInstall the applications, along with any drivers, boot-level applications, or files that the user will need with it.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the software has been installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar. The Finalize wizard appears.\n(Optional) On the Script Path wizard tab, you can enter the path to a Run Once Script located on a server on your network.\nIf the App Layer is elastically assigned, the Run Once script will be executed the first time the app is used.\nIf the App Layer is included in a Layered Image, the Run Once script will be executed the first time the Layered Image is booted.\nClick \nFinalize\n to finish creating the Layer.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is ready to be deployed.\n\n\n\nReference: Create App Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for.\nLayer Description\n - (Optional) Description of the Layer\nVersion\n - (Required) This can be the version of the application or a version you assign to the Layer. This value is displayed in the Details view of the Layer. Keep in mind that you'll add a new version to this layer whenever you update the app(s) included in it, and this is where the version will be described.\nVersion Description\n - (Optional) Enter a description of the version.\nSpecify the Max Layer Size\n - Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 10 gigabytes. If the application you are installing could eventually require more space, change this to an appropriate value.\n\n\n\nCreate an App Layer (XenServer Connector)\n\n\nIn this article:\n\n\nBefore you start\nPrepare a new App Layer\nInstall the software on the Packaging Machine \nFinalize the Layer\nReference: Create App Layer Wizard values\n\n\n\nAn App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.\n\n\nTo create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.\n\n\nA Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.\n\n\nBefore you start\n\n\nRequirements\n\n\nTo create an App Layer, you need:\n\n\nCreate an OS Layer\n\n\n\nOptional\n\n\nBefore you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.\n\n\nPrerequisite Layer\nPlatform Layer (for cross-platform deployments) (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer)\nRun Once Script\n\n\n\nIf the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.\n\n\nPrerequisite Layer\n\n\nPrerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers \nshould only be used if they are required\n , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.\n\n\nReasons to consider using Prerequisite Layers:\n\n\nThe application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer.\nThe add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer.\nTwo applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.\n\n\n\nNote:\n  Some of these issues can also be handled by putting the two applications in the same layer.\n\n\nPlatform Layer (for cross-platform deployments)\n\n\nA Platform Layer is \nonly\n  required when creating App Layers on a hypervisor other than the one from which you imported your OS Layer.\n\n\nIf you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, it is strongly recommended that you create a Platform Layer containing the hypervisor tools and hardware settings you need to seamlessly install and package applications in your environment.\n\n\nRun Once Script\n\n\nYou can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.\n\n\nPrepare a new App Layer\n\n\nSelect \nLayers > App Layers\n and select \nCreate Layer\n in the Action bar. This opens the Create Layer wizard.\nIn the Layer Details tab, enter a \nLayer Name\n and \nVersion\n, both required values. Optionally, you can also enter other values. For details, see more about these values \nbelow\n.\nIn the OS Layer tab, select the \nOS Layer\n you want to associate with this App Layer.\n(Optional) In the Prerequisite Layers tab, if the application you are layering requires other App Layers to be present during installation, select the \nInclude Prerequisite Layers\n check box, and pick the necessary App Layer(s).\nNotes:\n \nPrerequisite layers are used while installing applications, and are \nnot included\n in the App Layer.\nPrerequisite layers are \nnot\n included by default when adding a new \nVersion\n to this App Layer. So, when you add a new Version to this App Layer, you must choose the Prerequisite Layers again, if needed.\nThe App Layer you are creating and each of its Prerequisite Layers must be associated with the selected OS Layer.\nIn the Connector tab, choose a \nPlatform Connector Configuration\n that contains the credentials for the platform where you plan to build the Layer, along with the storage location. If the configuration you need isn't listed, add a \nNew\n \nConnector Configuration\n and select it from this list.\nExample: If you're using the XenServer environment to create the Layer, select the XenServer connector with the credentials and location required to access the location where you want to build the Layer.\nIn the Platform Layer tab you can select a Platform Layer containing the tools and hardware settings that you need to install and package an application during Layer creation. This selection is only used during layer creation. Once created, the Layer can be used in Layered Images published to any platform.\nIn the Packaging Disk tab, enter a \nfile name\n for the Packaging Disk, and select the disk format. This disk will be used for the Packaging Machine (the VM) where you will install the application, as described in the next two sections.\nIn the Icon Assignment tab, select an icon to assign to the layer. This icon represents the layer in the Layers Module.\nTo use an existing image, select an image in the image box.\nTo import a new image, click \nBrowse\n and select an image in PNG or JPG format.\nIn the Confirm and Complete tab, review the details of the App Layer, enter a comment if required, and click \nCreate Layer\n. Any comments you enter will appear in the Information view Audit History. Once the Packaging Disk has been created, the Task bar displays instructions to navigate to the Packaging Machine in XenServer.\n\n\n\nNext, you can log into the Packaging Machine for your Layer, and install the software for the layer on it.\n\n\nDeploy a Unidesk Packaging Machine in XenServer\n\n\nBack in the Unidesk Management Console, expand the Tasks bar at the bottom of the UI, and double-click the \nCreate App Layer\n task to see the full Task Description (example below).\nUse the instructions in the Task Description to navigate to the Packaging Machine in your XenServer client.\nPower on the Packaging Machine.\n\n\n\nYou can now install the applications for this layer on the Packaging Machine.\n\n\nInstall the software on the Packaging Machine\n\n\nWhen you've completed the Layer wizard, Unidesk creates a Packaging Machine in your environment, in the location defined in the Connector Configuration. The Packaging Machine is a virtual machine where you install the software to be included in the layer.\n\n\nNote:\n  The Packaging Machine is a temporary VM that will be deleted once the new Platform Layer has been finalized.\n\n\nLog into the Packaging Machine\n\n\nLog into your vSphere web client.\nBack in the Unidesk Management Console, expand the Tasks bar at the bottom of the UI, and double-click the \nCreate App Layer\n task to see the full Task Description.\nUse the instructions in the Task Description to navigate to the Packaging Machine in your vSphere web client.\nThe Packaging Machine will be powered on.\n\n\n\nInstall the Application(s)\n\n\nWhen installing your application(s) on the Packaging Machine, leave each application as you want users to see it when they log in. The state of the applications when you finalize the layer is what users experience when they access the application. More guidance about this is included in the steps below.\n\n\nRemote log in to the Packaging Machine in vSphere. Be sure to log in with the User account you used to create the OS in vSphere.\nInstall the applications, along with any drivers, boot-level applications, or files that the user will need with it.\nIf an application installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically.\nMake sure the Packaging Machine is in the state you want it to be for the user:\nIf the applications you install require any post-installation setup or application registration, complete those steps now.\nRemove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.\n\n\n\nVerify the Layer and shut down the Packaging Machine\n\n\nOnce the application is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.\n\n\nTo verify that any outstanding processes are complete, you can run the \nShutdown For Finalize\n  tool (icon below), which appears on the Packaging Machine's desktop.\n\n\nTo use the Shutdown For Finalize tool:\n\n\nIf you are not logged into the Packaging Machine, remote log in as the user who created the machine.\nDouble-click the \nShutdown For Finalize\n icon. A command line window displays messages detailing the layer verification process.\nIf there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed \nbelow\n.\nOnce any pending operations are complete, double-click the \nShutdown For Finalize\n icon again. This shuts down the Packaging Machine.\n\n\n\nThe Layer is now ready to finalize.\n\n\nLayer integrity messages you may see during the finalization process\n\n\nLayer integrity messages let you know what queued tasks must be completed before a Layer is finalized.\n\n\nThe new Layer or Version can only be finalized when the following conditions have been addressed:\n\n\nA reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine.\nA post-installation reboot is pending - please check and reboot the Packaging Machine.\nAn MSI install operation is in progress - please check the Packaging Machine.\nA Microsoft NGen operation is in progress in the background.\nNote:\n If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.\n\n\n\nExpediting a Microsoft NGen operation\n\n\nNGen is the Microsoft \nNative Image Generator\n . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.\n\n\nYou have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.\n\n\nForcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.\n\n\nForce an NGen operation to the foreground.\nNormally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this:\nOpen a command prompt as Administrator.\nGo to the Microsoft .NET Framework directory for the version currently in use:\ncd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX\nEnter the NGen command to execute the queued items:\nngen update /force\nThis brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled.\nNote:\n It's okay if you see several compilation failed messages!\nLook in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run \nngen update /force\n. Do \nnot\n reboot to stop the task. You \nmust\n allow it to complete.\nCheck the status of an NGen operation\nOpen a command prompt as Administrator.\nCheck status by running this command:\nngen queue status\nWhen you receive the following status, the NGen is complete, and you can finalize the Layer.\nThe .NET Runtime Optimization Service is stopped\n\n\n\nFinalize the Layer\n\n\nOnce the software has been installed and the Packaging Machine has been verified and shut down, you are ready to finalize the layer.\n\n\nNote:\n  When you finalize a Layer, Unidesk may delete the Packaging Machine to minimize storage space used.\n\n\nWhen the Layer has been verified and is ready to finalize:\n\n\nReturn to the Unidesk Management Console.\nSelect \nLayers >App Layers\n, and then the layer you just prepared.\nSelect \nFinalize\n in the Action bar. The Finalize wizard appears.\n(Optional) On the Script Path wizard tab, you can enter the path to a Run Once Script located on a server on your network.\nIf the App Layer is elastically assigned, the Run Once script will be executed the first time the app is used.\nIf the App Layer is included in a Layered Image, the Run Once script will be executed the first time the Layered Image is booted.\nClick \nFinalize\n to finish creating the Layer.\n Monitor the Task bar to verify that the action completes successfully and that the Layer is ready to be deployed.\n\n\n\nReference: Create App Layer Wizard values\n\n\nLayer Name\n - (Required) A name that will let you know what app(s) the layer will be used for.\nLayer Description\n - (Optional) Description of the Layer\nVersion\n - (Required) This can be the version of the application or a version you assign to the Layer. This value is displayed in the Details view of the Layer. Keep in mind that you'll add a new version to this layer whenever you update the app(s) included in it, and this is where the version will be described.\nVersion Description\n - (Optional) Enter a description of the version.\nSpecify the Max Layer Size\n - Maximum layer size in gigabytes. Layers are \nthin provisioned\n, and will grow as needed, up to the maximum size. The default Max Layer Size is 10 gigabytes. If the application you are installing could eventually require more space, change this to an appropriate value.\n\n\n\nRecipes for layering Applications\n\n\nMost applications layer without a hitch, but there are a few that are trickier to layer, for example, Java, iTunes, Microsoft Office, and print drivers.\n\n\nFor recipes and tips about layering specific applications, visit the Unidesk Forum about \nApplication Layer Recipes\n. If you experience issues layering an application that is not included in these Application Layer Recipes, you can post a question to this Forum.\n\n\nNote: If in the unlikely event you find yourself reading the recipe for an application you want to layer in a 4.X image and it requires using a script path, please call our Tech Support so we can guide you through it.\n\n\nUser Layer (Unidesk Labs)\n\n\nIn this article:\n\n\nBefore you start\nEnable User Layers in the Layered Image\nUser Layer (Unidesk Labs)\n\n\n\nWith the Unidesk User Layer you now have the ability to persist user profile settings, data, and user-installed applications in non-persistent VDI environments.\n\n\nUser Layers are created when:\n\n\nYou set \nElastic Layering\n on an Image Template to \nApplication and User Layers\n, so that the Layered Image supports User Layers.\nA user logs in to their desktop for the first time, and a User Layer is created for them. From then on, the user's data and settings are saved in the User Layer, along with any applications that the user installs locally on their desktops.\n\n\n\nBefore you start\n\n\nPrerequisites\n\n\nCreate your \nOS Layer\n.\nCreate your \nPlatform Layer\n for publishing, if needed.\nCreate your \nApp Layers\n.\nEnough free disk space on your ELM's file share to ensure that these additional Layers do not cause you to run out. Allow enough space for the user's locally installed apps, plus the data and configuration settings for the user's Layers.\nMake sure network bandwidth is adequate, as bandwidth and latency have a significant effect on the User Layer. Every write goes across the network.\n\n\n\nCompatibility\n\n\nCurrently, User Layers are supported in conjunction with the following platforms:\n\n\nOperating systems: Windows 7, 64-bit\nPublishing platforms: VMware Horizon View and Citrix XenDesktop.\n\n\n\nUser Layer creation process\n\n\nEnable User Layers in your Image Template:\nSet \nElastic Layering\n in the Image Template wizard on the Image Disk tab) to \nApplication and User Layers\n.\nPublish Layered Images using the above Image Template.\nWhen a user logs on to their desktop for the first time, a User Layer is created for them.\n\n\n\nUser Layer size and location\n\n\nThe default size of a User Layer is 10 GB.\n\n\nUser Layers are created in the \nUsers\n  folder on the ELM's network file share, for example:\n\n\n\\\nMyServer\n *\nMyShare\n* \\Users\n\n\nEach user will have his/her own directory within the Users directory, and it will be named as follows:\n\n\nUsers*\ndomainIname\n *\n*username\n* *\nOS-Layer-ID-in-hex\n _\nOS-Layer-name\n *\n*username\n* .vhd\n\n\nFor example:\n\n\nUser's login name: \njdoe\n \nUser's Domain: \ntestdomain1\n \nOS layer: MyOSLayer (ID is in hexidecimal format: \n123456\n)\nUser Layer would be created in:\n\n\n\n\\MyServer\\MyShare\\Users\\testdomain1\\jdoe\\123456_MyOSLayer\\jdoe.vhd\n\n\nEnable User Layers in the Layered Image\n\n\nLog into the Unidesk Management Console (UMC) as an \nAdmin\n user.\nSelect \nImages\n.\nSelect the Image Template from which you will publish the Layered Image(s), and click \nEdit Template\n. This opens the Edit Image Template wizard.\nOn the Layered Image Disk tab, set \nElastic Layering\n to \nApplication and User Layers\n.\nOn the Confirm and Complete tab, click \nSave Template Changes\n.\nPublish your Layered Images.\n\n\n\nExpected behavior\n\n\nConsiderations\n\n\nBefore deploying User Layers, please consider the following guidelines and limitations.\n\n\nThe User Layer is delivered via the ELM's file share, therefore:\nIf the host is disconnected from the User Layer storage, the user will have to log out and log in again to re-establish the disk mount. The user will have to wait approximately 5 minutes because the user layer will be inaccessible.\nCertain enterprise applications, such as MS Office and Visual Studio should be installed in Layers, not as user-installed applications in the User Layer. In addition, the Elastic Layering limitations are applicable for User Layer. For more information on Layering limitations, please see the \nElastic Layering Limitations\n section.\nWindows updates must be disabled on the User Layer.\nVMware Horizon View:\nView must be configured for non-persistent desktops, and the desktop \nmust\n be set to \nRefresh at log off\n. Delete or refresh the machine on log off. Example:\nAfter logging off with View set to \nRefresh Immediately\n, the desktop goes into maintenance mode. If there is only one machine in the pool, the pool will not be available until that machine has completed the refresh.\n\n\n\nThe first time a user logs into his/her desktop, a User Layer is created for the him/her.\nIf there is problem loading the elastically assigned Layers for the user, they will still receive their User Layer.\nIf you rename the user in AD, a new directory and User Layer will be created for the new name. To avoid this, rename the directory on the file share and the VHD file in the directory structure to the new AD user name.\n\n\n\nAssign App Layers\n\n\nDo you want to assign this App Layer to Layered Images, or directly to users as an Elastic Layer? You can make both kinds of assignments, as long as each user is assigned a single instance of the Layer, either as part of an image or as an elastic layer.\n\n\nAssign an App Layer to Image Templates\n\n\nIn this article:\n\n\nPrerequisites\nAdd an App Layer Assignment to one or more Image Templates\nUpdate App Layers and Image Template Assignments\nRemove Template Assignments\n\n\n\nAn Image Template is a stored selection of Layers and settings that you use to publish Layered Images. At minimum, an Image Template contains an OS Layer, Platform Layer, and settings. Ideally, each template also contains your choice of App Layers for a particular image, for example, an image suited for the users served by a particular silo. Once you publish a Layered Image, you can provision systems using the image.\n\n\nWhen you create a new App Layer, you can assign the App Layer to one or more Unidesk Image Templates, and then use the templates to publish Layered Images that include the layer. This article explains how to assign an App Layer to one or more Image Templates, and update the assignments when you update the Layer.\n\n\nWhen you first update an App Layer, the new Layer Version is not assigned to any Image Templates, so you'll need to update the Layer Assignments. Updating the assignments allows you to assign different Versions of the Layer to different Image Templates. You cannot assign an App Layer to\n\n\nImportant:\n  When assigning App Layers, be sure to avoid assigning the app elastically to a user, if the app is already in the Layered Image that the user gets.\n\n\nPrerequisites\n\n\nOne or more App Layers.\nOne or more Image Templates.\n\n\n\nAdd an App Layer Assignment to one or more Image Templates\n\n\nLog into the Unidesk Management Console (UMC) as an Admin user, and select \nLayers > App Layers\n.\nSelect an App Layer to include in one or more of your Image Templates, and click \nAdd Assignments\n.\nIn the wizard that opens, select the App Layer that you want to assign to templates.\nOn the Image Template Assignment tab, select the templates in which you want to include this App Layer Version.\nSkip the Elastic Assignment tab.\nIn the Confirm and Complete tab, review your selections, and click \nAssign Apps\n.\n\n\n\nWhen you open each of the Image Templates you will see the App Layer Version you just assigned to the template.\n\n\nUpdate App Layers and Image Template Assignments\n\n\nWhen you update an application by adding a new Version to the App Layer, the new Layer Version will \nnot\n  inherit the original Layer Assignments. You need to assign the new App Layer Version.\n\n\nLog into the UMC and select \nLayers > App Layers\n.\nSelect the App Layer that has been updated.\nRight-click the Layer icon and select \nUpdate Assignments\n.\nIn the wizard that opens, select the new App Layer Version.\nClick the \nImage Template Assignment\n tab, and select the Image Templates to which you want to assign the new Layer Version .\nNotes:\nIf the list is long, use the \nSearch\n field to filter the results.\nIf the list is empty, click the check box called, \nShow Image Templates already at this version\n. A list of grayed out names may appear. These Image Templates have already been assigned the Version.\nSkip the Elastic Assignment tab.\nOn the Confirm and Complete tab, verify the Image Templates selected to receive the new Version, and click \nUpdate Assignments\n.\n\n\n\nRemove Template Assignments\n\n\nWhen you remove an App Layer's Template Assignments, the assignments for all versions of the Layer are removed. If you want to remove the assignments for a specific Version of the Layer, select Update Assignments instead.\n\n\nLog into the UMC and select \nLayers > App Layers\n.\nSelect the App Layer for which you want to remove assignments, and select \nRemove Assignments\n..\nIn the wizard that opens, select the assigned templates from which you want to remove the Layer. All of the assignments for that layer are listed.\nIf the list is long, use the Search field to filter the results.\nOn the Confirm and Complete tab, verify the Image Templates selected to receive the new Version, and click \nUpdate Assignments\n.\n\n\n\nAssign App Layers to users elastically (Elastic Layers)\n\n\nIn this article:\n\n\nAssign apps elastically\nPrerequisites and limitations\nEnable Elastic Layering in the base image\nRun the Elastic Fit Analyzer on App Layers (Unidesk Labs)\nElastically assign an App Layer to AD Users and Groups\nElastically assign an App Layer to users via machine assignments and associations\nManage Elastic Assignments\n\n\n\nAssign apps elastically\n\n\nWouldn't it be nice to drastically reduce the number of images you have to manage? What if you could leave apps that only a few users need out of your base image? And, assign the layers to specific users \nelastically\n  on top of the base image. With the Elastic App Layers feature, you can do just that.\n\n\nAn Elastic App Layer is a Unidesk App Layer that you configure to be delivered to specific users and groups, based on user entitlements, when the users log onto their session hosts or standalone desktops. With Elastic App Layers, you can give each user his/her own unique set of applications in addition to the base Layered Image that is used across sessions in the case of session hosts), and across floating pools/shared groups in the case of desktops.\n\n\nAs this diagram shows, once you add Elastic Assignments to an App Layer, a copy of the Layer is stored in the ELM's Network File Share, and delivered to individual AD users and groups on-demand, in addition to the Layers that they receive via the base image.\n\n\nTo use this feature, you'll add \nElastic Assignments\n  specifying which users and groups should receive each of the App Layers that you would like to leave out of your base images. You'll then publish your base image(s) with the \nElastic Layering For Session Hosts\n  selected.\n\n\nHow users access Elastic Layers assigned to them\n\n\nWhen users log into their Session or Desktop, icons for their Elastic Layers will appear as shortcuts on the desktop.\n\n\nA user receives an Elastic Layer in the following cases:\n\n\nThe user (an AD user in the Unidesk Management Console) is assigned the Layer.\nAn AD group that the user belongs to is assigned the Layer.\nA machine that the user logs into is a member of an AD Group that receives the Elastic Layer.\nA machine that the user logs into is associated (via the UMC) with an AD Group that is assigned the Layer via the UMC.\n\n\n\nIf more than one version of the same Layer is assigned to a user\n\n\nIf a Layer is assigned directly to the user and indirectly to one or more of the user's groups, the user receives the most recent version of the Layer assigned \ndirectly\n  to her/him. For example, if a user is assigned Version 2, and a group that the user belongs to is assigned Version 3, the user will get Version 2.\n\n\nIf the user is assigned a Layer via one or more group assignments, the user receives the most recent version of the Layer.\n\n\nIf a user has an App Layer in their Layered Image, and the Layer is also assigned to them elastically\n\n\nIf a user has an App Layer in the Layered Image and the user is also assigned the Layer elastically, they will receive the Elastic Layer, even if the version in the base image is more recent.\n\n\nPrerequisites and limitations\n\n\nPrerequisites\n\n\nThe ELM's Network File Share must be configured correctly:\nThe Share must be configured using SMB technology. When using Elastic Layer assignments, \nNFS technology is not supported\n.\nThe Share must be set up by the admin to be \nreadonly\n for all users \nexcept\n for the one configured in the ELM. This secures the Layers and other files stored on the Share.\nThe User named in this configuration must have \nRead/Write\n permissions on the root of the network file share. Select \nSystem > Settings and Configuration\n and scroll to \nNetwork File Share\n.\nMake sure that any users who will be assigned Elastic Layers have \nRead only\n access for the root directory of the Network File Share.\n.NET Framework 4.5 is required on any Layered Image where Elastic Layers are enabled.\nThe \nApp Layers\n you want to elastically assign.\nNote:\n App Layers must be created using the \nsame OS Layer\n used to create the Layered Image that you enable to deliver the Elastic App Layer to users.\n\n\n\nElastic Layering Limitations\n\n\nYou cannot elastically layer the following:\n\n\nMicrosoft Office Add-ons and extensions in individual Unidesk Layers. A user must have \nall\n of their add-ons in \none\n Layer. Note: Please use the recipe for elastically layering MS Office.\nApplications with drivers that use the driver store. For example, a printer driver.\nApplications that modify the network stack or hardware. For example, a VPN client.\nApplications that have boot level drivers. For example, a virus scanner.\n\n\n\nEnable \nElastic Layering\n  in the base image\n\n\nWhen you publish the Layered Image that the users will log into to get the Elastic App Layer(s):\n\n\nIn the Image Template Wizard, on the Layered Image Disk tab, select \nElastic Layering For Session Hosts\n.\nFinish publishing the Layered Image.\nProvision your Session Hosts with the new base image.\nWhen the users log in, they should see an icon for each Elastic App Layer they've been assigned.\n\n\n\nRun the Elastic Fit Analyzer on App Layers (Unidesk Labs)\n\n\nBefore assigning an App Layer elastically, use the Elastic Fit Analyzer to determine the likelihood that the Layer assignment will be successful.\n\n\nElastic Fit Analysis\n\n\nIn the Layer Details, the Elastic Fit rating indicates how likely it is that the Layer will work when elastically assigned.\n\n\nGood Elastic Fit.\n This layer should work when deployed elastically.\nPoor Elastic Fit.\n This layer will probably not work when deployed elastically, or may behave differently than when it is deployed in a Layered Image.\n\n\n\nElastic Fit Details\n\n\nYou can learn more about the Elastic Fit of a Layer by expanding the Elastic Fit Analysis. If the Elastic Fit is less than ideal, the list of violated rules will be displayed.\n\n\nLow Severity Warning.\n This is unlikely to cause any change in behavior or functionality for most applications.\nMedium Severity Warning.\n This may cause minor changes in behavior or functionality for some applications.\nHigh Severity Warning.\n This is likely to cause significant changes in behavior or functionality for many applications.\n\n\n\nEnable Elastic Fit in Unidesk Labs\n\n\nTo use this Unidesk Labs feature, you must enable it. To enable Elastic Fit:\n\n\nIn the Unidesk Management Appliance (UMC), select \nSystem > Settings and Configuration\n.\nClick \nEdit\n Unidesk Labs.\nSelect the \nElastic Fit\n check box.\nClick \nSave\n.\n\n\n\nAnalyze an App Layer for Elastic Fit\n\n\nAll new Layer Versions will be analyzed for elastic layering compatibility when they are finalized. To analyze existing App Layers for Elastic Fit:\n\n\nLog into the Unidesk Management Console (UMC) .\nSelect \nLayers > App Layers\n.\nSelect the Layer to analyze, and click \nAnalyze Layer\n.\nOn the Select Versions tab, choose the Layer Versions to analyze.\nOn the Confirm and Complete tab, click \nAnalyze Layer Versions\n. The analysis takes seconds.\nTo see the Elastic Fit Analysis, select the App Layers module, move the mouse pointer over the Layer icon and click the \nInfo\n \n icon.\nExpand the \nVersion Information\n for each Layer Version, and look for the Elastic Fit rating.\nFor a detailed report, expand the \nElastic Fit Details\n. If the Elastic Fit is less than ideal, the list of violated rules will be displayed.\nYou can display the AD tree and hide the violated rules by clicking a button acknowledging that the layer is unlikely to work as expected.\n\n\n\nUpgrading from Earlier Releases\n\n\nAfter upgrading from an earlier Unidesk release, the Elastic Fit Detail shows that any existing Layer Version(s) have not been analyzed. Until you run the analysis on existing Layer Versions, the Versions will have a single \nHigh severity\n  Elastic Fit Detail, and a \nPoor\n  Elastic Fit.\n\n\nElastically assign an App Layer to AD Users and Groups\n\n\nThe first time you assign an App Layer elastically, we recommend starting with an app like \nNotepad++\n  or \nGIMP\n , because they are simple to .\n\n\nLog into the Unidesk Management Console (UMC) as an Admin user, and select \nLayers > App Layers\n.\nSelect an App Layer that is \nnot going to be included in the base image\n, and select \nAdd Assignments\n.\nIn the wizard that opens, select the Version of the App Layer that you want to assign users.\nSkip the \nImage Template Assignment\n tab. This tab is for assigning the Layer to an Image Template.\nIn the Elastic Assignment tab, select the users and groups who should get this App Layer.\nIn the Confirm and Complete tab, review your selections, and click \nAssign Apps\n.\n\n\n\nWhen the users log in, they should see an icon for each Elastic App Layer they've been assigned.\n\n\nElastically assign an App Layer to users via machine assignments and associations\n\n\nAny machine running the Unidesk Layering Service (ULayer.exe) can have Elastic Layers assigned to it. You can accomplish this by either adding the machine to or associating it with the AD Group, and then elastically assigning the App Layers to the AD Group.\n\n\nThe Layers assigned to the machine will be available to every User who successfully logs into that machine. The Unidesk Layering Service will scan for changes to the machine's AD group memberships and associations every 10 minutes. When the users log in, they should see an icon for each Elastic App Layer they've been assigned.\n\n\nUse \nActive Directory\n  to \nadd\n  the machine to the AD Group\n\n\nAssuming you have a published Layered Image booted in your environment, you can add the machine to an AD Group, and assign Elastic Layers to the AD Group.\n\n\nUse Active Directory (AD) to add the machine to an AD Group.\nSelect an App Layer that is \nnot going to be included in the base image\n, and \nelastically assign\n the Layer(s) to an AD Group.\nYou can wait for AD to propagate the changes and be recognized by the Unidesk Layering Service, or you can force the Unidesk Layering Service to update its list of machine groups by doing \none\n of the following:\nWait for the Unidesk Layering Service to detect the changes (within 10 minutes by default).\nRestart the Unidesk Layering Service.\nReboot the Unidesk Layering Service Machine.\nExecute the \nrefresh.groups\n command:\nC:\\Program Files\\Unidesk\\Layering Services\\ulayer.exe refresh.groups\n\n\n\nExample\n\n\nYou start with an AD User, and AD Group, and a machine that you provisioned using a Layered Image.\n\n\nAD User: \nKenya\nKenya has no elastic assignments.\nAD Group: \nMarketing\nThe \nMarketing\n group includes the member Kenya.\nMachine: \nElasticTestMachine\nThe \nElasticTestMachine\n base image includes the \nMS Office App Layer\n.\n\n\n\nIn this example, you elastically assign the \nChrome App Layer\n  to \nElasticTestMachine\n :\n\n\nIn AD, you add the machine \nElasticTestMachine\n to the \nMarketing\n AD Group.\nIn the Unidesk Management Console (UMC) you \nelastically assign\n the \nChrome App Layer\n to the \nMarketing\n Group.\nWhen Kenya, who is part of the Marketing group, logs into \nElasticTestMachine\n, she receives both the \nMS Office App Layer\n, which is in the base image, and the \nChrome App Layer\n.\nWhen any user who is \nnot\n in the \nMarketing\n group logs into \nElasticTestMachine\n, they also receive both Layers: \nMS Office\n because it is in the base image, and \nChrome\n because the \nElasticTestMachine\n is a member of the \nMarketing\n AD Group.\n\n\n\nUse the \nUMC\n  to \nassociate\n  the machine with an AD Group\n\n\nAssociating a set of machines with an AD Group allows any machine running the Unidesk Layering Service to have Layers elastically assigned to it via AD group membership.\n\n\nElastic Layers granted via Machine association can be thought of as \nextending\n  the layers assigned to a user. For example, if a machine matches multiple Machine Associations, only the unique layers will be added to the ones the user already has.\n\n\nIn the UMC, you use asterisk (*) wildcards in a machine name pattern to specify a set of machine names. For example:\n\n\nMachine name pattern\nMatches these names\nDoes \nnot\n match these names\nmachine*\nmachine01\nmachineindetroit\namachine\nlocaltestmachine\n*machine\namachine\nlocaltestmachine\nmachine01\nmachineindetroit\nky*eng\nky02359eng\nkytesteng\n01ky_eng\ntestky01eng\n*eng*\neng01\n1eng\n1eng01\nen01\n1en\n1en01\n\n\n\nYou can create Machine Associations before or after elastically assigning App Layers to the AD Group. Also, the machines do not need to exist when you add the associations, as the associations exist within Unidesk only, and AD is not aware of them.\n\n\nAssociate a set of machines with an AD Group\n\n\nLog into the Unidesk Management Console (UMC) as an Admin user, and select \nUsers > Tree\n.\nExpand the Tree, select the appropriate Group and click \nEdit Properties\n in the Action bar. This opens the Edit Group Wizard.\nSelect the checkbox, \nAssociate machines with this AD Group\n. This reveals the \nMachine Name Pattern\n field:\nSpecify a set of machines to associate with the AD group by entering a machine name pattern. For examples, see the above table of Machine name patterns.\nOn the Confirm and Complete tab, select \nUpdate Group\n. Notice the shape of a computer monitor superimposed over the group icon. This indicates that machines are associated with the group.\nWhen you click the group's \n icon, the Detail view now includes a field called, \nAssociate With Machines\n where the pattern.\n\n\n\nExample\n\n\nYou start with the machine, \nMach1\n , the AD Group, \nMachineGroup\n , and the App Layers for \nFirefox\n  and \nMS Office\n .\n\n\nMachine: \nMach1\nAD Group: \nMachineGroup\nApp Layers: \nFirefox\n, \nMS Office\n\n\n\nFurther, you have elastically assigned the Firefox and MS Office Layers to the AD Group.\n\n\nIf you add a Machine Association to \nMachineGroup\n  with a name pattern of \"\nMach\n* \", when any domain user logs into \nMach1\n , they will receive the Firefox and MS Office Elastic App Layers.\n\n\nManage Elastic Assignments\n\n\nYou can:\n\n\nView a user's Elastic Layer assignments.\nUpdate an App Layer and elastically assign the new Version of the Layer.\nRemove Elastic Assignments.\nDebug an Elastic Assignments.\n\n\n\nView a user's Elastic Layer assignments\n\n\nLog into the UMC and select \nUsers > Tree\n.\nSelect an AD User or Group, and click the \"i\" icon to the \nright\n of the name. If the user or group is assigned any Elastic Layers, the Layers are listed just below the user's or group's profile information in the Details window that appears.\n\n\n\nUpdate an App Layer and its Elastic Assignments\n\n\nYou've added Elastic Assignments to an App Layer, and users are accessing the app as expected. A new version of the application is released, so you update it by adding a new Version to the Layer. Now you need to assign the new version to the users who have the Layer.\n\n\nLog into the UMC and select \nLayers > App Layers\n.\nSelect the elastically assigned App Layer that you just updated.\nRight-click the Layer icon and select \nUpdate Assignments\n.\nIn the wizard that opens, select the new Version.\nSkip\n the Image Template Assignment tab.\nIn the Elastic Assignment tab, there's a list of Users and Groups who have been assigned a different version of the selected Layer. Select the users and groups to whom you want to assign the new Version of the Layer.\nNotes:\n \nIf the list is long, use the \nSearch\n field to filter the results.\nIf the list is empty, click the check box called, \nShow AD users and groups already at this version\n. A list of grayed out names may appear. These users have already been assigned the Version.\nOn the Confirm and Complete tab, verify the Users and Groups selected to receive the new Version, and click \nUpdate Assignments\n.\n\n\n\nRemove a Layer's Elastic Assignments\n\n\nLog into the UMC and select \nLayers > App Layers\n.\nSelect the App Layer for which you want to remove assignments, and select \nRemove Assignments\n..\nIn the wizard that opens, select the assigned templates from which you want to remove the Layer. All of the assignments for that layer are listed.\nIf the list is long, use the Search field to filter the results.\nOn the Confirm and Complete tab, verify the Image Templates selected to receive the new Version, and click \nUpdate Assignments\n.\n\n\n\nDebug an Elastic Layer\n\n\nIf you have an Elastic Layering issue, you can diagnose the problem by finding out whether the layer is being delivered, and if so, whether it is working correctly. If needed, collect data for Unidesk Support, as described here.\n\n\nIs this a Delivery issue?\n\n\nAre the things you'd expect to see if this app were installed actually there as expected?\n\n\nDo you see the files and registry entries for the layer?\nIf the app is supposed to be in the Start menu, is it there?\nIf there should be a shortcut for the app on the user's desktop, is there one?\n\n\n\nIf you discover that app delivery is an issue, you can collect the following data, open a case, and send the data to Unidesk Support.\n\n\nCollect the data from these logs:\nWindows App Event log  In the Windows Event Viewer under Windows Logs, export the Application event log as an EVTX file.\nUnidesk Layering Service log (ulayersvc.log)  C:\\ProgramData\\Unidesk\\Logs\\ulayersvc.log\nCollect the values of these Registry keys:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Unidesk\\ULayer:AssignmentFile\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Unidesk\\ULayer:RepositoryPath\nCollect the contents of the Assignment (ElasticLayerAssignments.json) and Layers (Layers.json) files from the Repository Path.\nContact Support.\n\n\n\nIs this an operational issue?\n\n\nOne of these issues could indicate that this is an Elastic Layering issue:\n\n\nThe app is being delivered but doesn't launch correctly.\nAn operation within the app doesn't work correctly.\nA licensing problem or a security issue.\nThe app launches, but then misbehaves, for example, it crashes on startup, or starts up but doesn't work right.\n\n\n\nIf the problem with the Layer is operational, test the App Layer in the base image to rule out general layering issues:\n\n\nAdd the App Layer to an Image Template, and publish a Layered Image that includes the App Layer.\nLog in as a user who is \nnot\n assigned the Layer elastically, and make sure that the application is operational in the base image.\nContact Support with your findings.\n\n\n\nDelete Layers\n\n\nWhat type of layer do you want to delete?\n\n\nDelete an OS Layer\n\n\nYou can delete an OS Layer or Layer version, as long as it is not being used by another Unidesk Layer, or Image Template. Deleting the Layer itself removes all versions, volumes, and resources from Unidesk, where it is stored.\n\n\nIn this article:\n\n\nBefore you can delete a Layer or Layer Version \n\n\nDelete a Layer or Layer Version\n\n\nBefore you can delete a Layer or Layer Version\n\n\nYou can delete an entire layer or a layer version if it is:\n\n\nNot deployed to an Image Template.\nNot the required OS Layer (or Layer Version) for any compatible App Layers.\nNot a prerequisite for another Layer that is deployed to an Image Template.\n\n\n\nDelete a Layer or Layer Version\n\n\nIn the Unidesk Management Console, select \nLayers\n.\nSelect an OS Layer to delete.\nSelect \nDelete Versions\n in the Action bar. This opens the Delete Version Layer wizard.\nIn the Version Selection tab, select the Version you want to delete, or select the \nDelete Layer\n check box to delete the entire Layer.\nIn the Confirm and Complete tab, verify that the correct Version (or Layer) is selected for deletion, enter a comment if needed, and click \nDelete Versions\n.(missing or bad snippet)\n\n\n\nDelete a Platform Layer\n\n\nYou can delete a Platform Layer or Layer version, as long as it is not being used by an Image Template. Deleting the Layer itself removes all versions and resources associated with the Layer.\n\n\nIn this article:\n\n\nDelete a Layer or Layer Version\n\n\nDelete a Layer or Layer Version\n\n\nIn the Unidesk Management Console, select \nLayers > Platform Layers\n.\nSelect a Layer to delete.\nSelect \nDelete Versions\n in the Action bar. This opens the Delete Version Layer wizard.\nIn the Version Selection tab, select the Version you want to delete, or select the \nDelete Layer\n check box to delete the entire Layer and all Versions.\nIn the Confirm and Complete tab, verify that the correct Version (or Layer) is selected for deletion, enter a comment if needed, and click \nDelete Versions\n.(missing or bad snippet)\n\n\n\nDelete an App Layer\n\n\nYou can delete an App Layer or Layer version, as long as it is not being used by another Unidesk Layer, or Image Template. Deleting the Layer itself removes all versions and resources associated with the Layer.\n\n\nIn this article:\n\n\nBefore you can delete a Layer or Layer Version \n\n\nDelete a Layer or Layer Version\n\n\nBefore you can delete a Layer or Layer Version\n\n\nYou can delete an entire layer or a layer version if it is:\n\n\nNot deployed to an Image Template.\nNot a prerequisite for another Layer that is deployed to an Image Template.\n\n\n\nDelete a Layer or Layer Version\n\n\nIn the Unidesk Management Console, select \nLayers > Application Layers\n.\nSelect a Layer to delete.\nSelect \nDelete Versions\n in the Action bar. This opens the Delete Version Layer wizard.\nIn the Version Selection tab, select the Version you want to delete, or select the \nDelete Layer\n check box to delete the entire Layer and all Versions.\nIn the Confirm and Complete tab, verify that the correct Version (or Layer) is selected for deletion, enter a comment if needed, and click \nDelete Versions\n.(missing or bad snippet)\n\n\n\nPublishing essentials\n\n\nUnidesk lets you publish \nLayered Images\n  as disks compatible with your platform. You can use a Layered Image to provision servers, as you would with any other image.\n\n\nAbout Layered Images\n\n\nLayered Images are bootable images composited from Unidesk Layers. Each Layered Image contains an OS Layer, a Platform Layer, and any number of App Layers.\n\n\nCreating and updating Layered Images\n\n\nThe way you specify which layers to include in a Layered Image is by saving the combination of layers you want for a particular group of users in an Image Template. You then use this template to publish a Layered Image to your chosen platform.\n\n\nWhen you need to update the Layered Image, you simply edit the Image Template to add or remove layer assignments, and publish a new version of the image.\n\n\nPublish Layered Images\n\n\nOnce you have an OS Layer and a Platform Layer, a best practice is to verify that the Layers can be published to your environment as part of a Layered Image. Then you can build out the image by adding App Layers to it.\n\n\nTo publish the Layered Image, you first add the Layers to an Image Template, and use the template to publish a Layered Image. Once you have verified that the Layered Image is successfully published, create your App Layers, add them to your Image Template, and publish a Layered Image.\n\n\nBefore you start\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM)\n\n\nSet up Unidesk\n\n\nCreate Layers\n\n\nPublish Layered Images\n\n\nCreate an Image Template\nPublish a Layered Image\n\n\n\nNext Steps\n\n\nNow you can:\n\n\nUpdate your OS Layer and App Layers, as needed\nAdd the new layer version to your Image Template\nPublish the Layered Image\n\n\n\nCreate Image Templates\n\n\nOn what platform are you publishing Layered Images?\n\n\nCreate Image Templates (MCS for Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit\n an Image Template and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nOS Layer\n (Required)\nPlatform Layer\n (Required for cross-platform deployments)\nThe Platform Layer contains the software required for publishing to your environment, in this case:\nNutanix Acropolis VM Mobility\nCitrix MCS Device imaging tools\nThe Platform Layer must have the same hardware settings as the OS Layer. You choose these settings when deploying the VM for the OS and Platform Layers.\nApp Layers\n (Optional)\nYou can create an Image Template without App Layers. This is useful for testing your OS Layer before using it to create App Layers.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select a Citrix MCS for Nutanix AHV Connector Configuration for the location where you want to publish the Layered Image.\nIf you do not yet have a Connector Configuration for Citrix MCS for Nutanix AHV, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment. For details, click \nhere\n.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nLayered Image Disk Format\n. The default disk format is VHD, but you can also select VMDK or QCOW2.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. To allow Elastic Layers for users of this Layered Image, select \nApplication Layers only\n. Otherwise, select \nNone\n.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (MCS for Nutanix AHV)\n\n\nCreate Image Templates (Citrix MCS for vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\nThe Platform Layer must include:\nThe same hardware settings as the OS Layer you are using. (You choose the hardware settings when deploying the VM for the OS and Platform Layers.)\nThe software and settings required for your environment.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select the Citrix MCS for vSphere Connector Configuration for the location where you want to publish the Layered Image.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Format\n. Use the default format, since this is the one required for your selected environment.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (Citrix MCS for vSphere)\n\n\nCreate Image Templates (Citrix MCS for XenServer)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nOS Layer\n (Required)\nPlatform Layer\n (Required for cross-platform deployments)\nThe Platform Layer contains the software required for publishing to your environment, in this case:\nCitrix XenServer\nCitrix MCS Device imaging tools\nXenApp VDA installed\nThe Platform Layer must have the same hardware settings as the OS Layer. (These settings are chosen when deploying the VM for the OS and Platform Layers.)\nApp Layers\n (Optional)\nYou can create an Image Template without App Layers. This is useful for testing your OS Layer before using it to create App Layers.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select the MCS for Nutanix AHV Connector Configuration for the location where you want to publish the Layered Image.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Format\n. Use the default format, since this is the one required for your selected environment.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (Citrix MCS for XenServer)\n\n\nCreate Image Templates (PVS)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment:\nWhen publishing images to PVS for XenApp users, the following must be installed on the Platform Layer:\nCitrix PVS Device imaging tools\nXenApp VDA installed\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector tab, select the PVS Connector Configuration that includes the information needed to publish the Layered Image to the correct location.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nOn the Platform Layer tab, select a Platform Layer containing the tools and hardware settings that you need to publish Layered Images to your PVS location.\nOn the Layered Image Disk tab, edit the following fields, as needed:\nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nCreate Image Templates (XenServer)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit\n an Image Template and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\nThe Platform Layer you choose must have the same hardware settings as the OS Layer you are using. (The hardware settings are chosen when you deploy the VM for the OS and Platform Layers.)\nThe Platform Layer you choose must contain the software required for your environment.\nExample:\n When publishing images to PVS for XenApp users running in XenServer, the following must be installed on the Platform Layer:\nCitrix XenServer\nCitrix PVS Device imaging tools\nXenApp VDA installed\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select the XenServer Connector Configuration for the location where you want to publish the Layered Image.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nSysprep\n. An appropriate default value will be selected for your environment. This setting determines whether the Layered Image will be generalized, and if so, which script will be used to generalize the image and join a domain.\nNot Generalized\n - Does \nnot\n generalize the image nor join a domain. Machines created from this image will be identical to the OS Disk from which they are created.\nGeneralize Offline\n - Generalizes the Image using Unidesk code, and without booting the VM. Machines created from this image will be unique, and will run unattend.xml to join a domain.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (vSphere)\n\n\nCreate Image Templates (Azure)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to use for publishing Layered Images to your target platform. You can then use the published Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector tab, select the Connector Configuration that includes the information needed to publish the Layered Image to the correct location.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nOn the Platform Layer tab, select the Platform Layer that contains the tools and hardware settings required to publish Layered Images to Azure RDS.\n(Optional) On the Layered Image Disk tab, edit the following fields, if needed:\nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (Azure RDSH)\n\n\nCreate Image Templates (NFS)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\nThe Platform Layer you choose must have the same hardware settings as the OS Layer you are using. (The hardware settings are chosen when you deploy the VM for the OS and Platform Layers.)\nThe Platform Layer you choose must contain the software required for your environment.\nExample:\n When publishing images to PVS for XenApp users running in vSphere, the following must be installed on the Platform Layer:\nVMware vSphere\nCitrix PVS Device imaging tools\nXenApp VDA installed\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector Configuration tab, select the \nNetwork File Share\n.\nOn the Platform Layer tab, you can select a Platform Layer that contains the tools and hardware settings that you need to publish Layered Images to the location defined in the Connector Configuration.\nOn the Layered Image Disk tab:\nLayered Image Disk File name\n. (Optional) You can change the default Layered Image Disk File name.\nLayered Image Disk Format\n. Select the Disk Format appropriate for the environment where your servers are running. For example, select VHD when publishing images to Azure or Hyper-V environments. Select VMDK when publishing images to vSphere or PVS, for example, when streaming the images to vSphere servers. Or, select QCOW2 or VHD when publishing to Nutanix AHV.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nSysprep\n. If your Platform Target is a \nNetwork File Share\n, this option lets you choose the method for generalizing the Layered Image. Select the method that is appropriate for your connection broker.\nNot Generalized\n - Does \nnot\n generalize the Layered Image nor join a domain. Machines created from this image will be identical to the OS Disk from which they are created. Machines created from this image will be identical to the OS Disk they are created from.\nGeneralize Offline\n - Generalizes the Image using Unidesk code, and without booting the VM. Machines created from this image will be unique, and will run unattend.xml to join a domain.\nElastic Layering\n - (Available when Elastic Layering is enabled) Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (Network File Share)\n\n\nCreate Image Templates (Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit\n an Image Template and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nOS Layer\n (Required)\nPlatform Layer\n (Required for cross-platform deployments)\nThe Platform Layer contains the software required for publishing to your environment, in this case:\nNutanix Acropolis VM Mobility\nCitrix MCS Device imaging tools\nThe Platform Layer must have the same hardware settings as the OS Layer. You choose these settings when deploying the VM for the OS and Platform Layers.\nApp Layers\n (Optional)\nYou can create an Image Template without App Layers. This is useful for testing your OS Layer before using it to create App Layers.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select a Citrix MCS for Nutanix AHV Connector Configuration for the location where you want to publish the Layered Image.\nIf you do not yet have a Connector Configuration for Citrix MCS for Nutanix AHV, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment. For details, click \nhere\n.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Size\n. The default disk size of 100 GB is recommended.\nLayered Image Disk Format\n. The default disk format is VHD, but you can also select VMDK or QCOW2.\nSysprep\n. An appropriate default value is selected for your environment. This setting determines whether the Layered Image will be generalized, and if so, which script will be used to generalize the image and join a domain. Since MCS uses its own built in technology to perform the operations generally performed by sysprep, MCS requires the VMs used with their catalogs not be generalized so they do not go through the sysprep steps when first powered on in the catalog.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed, and whether the user's app data and configuration settings are saved in a User Layer . , select one of the following values:\nApplication Layers only\n. Allows Elastic Layers for users who log into this Layered Image. Available for both Session Hosts and Desktops.\nApplication and User Layers (Unidesk Labs)\n. Enables Elastic Layer assignments and User Layers on the Layered Image. User Layers preserve users' application data and configuration settings. Currently, User Layers can be used on \nWindows 7\n Layered Images only, not on Windows 10, nor on Session Hosts.\nNone\n. Elastic Layers and User Layers are disabled.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (Nutanix AHV)\n\n\nCreate Image Templates (VMware Horizon View for vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to VMware Horizon View Composer where you can then use the Layered Image(s) to provision servers on your chosen publishing platform. The Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nAs long as you select a \nVMware Horizon for vSphere\n  Connector Configuration, using this Image Template to publish a Layered Image will result in a VM in a ready-to-use state, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications. Each Layered image is a new 'Parent VM' that you can select for your Linked Clones pool.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\nThe Platform Layer must include:\nThe same hardware settings as the OS Layer you are using. (You choose the hardware settings when deploying the VM for the OS and Platform Layers.)\nThe software and settings required for your environment.\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select the VMware Horizon for vSphere Connector Configuration for the location where you want to publish the Layered Image.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Format\n. Use the default format, since this is the one required for your selected environment.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (VMware Horizon View for vSphere)\n\n\nCreate Image Templates (vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nCreate an Image Template\nNext Step\n\n\n\nYou can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily \nedit an Image Template\n and use it to publish new versions of your Layered Images.\n\n\nPrerequisites\n\n\nTo create an Image Template you need:\n\n\nA Platform Layer containing the software required for your environment.\nThe Platform Layer you choose must have the same hardware settings as the OS Layer you are using. (The hardware settings are chosen when you deploy the VM for the OS and Platform Layers.)\nThe Platform Layer you choose must contain the software required for your environment.\nExample:\n When publishing images to PVS for XenApp users running in vSphere, the following must be installed on the Platform Layer:\nVMware vSphere\nCitrix PVS Device imaging tools\nXenApp VDA installed\n\n\n\nCreate an Image Template\n\n\nTo create an Image Template:\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module, then click \nCreate Template\n. This opens the Create Template wizard.\nIn the Name and Description tab, enter a \nName\n for the template and notes in the \nDescription\n field, so you can identify the template when choosing one for publishing a Layered Image.\nIn the OS Layer tab, select one of the \nAvailable OS Layers\n. If there is more than one Layer Version, the most recent version is selected by default. You can choose an older version by expanding the Layer and choosing a different one.\nIn the App Assignment tab, select the \nApp Layers\n to include in the Layered Images that you publish using this template.\nOn the Connector page, select the vSphere Connector Configuration for the location where you want to publish the Layered Image.\nIf the Connector Configuration you need is not available, add one. Click \nNew\n, choose the Connector Type, and follow the instructions to \nCreate a Connector Configuration\n.\nIn the Platform Layer tab, select a Platform Layer with the tools and hardware settings that you need to publish Layered Images to your environment.\nOn the Layered Image Disk page, edit the following fields, as needed:\n(Optional) \nLayered Image Disk File name\n. Enter a name for the Layered Image Disk.\nLayered Image Disk Format\n. Use the default format, since this is the one required for your selected environment.\nSysprep\n. An appropriate default value will be selected for your environment. This setting determines whether the Layered Image will be generalized, and if so, which script will be used to generalize the image and join a domain.\nNot Generalized\n - Does \nnot\n generalize the image nor join a domain. Machines created from this image will be identical to the OS Disk from which they are created.\nGeneralize Offline\n - Generalizes the Image using Unidesk code, and without booting the VM. Machines created from this image will be unique, and will run unattend.xml to join a domain.\nElastic Layering\n - Controls whether Elastic Layering on this Layered Image is allowed. Select yes to allow Elastic Layers for users of this Layered Image.\nOn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nCreate Template\n.\n\n\n\nThe new Template icon appears in the Unidesk Images module.\n\n\nNext Step\n\n\nPublish Layered Images (vSphere)\n\n\nPublish Layered Images\n\n\nOn what platform are you publishing Layered Images?\n\n\nPublish Layered Images (Azure RDSH)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\nProvision a Session Host\nNext Step\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to your chosen platform and use them to provision systems.\n\n\nPrerequisites\n\n\nTo publish Layered Images, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nTo use an Image Template to publish a Layered Image:\n\n\nIn the Images module, select one or more Image Templates that you want to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nMake sure you are logged onto the Azure portal before continuing.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each Image Template this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nIn a web browser, log into the Azure portal and use the link in the Task description (example shown below) to open to the location where the image has been published.\nIn the expanded Packaging Disk Task shown above, click the link to the session host template in the Azure portal. This opens the Microsoft Azure portal to the \nCustom deployment\n template where you can provision Azure RD Session Hosts.\n\n\n\nThe next section explains how to complete the template to provision a session host.\n\n\nProvision a Session Host\n\n\nIn the \nCustom deployment\n  template, enter the information to provision a Azure RD Session Host.\n\n\nNote:\n  All RDSH Session Hosts must be manually restarted before you can add RDS roles to Session Hosts using PowerShell.\n\n\nCheck the Edit Template settings, and adjust as needed.\nComplete the Session Host Parameters shown below, using the host's Fully Qualified Domain Name (FQDN).\nIMPORTANT: You must include the Domain Name (not fully qualified) in the \nAdmin User Name\n field in the format, \nmydom1\\username\n. And, in the Domain Name field, enter the Fully Qualified Domain Name, for example, \nmydom1.local\n.\nSelect the Azure Resource Group.\nSpecify the Resource Group Location.\nIMPORTANT: Be sure that the value for the \nResource group location\n matches the \nStorage account location\n that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will not be deployed and you will have to reattempt deployment.\nReview the legal terms, and if you accept them, click \nCreate\n. This creates a Session Host provisioned with the Layered Image in Azure.\nWhile Azure creates the virtual machine, you can track the progress under Virtual Machines in the hub menu.\n\n\n\nNext Step\n\n\nThe next step is to power off the Session Host, power it back on, and add it to an RDS collection. Please see the \nTechNet Reference\n for details.\n\n\nPublish Layered Images (MCS for Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Nutanix Acropolis, and add each one to a collection, provisioning service, or other method for provisioning your systems.\n\n\nPrerequisites\n\n\nCreate Image Templates (MCS for Nutanix AHV)\nSpecify a script to run when you publish Layered Images (optional)\n \nIf you want the VM to shut down on its own, you can specify a script to run when publishing the Layered Image. For details about enabling and using Scripts, see \nMCS for Nutanix AHV Connector\n Configuration.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each template, this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\n \nUse the information in the expanded Packaging Disk Task shown above to navigate to the location in Nutanix AHV where the Layered Image has been published.\nIn the Prism console, power on the Packaging Machine VM. This enables the Guest OS to run and execute any Layer scripts via Unidesk's kmssetup.cmd functionality.\nYou can use scripts to perform important Layer-specific steps, for example, activating Microsoft Office, which may need to be done before the VM is used to create or update an MCS catalog.\nNote:\n You can execute Layer scripts using Unidesk's kmssetup.cmd functionality, Unidesk's Run-once script support, or even manual execution.\nOnce the VM is in the desired state the VM must be shut down. If you need to shut it down manually, do so now. Otherwise, wait for the script you've configured to do so.\nWhen using the MCS for Nutanix AHV connector, once the VM is shutdown, a snapshot is taken to preserve the state of the VM for use in MCS. The snapshot name is prefixed with \"XD_\" and contains the name of the VM. This is required for the MCS for Nutanix AHV plugin and enables MCS administrators to easily identify the published Layer VM/snapshot. If the job is canceled while the connector is waiting for the VM to shutdown, the VM will \nnot\n be deleted as part of the cleanup, in case you want to keep the VM and perform additional steps to prepare it for MCS.\n\n\n\nNext Step\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nPublish Layered Images (Citrix MCS for vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Citrix MCS in your vSphere environment and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.\n\n\nPrerequisites\n\n\nTo publish a Layered Image to MCS, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates that you want to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each Image Template this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nAt the end of the image creation process:\nUnidesk powers on the VM\n - This will enable the guest OS to run and execute any layer scripts via our kmssetup.cmd functionality. This can be used to perform important layer specific steps like activating Microsoft Office which may need to be done before the VM is used to create a view desktop pool/RDS farm or recompose them. The mechanism used to execute these scripts can vary, including our own kmssetup.cmd functionality, run-once support, or even manual execution. It is expected that once all scripts are run or other manual steps are taken and the VM is in the desired state, a guest OS shutdown will be initiated either by the scripts, or by the user (if using the kmssetup.cmd functionality there will a documented process for initiating a shutdown after all layer scripts and other kmssetup functionality is complete).\nWhen the Task changes to Action Required, shut down the VM and take a snapshot\n - The status then changes to \nDone\n.\nIf you want the VM to shut down on its own, you can specify a script to run when you publish Layered Images\n - For details about enabling and using Scripts, see the instructions for the Horizon \nView Connector\n Configuration.\nWhen the task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task to navigate to the location in your environment where the Layered Image has been published.\n\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nPublish Layered Images (Citrix MCS for XenServer)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Citrix MCS in your XenServer environment and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.\n\n\nPrerequisites\n\n\nTo publish a Layered Image to MCS, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates that you want to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each Image Template this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nAt the end of the image creation process:\nUnidesk powers on the VM\n - This will enable the guest OS to run and execute any layer scripts via our kmssetup.cmd functionality. This can be used to perform important layer specific steps like activating Microsoft Office which may need to be done before the VM is used to create a view desktop pool/RDS farm or recompose them. The mechanism used to execute these scripts can vary, including our own kmssetup.cmd functionality, run-once support, or even manual execution. It is expected that once all scripts are run or other manual steps are taken and the VM is in the desired state, a guest OS shutdown will be initiated either by the scripts, or by the user (if using the kmssetup.cmd functionality there will a documented process for initiating a shutdown after all layer scripts and other kmssetup functionality is complete).\nWhen the Task changes to Action Required, shut down the VM and take a snapshot\n - The status then changes to \nDone\n.\nIf you want the VM to shut down on its own, you can specify a script to run when you publish Layered Images\n - For details about enabling and using Scripts, see the instructions for the \nMCS for XenServer\n Connector Configuration.\nWhen the task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task to navigate to the location in your environment where the Layered Image has been published.\n\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nPublish Layered Images (Citrix PVS)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\nAssign the new vDisk to the targeted devices\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to PVS, and stream them to the systems you want to provision.\n\n\nPrerequisites\n\n\nTo publish a Layered Image, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nTo use an Image Template to publish a Layered Image:\n\n\nLog into the UMC.\nSelect the \nImages\n modules.\nSelect one or more Image Templates, then click \nPublish Layered Image\n.\nOn the Confirm and Complete tab, click the \nPublish Layered Image\n button. This starts a task called, \nPublishing Layered Image\n. When the task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task to navigate to the location in PVS where the Layered Image has been published.\n\n\n\nNext you can assign the new disk to the targeted devices.\n\n\nAssign the new vDisk to the targeted devices\n\n\nLog into the PVS Console.\nAccess the target PVS server. The new vDisk should appear under the targeted PVS store (refresh may be required).\nAssign the new vDisk to the targeted devices.\nUsing Citrix PVS best practices, test the new vDisk to ensure that the image streams to the server as expected.\n\n\n\nPublish Layered Images (XenServer)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to XenServer and add each one to a collection, provisioning service, or other method for provisioning your systems.\n\n\nPrerequisites\n\n\nTo publish a Layered Image, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each template, this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task shown above to navigate to the location in XenServer where the Layered Image has been published.\n\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nPublish Layered Images (Network File Share)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\nNext Step\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to the ELM's Network File Share, copy the Image(s) to your target environment, and use them to provision Session Hosts in your environment. This is especially useful if Unidesk does not yet include Connectors for the platform where you're provisioning systems.\n\n\nPrerequisites\n\n\nTo publish a Layered Image, you need:\n\n\nOne or more Image Templates.\n\n\n\nThe Image Template you select should have the correct OS Layer and any App Layers you want in the Layered Image.\n\n\nPublish a Layered Image\n\n\nTo use an Image Template to publish a Layered Image:\n\n\nIn the Images module, select one or more Image Template that you want to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each Image Template this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task shown above to navigate to the location where the Layered Image has been published.\nIMPORTANT:\n When publishing a Layered Image to a file share, there will be one VMDK file option, and it will generate two files: \nlayer.vmdk\n and \nlayer-flat.vmdk\n. You need to upload both of them.\n\n\n\nNext Step\n\n\nOnce the Layered Image is published to the file share, you can use the image to provision servers in your environment.\n\n\nPublish Layered Images (Nutanix AHV)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Nutanix AHV, and add each one to a collection, provisioning service, or other method for provisioning your systems.\n\n\nPrerequisites\n\n\nCreate Image Templates (Nutanix AHV)\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each template, this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task shown above to navigate to the location in Nutanix AHV where the Layered Image has been published.\nIn the Prism console, power on the Packaging Machine VM. This enables the Guest OS to run and execute any Layer scripts via Unidesk's kmssetup.cmd functionality.\nYou can use scripts to perform important Layer-specific steps, for example, activating Microsoft Office, which may need to be done before the VM is used to create or update an MCS catalog.\nNote:\n You can execute Layer scripts using Unidesk's kmssetup.cmd functionality, Unidesk's Run-once script support, or even manual execution.\nOnce the VM is in the desired state the VM must be shut down. If you need to shut it down manually, do so now. Otherwise, wait for the script you've configured to do so.\n\n\n\nNext Step\n\n\nUse the image to provision Nutanix AHV servers.\n\n\nPublish Layered Images (VMware Horizon View for vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to VMware Horizon View Composer in your vSphere environment, and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.\n\n\nPrerequisites\n\n\nTo publish a Layered Image, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select the Image Template that has the correct OS Layer and App Layers selected for the new Layered Image.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each template, this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment. For each template, this starts a task called, \nPublishing Layered Image\n. When the task completes, the task description provides the information you need to navigate to the image in your environment. At the end of the image creation process:\nWait for Unidesk to power on the VM\n - This will enable the guest OS to run and execute any layer scripts via our kmssetup.cmd functionality.\nNote:\n This can be used to perform important layer-specific steps like activating Microsoft Office which may need to be done before the VM is used to create a View desktop pool/RDS farm or recompose them. The mechanism used to execute these scripts can vary, including our own kmssetup.cmd functionality, run-once support, or even manual execution. It is expected that once all scripts are run or other manual steps are taken and the VM is in the desired state, a guest OS shutdown will be initiated either by the scripts, or by the user (if using the kmssetup.cmd functionality there will a documented process for initiating a shutdown after all Layer scripts and other kmssetup functionality is complete).\nActivate the VM\n - Activate the machine so that Horizon View accepts it.\nWhen the Task changes to Action Required, shut down the VM and take a snapshot\n - The status then changes to \nDone\n.\nIf you want the VM to shut down on its own, you can specify a script to run when you publish Layered Images. For details about enabling and using Scripts, see the instructions for the Horizon \nView Connector\n Configuration.\nWhen the task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task shown above to navigate to the location in vSphere where the Layered Image has been published.\n\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nPublish Layered Images (vSphere)\n\n\nIn this article:\n\n\nPrerequisites\nPublish a Layered Image\n\n\n\nA Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to vSphere and add each one to a collection, provisioning service, or other method for provisioning your systems.\n\n\nPrerequisites\n\n\nTo publish a Layered Image, you need:\n\n\nOne or more Image Templates.\n\n\n\nPublish a Layered Image\n\n\nIn the Images module, select one or more Image Templates to publish.\nFrom the Action menu, select \nPublish Layered Image\n.\nOn the Confirm and Complete page, select \nPublish Layered Images\n. For each template, this starts a task called, \nPublishing Layered Image\n. When each task completes, the task description provides the information you need to navigate to the image in your environment.\nUse the information in the expanded Packaging Disk Task shown above to navigate to the location in vSphere where the Layered Image has been published.\n\n\n\nNext you can move the image to a collection or other location for provisioning servers.\n\n\nManage Image Templates\n\n\nThis article contains:\n\n\nUpdate Image Templates with a new Layer Version\nEdit any Image Template setting\nDelete an Image Template\n\n\n\nWhen you create new Layers and new Versions to them, you can edit the layer selection in your Image Templates, and use the templates to publish new versions of your Layered Images.\n\n\nOnce created, a Layered Image is no longer associated with the template used to create it. This means that you can change or delete a template without affecting any previously published Layered Images.\n\n\nUpdate Image Templates with a new Layer Version\n\n\nWhen you add a new Version to an App Layer or an OS Layer, you can quickly identify the Image Templates that include the Layer, and select which templates to update with the new Version.\n\n\nIn the Unidesk Management Console (UMC), select \nLayers > App Layers\n or \nLayers > OS Layers\n.\nSelect the Layer you updated, and click \nUpdate Assignments\n.\nIn the wizard that opens, select the new Version of the Layer that you want to assign. The Image Template Assignment tab lists the Image Templates that include the Layer but are not yet assigned the new Version.\nOn the Image Template Assignment tab, select the Image Templates to which you want to assign the Layer or Layer Version.\nNotes:\n \nIf the list is empty, click the check box called, \nShow Image Templates already at this version\n. A list of grayed out names may appear. These templates have already been assigned the Version.\nYou can use the \nSearch\n field to filter this list by Layer or Version. If you search on part of a Layer name or Version, any entry that contains the search string is displayed.\nSkip the Elastic Assignment tab.\nOn the Confirm and Complete tab, verify your choices and click \nUpdate Assignments\n.\n\n\n\nEdit any Image Template setting\n\n\nWhen you want to change the settings that you use to publish any of your Layered Images, you can edit the Image Template you originally used to publish the Layered Image(s) and publish a new version of the Image(s).\n\n\nIn the Unidesk Management Console (UMC), select the \nImages\n module.\nSelect the template you want to edit, and click \nEdit Template\n. This opens the Edit Template wizard.\nOn the Name and Description tab, you can change the Name, Description, and Icon for the Image.\nOn the OS Layer tab, you can select a different Version of your chosen \nOS Layer\n by expanding the Layer and choosing a different one.\nOn the App Assignment tab, you can add or remove App Layers to include in the Layered Images that you publish using this template. If there is more than one Version of a Layer, you can choose a different version by expanding the Layer and choosing a different one.\nOn the Connector tab, you can change the location to which the Layered Image is published by selecting a different Connector Configuration.\nOn the Platform Layer tab, you can change the selected Platform Layer, if for example, you are publishing to a different environment.\nOn the Layered Image Disk tab, you can edit the Layered Image Disk details, for example, to enable Elastic Layering on the image.\nIn the Confirm and Complete tab, enter any comments you would like for this layer, and click \nEdit Template\n.\n\n\n\nDelete an Image Template\n\n\nWhen you no longer need an Image Template, you can remove it from the Unidesk Management Console (UMC).\n\n\nIn the UMC, select the \nImages\n module.\nSelect the template you want to delete, and click \nDelete Template\n. This opens the Delete Template wizard.\nIn the Confirm and Complete tab, enter any comments you would like, and click \nDelete Template\n.\n\n\n\nConnector essentials\n\n\nIn this article:\n\n\nWhat are Connectors?\n\n\nWhat are Connector Configurations?\n\n\nWhat Connector Configurations do I need?\n\n\nHow and when to add a new Connector Configuration\n\n\nWhat are Connectors?\n\n\nConnectors are the interfaces to environments where layers are created and images are published. The type of platform connector determines the information required to create a specific Connector Configuration.\n\n\nWhat are Connector Configurations?\n\n\nA Connector Configuration is a stored set of values for connecting to a storage location in your environment. A configuration typically includes credentials for authentication, a storage location, and any other information required to interface with the environment where you will be creating layers or publishing images. You can create multiple Connector Configurations, each configured to access a unique location in your environment.\n\n\nWhat Connector Configurations do I need?\n\n\nConnector Configurations for importing an OS to create an OS Layer\n\n\nWhen you create an OS Layer, you need a Connector Configuration to give Unidesk access to the location of the OS image that you want to use for your OS Layer.\n\n\nConnector Configurations for creating and updating App Layers, and adding Versions to OS Layers\n\n\nWhen creating or updating an App Layer, or adding Versions to an OS Layer, you need a Connector Configuration for the location in your environment where you will package the Layer. You can create as many configurations as you need, for example, if you have more than one storage location in the environment.\n\n\nConnector Configurations for publishing Layered Images\n\n\nPublishing Layered Images will require different Connector Configurations than the ones you use for creating Layers, if, for example, you publish Layered Images to a variety of storage locations near the users being served. For example, you can prepare your Layers for a server farm in vSphere, and publish Layered Images to Citrix PVS for streaming to servers in vSphere. Or, you can publish Layered Images to more than one storage location in the same environment, each requiring a different Connector Configuration. Each location is likely to require different credentials.\n\n\nHow and when to add a new Connector Configuration\n\n\nIf this is your first time using Unidesk, you will need to add one or more Connector Configurations in the process of adding Layers and publishing Layered Images. In the Unidesk Management Console, the wizards for Creating Layers, Adding Versions, and Publishing Layered Images each include a page for selecting and creating Connector Configurations. For details, click \nAdd a Connector Configuration\n. and select a platform.\n\n\nAdd a new Connector Configuration\n\n\nWhat platform are you using this Connector Configuration to connect to?\n\n\nConnector Configuration ; Optional Script (MCS for Nutanix AHV)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nAn \nMCS for Nutanix AHV (Acropolis) Connector Configuration\n  contains the credentials and storage location Unidesk needs to publish Layered Images to MCS in your Nutanix AHV environment. This connector does not support Layer creation.\n\n\nBefore you start\n\n\nYou can use MCS for Nutanix AHV to publish Layered Images. Each Connector Configuration accesses a specific storage location in your Nutanix AHV environment to which you can publish Layered Images.\n\n\nYou may need more than one Nutanix AHV Connector Configuration to access the correct location for each purpose. Further, you may want to publish each Layered Image to a location convenient to the systems you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see \nAbout Connectors\n.\n\n\nIf this is your first time using Unidesk\n\n\nWhen publishing Layered Images to Nutanix AHV, you will need at least one Connector Configuration for each storage location you plan to publish to. You can add Connector Configurations when creating an Image Template from which you will publish Layered Images. If you don't yet have the right Connector Configuration for the task, you can create one by clicking \nNew\n  on the Connector wizard tab (see details below).\n\n\nRequired information for Nutanix AHV Connector Configuration settings\n\n\nThe Nutanix AHV Connector Configuration wizard let's you browse for the Nutanix AHV Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object in Nutanix AHV, or the validation will fail.\n\n\nConnector Name\n - A useful name to help identify and keep track of this connector configuration.\nPrism Address\n - The host name (resolvable via DNS) or IP address of the Prism Web Console. This is the same address you use to access the Nutanix Prism Web Console..\nUser Name/Password\n - Credentials that will be used when interacting with the Nutanix system. The specified user must have sufficient privileges for the following operations:\nVM operations:\nclone\ndelete\npower on/off\nattach virtual disks\nImage operations:\ncreate\nupdate (aka upload)\ndelete\nVirtual disks:\ncreate\nattach to VMs\nAllow Certificate Errors\n - Lets you use SSL encryption for the API connection traffic between the Unidesk Connector and Nutanix AHV. This field is unchecked by default.\nTemplate\n - This is a drop down list of existing virtual machines that can be used for cloning. There is no concept of a \"template\" in Nutanix, so these VMs are actual VMs. The selected template must \nnot\n have any disks attached, and must have at least one network card attached. If it does not, you will see an error when trying to validate or save the configuration.\nStorage Container\n - Lets you select the storage container for the images (vhds) that will get uploaded and the resulting virtual disks that will get created from those images. When creating App Layers and OS Layer versions, we are required to mount the storage container as an NFS mount point. This means that the selected storage container MUST have the ELM included in a white list of clients that are allowed to mount the storage container via NFS. The white list configuration must be done through the Nutanix product (either their web console or through their CLI tools). If the ELM is not properly white listed for the selected storage container, then the validation phase will fail, and the error will be indicated with the storage container selection.\n\n\n\nHow Virtual Machines are Organized\n\n\nNutanix does not provide a mechanism for organizing virtual machines. Because of this, it may be difficult to find the virtual machines created by your Unidesk ELM when the total number of virtual machines is large. To help you find these VMs, the following naming conventions are used:\n\n\nPackaging Machines\n (virtual machines created during the process of creating an App Layer or OS Version)\nThe virtual machine name will start with the layer name that is being created/modified\nThe virtual machine names will end with the following text: (Unidesk Packaging Machine)\nLayered Image Virtual Machines\n (virtual machines created as a result of publishing a Layered Image)\nThe virtual machine name will start with the image name that was published\nThe virtual machine name will end with the following text: (Unidesk Published Image)\n\n\n\nWhen viewing virtual machines through the Nutanix web console, you can search for virtual machines by filtering on:\n\n\n\"Unidesk\" to find all virtual machines created by Unidesk\n\"Unidesk Packaging Machine\" to find all virtual machines created for Layer management jobs.\n\"Unidesk Layered Image\" to find all virtual machines created to publish a Layered Image.\nImage name or Layer name to find virtual machines related to a specific Layered Image publishing job or App or OS creation.\n\n\n\nVirtual Machine Network Connectivity\n\n\nThe virtual network settings of the source template specified in the Nutanix AHV Connector Configuration will be carried over when creating any VMs through the Nutanix Acropolis Hypervisor (AHV) Connector. There is no option in the Connector Configuration UI to override the network settings.\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three Connector fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually, click to put the cursor in the field and type the value, making sure that the case matches the value in Nutanix AHV.\nTo select a value from a drop-down list, click once to put the cursor in the field, and a second time to display the list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nNutanix AHV Address\n, \nUser Name\n, and \nPassword\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the Nutanix AHV Configuration fields. The Virtual Machine Clone Settings field is then enabled.\nSelect the Virtual Machine Template.\nSelect the Storage Repository and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script to run on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image.\n\n\nSome preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published Layered Image in Nutanix AHV.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The Nutanix AHV connector logs will contain the output of the executed script.\n\n\nConfigure a Script (optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nCommon\nCommon\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nCommon\nCommon\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nCommon\nCommon\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows7 64-bit\nWindows2008 64-bit\nWindows2012 64-bit\nWindows10\nWindows1064\nvirtualInfrastructureServer\nCommon\nNutanix AHV\nThe Nutanix AHV (Prism Server) specified in the connector configuraiton.\nvmId\nCommon\nNutanix AHV\nThe virtual machine UUID (same as vmUuid).\nvmName\nCommon\nNutanix AHV\nThe name of the virtual machine that was created.\nvmNetwork\nCommon\nNutanix AHV\nThe name of the virtual network that the main NIC of the virtual machine is connected to.\nvmNetworkId\nCommon\nNutanix AHV\nThe UUID of the virtual network that the main NIC of the virtual machine is connected to.\nvmNetworkMAC\nCommon\nNutanix AHV\nThe MAC address of the main NIC that is connected to the virtual network specified in vmNetwork and vmNetworkId.\nvmUuid\nCommon\nNutanix AHV\nThe virtual machine UUID (same as vmId).\n\n\n\nDefinition Scope\n\n\nDefines whether the \nscripts\n  variable is set for all Connector types or whether it is specific to a particular Connector type.\n\n\nValue Source\n\n\nDefines whether the variable value is determined by common code or by Connector-specific code.\n\n\nConnector Configuration ; Optional Script (Citrix MCS for vSphere)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nCitrix MCS for vSphere Connector Configuration\n  contains the credentials and storage location Unidesk needs to publish Layered Images to MCS in your vSphere environment.\n\n\nYou can publish Layered Images to MCS running in a vSphere environment using a Citrix MCS for vSphere Connector Configuration. In the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.\n\n\nEach Connector Configuration is set to publish Layered Images to a specific storage location in your MCS environment, so you may need more than one MCS Connector Configuration if publishing to multiple locations. Further, you may want to publish each Layered Image to a location convenient to the system you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see Connector essentials.\n\n\nNotes:\n \n\n\nThis Connector Configuration is for publishing Layered Images. You cannot package Layers in the MCS environment.\nPersonal vDisks are \nnot\n supported for Citrix MCS. The published desktop images will be non-persistent. Currently, vDisks can only be used when publishing to Citrix PVS.\n\n\n\nBefore you start\n\n\nThe first time you create an Image Template for publishing Layered Images to a location in your MCS environment, you will create a Connector Configuration for that location.\n\n\nRequired information for this Connector Configuration\n\n\nThe Citrix MCS for vSphere Connector Configuration wizard let's you browse for the vCenter Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object your environment, or the validation will fail.\n\n\nName\n - A useful name to help identify and keep track of this connector configuration.\nvCenter Server\n - The name of the vSphere server with which the Unidesk ELM will integrate.\nvCenter User Name\n - The user name of the account that the Unidesk ELM will use to connect to vSphere.\nvCenter Password\n - The password of the account that the Unidesk ELM will use to connect to vSphere.\nDataCenter Name\n - The name of the vSphere DataCenter in which the Unidesk ELM will create and retrieve virtual machines.\nVirtual Machine Template (recommended)\n - The virtual machine to use as a template for cloning. Use the template to create a VM with the settings for your MCS catalog, including memory, CPUs and video settings. You can specify the host, datastore and network for configuring the resulting VMs. The VM must \nnot\n have any connected disks.\nDataStore Name\n - The name of the vSphere DataStore in which the Unidesk ELM will create and retrieve virtual machines.\nESX Host Name\n - The name of the vSphere ESX Host on which the Unidesk ELM will create and retrieve virtual machines.\nNetwork Name\n - The name of the vSphere Network in which the Unidesk ELM will create and retrieve virtual machines.\nVirtual Machine Folder Name\n - The name of the vSphere Folder in which the Unidesk ELM will create and retrieve virtual machines.\n\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three vCenter fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually: Click to put the cursor in the field and type the value.\nTo select a value from a drop-down list: Click once to put the cursor in the field, and a second time to choose from a list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nvCenter Server\n, \nvCenter User Name\n, and \nvCenter Password\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the vCenter fields. The DataCenter field is then enabled with a list of DataCenters available.\nSelect the DataCenter, and the remaining dropdowns will be enabled.\n(Recommended) Select a virtual machine to use as the template. Although a VM Template is optional, it is strongly recommended. .\nComplete the remaining fields and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image. Some preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published layered image in vSphere.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The vSphere connector logs will contain the output of the executed script.\n\n\nConfigure a Script (Remember, this is optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows8\nWindows864\nWindows200864\nWindows201264\nWindows10\nWindows1064\nvirtualInfrastructureServer\nAll\nvSphere connector code\nThe vCenter server specified in the connector configuration.\nvmName\nAll\nvSphere connector code\nThe name of the virtual machine that was created.\nvmId\nAll\nvSphere connector code\nThe virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\")\nvmUuid\nAll\nvSphere connector code\nThe virtual machine UUID as set by the underlying highbrd.\n\n\n\nUser Impersonation\n\n\nThe Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.\n\n\nScript Execution Policy\n\n\nScript execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.\n\n\nConnector Configuration ; Optional Script (MCS for XenServer)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nAn \nMCS for XenServer Connector Configuration\n  contains the credentials and storage location Unidesk needs to publish Layered Images to MCS in your XenServer environment.\n\n\nYou can publish Layered Images to MCS running in a XenServer environment using an MCS for XenServer Connector Configuration. In the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.\n\n\nEach Connector Configuration is set to publish Layered Images to a specific storage location in your environment, so you may need more than one MCS Connector Configuration if publishing to multiple locations. Further, you may want to publish each Layered Image to a location convenient to the system you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see Connector essentials.\n\n\nNotes:\n \n\n\nThis Connector Configuration is for publishing Layered Images. You cannot package Layers in the MCS environment. For packaging Layers, use a XenServer Connector Configuration.\nPersonal vDisks are \nnot\n supported for MCS. The published desktop images will be non-persistent. Currently, vDisks can only be used when publishing to Citrix PVS.\n\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nCitrix XenServer Connector Configuration\n  contains the credentials and storage location Unidesk needs to connect to Citrix XenServer.\n\n\nBefore you start\n\n\nYou can use your XenServer environment for creating Layers, and for publishing Layered Images. Each Connector Configuration accesses a specific storage location in your XenServer environment. You may need more than one XenServer Connector Configuration to access the correct location for each purpose. Further, you may want to publish each Layered Image to a location convenient to the system you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see \nAbout Connectors\n.\n\n\nSince XenServer uses a pod-like architecture where you, the administrator, interact with individual servers or clusters of servers, rather than with a central management server, you manage these pods via command line access or GUI management software like XenCenter, which you install directly on your desktop and connect individually to each standalone host or to clusters of hosts.\n\n\nIf this is your first time using Unidesk\n\n\nIf this is your first time using Unidesk and you want to create Unidesk Layers using a XenServer VM, you will need a XenServer Connector within Unidesk. When publishing Layered Images to XenServer, you will need a Connector Configuration for each of your publishing locations as well.\n\n\nThe Create Layer and Publish Layered Image wizards each ask you to select a Connector Configuration. If you don't yet have the right Connector Configuration for the task, you can create one by clicking \nNew\n  on the Connector wizard tab (details below).\n\n\nRequired information for XenServer Connector Configuration settings\n\n\nThe XenServer Connector Configuration wizard let's you browse for the XenCenter Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object in XenServer, or the validation will fail.\n\n\nConfiguration Name\n - A useful name to help identify and keep track of this connector configuration.\nXenServer Address\n - The name of the XenServer host with which the Unidesk ELM will integrate.\nUser Name/Password\n - The credentials for the account that the Unidesk ELM will use to connect to XenServer.\nUse Secured Protocol\n - Lets you use SSL encryption for the API connection traffic between the Unidesk Connector and Citrix XenServer. This field is checked by default.\nAllow Certificate Errors\n - Enables certificate errors to be ignored. By default, this setting is disabled.\nTemplate\n - VM Template that can be used for cloning. The list of choices will only contain custom VM templates, rather than actual VMs or any of the built-in templates. The selected template must \nnot\n have any disks attached, and must have at least one network card attached. If it does not, you will see an error when trying to validate or save the configuration.\nStorage Repository\n - The storage repository for the disk that will get uploaded. The list will be filtered to only show repositories that can contain VHDs (ISO repositories are filtered out).\nUse HTTPS for File Transfers\n - Encrypts the image file transfers. HTTPS is checked by default for more secure uploads and downloads, but can be unchecked for increased performance.\n\n\n\nVirtual Machine organization\n\n\nXenServer allows for VMs to be organized either by folder or by tag. These organizational tools are optional when creating and managing VMs through XenCenter or other tools. Although XenServer Connector Configurations do \nnot\n  allow the administrator to specify folders or tags, the VMs created by the XenServer Connector, both Packaging Machines and published Layered Images, can utilize both organizational tools.\n\n\nTags\n\n\nIf the template specified in the XenServer connector configuration has any tags, then those tags will be carried over to any VM cloned from that template. Therefore all packaging VMs or published layered images will be tagged with the same tags that the template has. Additionally, the XenServer connector will add three tags.\n\n\nUnidesk\n - All VMs created by the XenServer connector can be found by this tag regardless of their purpose or image.\nPurpose Tag\n - All packaging machines will be tagged with \"Unidesk Packaging Machine\" while all published layered image VMs will be tagged with \"Unidesk Published Images\".\nImage/Layer Name\n - All packaging machines will be tagged with the layer name for the layer which they are generated, while all published layered images will be tagged with the template image name.\n\n\n\nIf you are using XenCenter, you can view your VMs by tag by selecting the \"Organization Views\" and then select \"By Tag\".\n\n\nFolder\n\n\nBy default VMs created by the XenServer Connector will not be placed in a folder. However, if the template specified in the XenServer Connector Configuration resides in a folder, then any VM that the Connector creates from that template will also reside in the same folder. All packaging VMs and published Layered Images will be placed in that same folder. There will \nnot\n  be separate subfolders for packaging VMs or published Layered Iimages.\n\n\nMachine network connectivity\n\n\nThe virtual network settings of the source template specified in the XenServer Connector Configuration will be carried over when creating any VMs through the XenServer Connector. There is no option in the Connector Configuration UI to override the network settings.\n\n\nXenServer Clusters\n\n\nThe XenServer Connector does \nnot\n  yet work correctly with XenServer clusters. If the host specified in the configuration is part of a cluster, then it must be the master host in the cluster for the connector to work. However, this means that any time the master XenServer host goes down and a new master is elected, the XenServer configuration must be updated.\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three Connector fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually, click to put the cursor in the field and type the value, making sure that the case matches the value in Xen.\nTo select a value from a drop-down list, click once to put the cursor in the field, and a second time to display the list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nXenServer Address\n, \nUser Name\n, and \nPassword\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the XenServer Configuration fields. The Virtual Machine Clone Settings field is then enabled.\nSelect the Virtual Machine Template.\nSelect the Storage Repository and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script to run on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image.\n\n\nSome preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published Layered Image in XenServer.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The XenServer connector logs will contain the output of the executed script.\n\n\nConfigure a Script (optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows200864\nWindows201264\nWindows10\nWindows1064\nvirtualInfrastructureServer\nAll\nXenServer connector code\nThe XenServer host specified in the connector configuration.\nvmName\nAll\nXenServer connector code\nThe name of the virtual machine that was created.\nvmId\nAll\nXenServer connector code\nThe virtual machine UUID (same as vmUuid)\nvmUuid\nAll\nXenServer connector code\nThe virtual machine UUID (same as vmId)\n\n\n\nDefinition Scope\n\n\nWhether the scripts variable is set for all platform connector types or whether it is specific to a particular connector type.\n\n\nValue Source\n\n\nWhether the variable value is determined by common code or by platform connector specific code.\n\n\nConnector Configuration ; Optional Script (PVS)\n\n\nIn this article:\n\n\nBefore you start\nCreate a new Connector Configuration for PVS\nScript Configuration (Optional, Advanced feature)\n\n\n\nA PVS Connector Configuration contains the credentials and storage location Unidesk needs to connect to PVS, and it identifies the properties to be associated with the vDisk.\n\n\nEach Connector Configuration is set up to access a storage location via a specific account. For more about Connectors and Connector Configurations, see \nAbout Connectors and Connector Configurations\n.\n\n\nBefore you start\n\n\nThe first time you create an Image Template for publishing Layered Images to your PVS environment, add a PVS Connector Configuration for that PVS location.\n\n\nPVS requirements\n\n\nPVS services must be running as a domain account\n\n\nFor Unidesk to work correctly with PVS, the PVS services must be running as a \ndomain account\n . This is because domain accounts have permissions to access the PVS store and the local system account does not.\n\n\nIf your PVS server is configured to use the local system account, which is the default setting, you can change the account by running the PVS configuration tool. This tool gives you an option to run as \nlocal system\n  or use a \ndomain account\n . Choose a \ndomain account\n .\n\n\nPVS server and account information\n\n\nFor Unidesk to access the location in your PVS environment where you want to publish a Layered Image, you need to supply the credentials and location in a PVS Connector Configuration.\n\n\nThe information you need for the PVS Connector Configuration includes.\n\n\nName\n - A useful name to help identify and keep track of this connector configuration.\nConsole\n - The name of the PVS server on which the Undesk agent is deployed. This is the server to which the vDisk will be published.\nDomain User\n - User name of a domain account that has permission to manage PVS. This account will be used by the agent to run PVS Powershell commands. This account \nmust\n have \nRead/Write\n access to the PVS store for writing the published vDisk.\nPassword\n - Password for the domain user account.\nSite Name\n - Name of the Site this vDisk is to be a member of.\nStore Name\n - Name of the Store that this vDisk is a member of.\nWrite Cache\n - When a new Disk is being created, this value sets the Write Cache type of the new Disk. Possible values include:\nCache on Server\nCache on Server, Persistent\nCache in Device RAM\nCache in Device RAM with Overflow on Hard Disk\nCache on Device Hard Drive\nWhen choosing a \nWrite Cache\n option, consult your \nPVS documentation\n to ensure that the PVS Servers and target devices that use this vDisk are properly configured for the type you select.\nLicense Mode\n - Sets the Windows License Mode to:\nKMS - Key Management Service\nMAK - Multiple Activation Keys\nNone\nEnable Active Directory machine account password management\n - Enables Active Directory (AD) password management. The default value is \nEnabled\n.\nEnable Load Balancing\n - Enables load balancing. for the streaming of the vDisk\nEnable Printer Management\n - When enabled, invalid printers will be deleted from the Device.\n\n\n\nCreate a new Connector Configuration for PVS\n\n\nIf you don't yet have a Connector Configuration that includes the PVS server information and credentials for the server where the Layered Image will be published, add one now.\n\n\nTo add a new Connector Configuration:\n\n\nIn the Publish Layered Image wizard, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are publishing the Layered Image. Then click \nNew\n to open the Connector Configuration page.\nComplete the fields on the Connector Configuration page. For guidance, see the above field definitions.\nClick the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSAVE\n. The new Connector Configuration should now be listed on the Connector tab.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script on any Windows machine running a Unidesk Agentthe same agent used on the PVS server. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image. Some preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published layered image in PVS.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The PVS connector logs will contain the output of the executed script.\n\n\nConfigure a Script (Remember, this is optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows200864\nWindows201264\nWindows10\nWindows1064\ndiskLocatorId\nAll\nPVS\nThe internal id for the vDisk.\n\n\n\nUser Impersonation\n\n\nThe Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.\n\n\nScript Execution Policy\n\n\nScript execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.\n\n\nConnector Configuration ; Optional Script (Citrix XenServer)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nCitrix XenServer Connector Configuration\n  contains the credentials and storage location Unidesk needs to connect to Citrix XenServer.\n\n\nBefore you start\n\n\nYou can use your XenServer environment for creating Layers, and for publishing Layered Images. Each Connector Configuration accesses a specific storage location in your XenServer environment. You may need more than one XenServer Connector Configuration to access the correct location for each purpose. Further, you may want to publish each Layered Image to a location convenient to the system you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see \nAbout Connectors\n.\n\n\nSince XenServer uses a pod-like architecture where you, the administrator, interact with individual servers or clusters of servers, rather than with a central management server, you manage these pods via command line access or GUI management software like XenCenter which you install directly on your desktop and connect individually to each standalone host or to clusters of hosts.\n\n\nIf this is your first time using Unidesk\n\n\nIf this is your first time using Unidesk and you want to create Unidesk Layers using a XenServer VM, you will need a XenServer Connector within Unidesk. When publishing Layered Images to XenServer, you will need a Connector Configuration for each of your publishing locations as well.\n\n\nThe Create Layer and Publish Layered Image wizards each ask you to select a Connector Configuration. If you don't yet have the right Connector Configuration for the task, you can create one by clicking \nNew\n  on the Connector wizard tab (see details below).\n\n\nRequired information for XenServer Connector Configuration settings\n\n\nThe XenServer Connector Configuration wizard let's you browse for the XenCenter Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object in XenServer, or the validation will fail.\n\n\nConfiguration Name\n - A useful name to help identify and keep track of this connector configuration.\nXenServer Address\n - The name of the XenServer host with which the Unidesk ELM will integrate.\nUser Name/Password\n - The credentials for the account that the Unidesk ELM will use to connect to XenServer.\nUse Secured Protocol\n - Lets you use SSL encryption for the API connection traffic between the Unidesk Connector and Citrix XenServer. This field is checked by default.\nAllow Certificate Errors\n - Enables certificate errors to be ignored. By default, this setting is disabled.\nTemplate\n - VM Template that can be used for cloning. The list of choices will only contain custom VM templates, rather than actual VMs or any of the built-in templates. The selected template must \nnot\n have any disks attached, and must have at least one network card attached. If it does not, you will see an error when trying to validate or save the configuration.\nStorage Repository\n - The storage repository for the disk that will get uploaded. The list will be filtered to only show repositories that can contain VHDs (ISO repositories are filtered out).\nUse HTTPS for File Transfers\n - Encrypts the image file transfers. HTTPS is checked by default for more secure uploads and downloads, but can be unchecked for increased performance.\n\n\n\nVirtual Machine organization\n\n\nXenServer allows for VMs to be organized either by folder or by tag. These organizational tools are optional when creating and managing VMs through XenCenter or other tools. Although XenServer Connector Configurations do \nnot\n  allow the administrator to specify folders or tags, the VMs created by the XenServer Connector, both Packaging Machines and published Layered Images, can utilize both organizational tools.\n\n\nTags\n\n\nIf the template specified in the XenServer connector configuration has any tags, then those tags will be carried over to any VM cloned from that template. Therefore all packaging VMs or published layered images will be tagged with the same tags that the template has. Additionally, the XenServer connector will add three tags.\n\n\nUnidesk\n - All VMs created by the XenServer connector can be found by this tag regardless of their purpose or image.\nPurpose Tag\n - All packaging machines will be tagged with \"Unidesk Packaging Machine\" while all published layered image VMs will be tagged with \"Unidesk Published Images\".\nImage/Layer Name\n - All packaging machines will be tagged with the layer name for the layer which they are generated, while all published layered images will be tagged with the template image name.\n\n\n\nIf you are using XenCenter, you can view your VMs by tag by selecting the \"Organization Views\" and then select \"By Tag\".\n\n\nFolder\n\n\nBy default VMs created by the XenServer Connector will not be placed in a folder. However, if the template specified in the XenServer Connector Configuration resides in a folder, then any VM that the Connector creates from that template will also reside in the same folder. All packaging VMs and published Layered Images will be placed in that same folder. There will \nnot\n  be separate subfolders for packaging VMs or published Layered Iimages.\n\n\nMachine network connectivity\n\n\nThe virtual network settings of the source template specified in the XenServer Connector Configuration will be carried over when creating any VMs through the XenServer Connector. There is no option in the Connector Configuration UI to override the network settings.\n\n\nXenServer Clusters\n\n\nThe XenServer Connector does \nnot\n  yet work correctly with XenServer clusters. If the host specified in the configuration is part of a cluster, then it must be the master host in the cluster for the connector to work. However, this means that any time the master XenServer host goes down and a new master is elected, the XenServer configuration must be updated.\n\n\nScripts\n\n\nThe XenServer Connector supports script execution after publishing layered images just as the vSphere connectors do. The following script variables will be set:\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three Connector fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually, click to put the cursor in the field and type the value, making sure that the case matches the value in Xen.\nTo select a value from a drop-down list, click once to put the cursor in the field, and a second time to display the list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nXenServer Address\n, \nUser Name\n, and \nPassword\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the XenServer Configuration fields. The Virtual Machine Clone Settings field is then enabled.\nSelect the Virtual Machine Template.\nSelect the Storage Repository and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script to run on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image.\n\n\nSome preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published Layered Image in XenServer.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The XenServer connector logs will contain the output of the executed script.\n\n\nConfigure a Script (optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows200864\nWindows201264\nWindows10\nWindows1064\nvirtualInfrastructureServer\nAll\nXenServer connector code\nThe XenServer host specified in the connector configuration.\nvmName\nAll\nXenServer connector code\nThe name of the virtual machine that was created.\nvmId\nAll\nXenServer connector code\nThe virtual machine UUID (same as vmUuid)\nvmUuid\nAll\nXenServer connector code\nThe virtual machine UUID (same as vmId)\n\n\n\nDefinition Scope\n\n\nWhether the scripts variable is set for all platform connector types or whether it is specific to a particular connector type.\n\n\nValue Source\n\n\nWhether the variable value is determined by common code or by platform connector specific code.\n\n\nAzure Connector Configuration\n\n\nThis article contains:\n\n\nWhen to add a Connector Configuration for Azure\n\n\nAzure information required\n\n\nAdd a Connector Configuration\n\n\nA Connector Configuration contains the credentials and location information that Unidesk needs to access a specific location in Azure. For example, your organization may have one Azure account and several storage locations, and you will need a Connector Configuration so Unidesk can access each storage locations. For more about Connectors and Connector Configurations, see \nConnectors and Connector Configurations\n.\n\n\nWhen to add a Connector Configuration for Azure\n\n\nWhen you create your first Layers, and later when you publish Layered Images for the first time you will add a Connector Configuration for each task, as described below.\n\n\nAzure information required\n\n\nYour organization may have several Azure subscriptions. For Unidesk to access your Azure RD Session Host account, whether it's to download an OS Image or to publish a Layered Image, you must run this tool for each Azure subscription that you want to connect to via Unidesk. You can use the Unidesk Credentials Setup Tool to set up credentials for the Unidesk ELM, and later retrieve, the credentials you set up.\n\n\nName\n - A name you enter for a new Connector Configuration.\nSubscription ID\n - In order to deploy Azure virtual machines, your organization must have an account and credentials, including a subscription ID.\nTenant ID\n - This is a GUID that identifies your organization's dedicated instance of Azure AD.\nClient ID\n - The identifier for one of potentially many Azure accounts that your organization has.\nClient Secret\n - The password you want to use for the Client ID specified. If you already have a forgotten it, you can create a new one.\nStorage Account Name\n - The Azure storage account you want to use when storing Azure virtual machine disks. This name must adhere to Azure storage account naming restrictions. For example, the storage account name cannot contain uppercase characters.\nYou must either create a storage account through the portal or use an existing storage account that fits the following criteria. The account:\nCannot be a \nclassic\n storage account.\nShould be a separate storage account from the one used for the Unidesk ELM. This new storage account will be used during Layer creation and Layered Image publishing.\nMust be in the Azure location where you will deploy VMs.\nMust be one of the following types:\nStandard\n Locally Redundant storage (LRS)\nStandard\n Geo-Redundant storage (GRS)\nStandard\n Read-Access Geo-Redundant storage (RAGRS)\nCan be located in any resource group, as long as the resource group's location is the same as the account's location.\n\n\n\nTool for retrieving information from Azure\n\n\nThe Azure Credentials Tool is a PowerShell script that grants the Unidesk appliance restricted access to your Azure subscription so that Unidesk can retrieve the information required to create a new Azure Connector Configuration. When you run the tool, it prompts you for your Azure Login credentials, then sets up the credentials required for Unidesk to gain restricted access to your Azure subscription.\n\n\nRequirements for running the Azure Credentials Tool\n\n\nA system with access to Azure and running the following software:\nWindows Server 2008, or later\nWindows Powershell 2.0, or later (This ships with Windows Server 2008 and later.)\nStorage Account in Azure\nLogin credentials for a \nGlobal Admin\n or \nService Admin\n in the Azure Active Directory Tenant associated with your subscription. In Azure, you can manage Active Directory \nhere\n.\nAn Azure AD tenant can be associated with many subscriptions, but each subscription can only have one tenant. If you are not sure which tenant is associated with which subscription, you can find out by clicking \nSubscriptions\n on the top of the old portal, and filtering by the directories listed until your subscription is listed as a check box under \nFilter by Subscriptions\n.\n\n\n\nCreate a new storage account in Azure, if you don't have one for this purpose\n\n\nIn a web browser, navigate to the \nMicrosoft Azure portal\n and log in.\nOn the sidebar, select \nStorage accounts\n or \nBrowser > Storage accounts\n. Do \nnot\n select Storage accounts (classic).\nSelect \nAdd\n in the top-left corner of the window that opens.\nIn the form that appears, select the options you need, making sure that the new storage location fits the same criteria for using any existing storage account.\n\n\n\nRetrieve information for a \nnew\n  Azure Connector Configuration\n\n\nHere's how to set up your Azure credentials in the Connector Configuration wizard. It explains how to run the Azure for each Azure subscription that you want Unidesk to access.\n\n\nOn a Windows Server 2008 (or later version) machine, download and run the Unidesk Azure Credentials Tool from the \nUnidesk 4 Downloads\n page.\nFollow the directions in the command prompt to select a subscription and choose a Client Secret.\nWhen the tool is complete, it will display the fields below. These should be entered into the configuration.\nEnter the Client Secret that you chose while running the tool.\nIf you did not enter a Client Secret, it has already been set up using this tool and you should use the one that was entered previously.\n\n\n\nNote:\n  you will have to enter a new Client Secret each time you use a new subscription that has a new Tenant ID. This is because client secrets are logically associated with Azure tenants.\n\n\nRetrieve information for an \nexisting\n  Azure Connector Configuration\n\n\nIf you have already run the Azure Credentials Tool to set up a subscription, you do not need to run the tool again. You can simply reuse the Name, Subscription ID, Tenant ID, Client ID, and Client Secret that you obtained.\n\n\nWhat to do if your Azure Client Secret is lost\n\n\nOnce Unidesk creates the Client Secret for a Connector Configuration, the secret will always be hidden from view. If you forget and lose the Client Secret for a Configuration, you can reset it by using the following procedure:\n\n\nNote:\n  You may have to be the primary Administrator of your Azure subscription to complete this procedure. Other Azure users may not have the access required.\n\n\nLog in to the \nClassic\n Azure Portal at: \nhttps://manage.windowsazure.com/\n.\nIn the left sidebar, select \nActive Directory\n.\nFrom the list of Active Directories, select the entry corresponding to your Unidesk installation.\nFrom the top menu, select \nApplications\n.\nIn the Show field, select \nApplications my company owns\n.\nIn the Search box, enter \nUnidesk\n and click the check mark to perform the search.\nIn the search results, locate an entry named \"Unidesk ELM Access for \nyour-subscription-name\n\" and delete it. If you do not see such an entry, look for it in your other Active Directories.\nRun the Unidesk Azure Credentials Tool again to create a new Client Secret.\n\n\n\nAdd a Connector Configuration\n\n\nTo add a new Connector Configuration:\n\n\nIn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nComplete the fields on the Connector Configuration page. For guidance, see the above field definitions.\nClick the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector tab.\n\n\n\nUsing the Network File Share Connector Configuration\n\n\nIn this article:\n\n\nNetwork File Share location\nWhen to select the Network File Share as your Connector Configuration\n\n\n\nWhen the Unidesk Enterprise Layer Manager is installed, you set up a network file share that you can then use as a Connector Configuration when creating layers and publishing Layered Images. This Connector Configuration contains the ELM's Network File Share credentials and location so you can deploy a Packaging Machine to the File Share when creating layers, or publishing Layered Images.\n\n\nEach Connector Configuration is set up to access a storage location via a specific account. For more about Connectors and Connector Configurations, see \nAbout Connectors and Connector Configurations\n.\n\n\nNetwork File Share location\n\n\nThe name of the Network File Share Connector Configuration includes its location. Look for the Unidesk folder at the top level of the Network File Share. For details, see Set up a network file share.\n\n\nWhen to select the Network File Share as your Connector Configuration\n\n\nWhen you publish Layered Images to a provisioning service for which we do not yet have a Connector, you can select the Network File Share Connector Configuration. You can then copy the Layered Image from the network file share to the correct location for provisioning servers.\n\n\nConnector Configuration ; Optional Script (Nutanix AHV)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nNutanix AHV Connector Configuration\n  contains the credentials and storage container Unidesk needs to connect to Nutanix Acropolis. You can use this connector for publishing Layered Images to Acropolis, and for packaging App Layers and new versions of your OS Layer using an Acropolis VM.\n\n\nYou can use this connector to:\n\n\nImport your OS image from the Acropolis environment.\nPublish Layered Images\nCreate a Packaging Machine for a new App Layer or OS Layer Version (for cross-platform deployments where your OS Image was imported from a hypervisor other than Acropolis)\n\n\n\nBefore you start\n\n\nYou can use your Nutanix Acropolis environment for creating Layers, and publishing Layered Images. Each Connector Configuration accesses a specific storage container in your Nutanix Acropolis environment where you can create your layers or publish layered images.\n\n\nYou may need more than one Nutanix Acropolis Connector Configuration to access the correct container for each purpose. Further, you may want to publish each Layered Image to a container convenient to the systems you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see \nAbout Connectors\n.\n\n\nIf this is your first time using Unidesk\n\n\nWhen publishing Layered Images to Acropolis, you will need at least one Connector Configuration for each storage container you plan to publish to. You can add Connector Configurations when creating an Image Template from which you will publish Layered Images. If you don't yet have the right Connector Configuration for the task, you can create one by clicking \nNew\n  on the Connector wizard tab (see details below).\n\n\nRequired information for Acropolis Connector Configuration settings\n\n\nThe Acropolis Connector Configuration wizard let's you define the credentials and container to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object in Acropolis, or the validation will fail.\n\n\nConnector Name\n - A useful name to help identify and keep track of this connector configuration.\nPrism Address\n - The host name (resolvable via DNS) or IP address of the Prism Web Console. This is the same address you use to access the Nutanix Prism Web Console..\nUser Name/Password\n - Credentials that will be used when interacting with the Nutanix system. The specified user must have sufficient privileges for the following operations:\nVM operations:\nclone\ndelete\npower on/off\nattach virtual disks\nImage operations:\ncreate\nupdate (aka upload)\ndelete\nVirtual disks:\ncreate\nattach to VMs\nAllow Certificate Errors\n - Lets you use SSL encryption for the API connection traffic between the Unidesk Connector and Nutanix Acropolis. This field is unchecked by default.\nTemplate\n - This is a drop down list of existing virtual machines that can be used for cloning. There is no concept of a \"template\" in Nutanix, so these VMs are actual VMs. The selected template must \nnot\n have any disks attached, and must have at least one network card attached. If it does not, you will see an error when trying to validate or save the configuration.\nStorage Container\n - Lets you select the storage container for the images (vhds) that will get uploaded and the resulting virtual disks that will get created from those images. When creating App Layers and OS Layer versions, we are required to mount the storage container as an NFS mount point. This means that the selected storage container MUST have the ELM included in a white list of clients that are allowed to mount the storage container via NFS. The white list configuration must be done through the Nutanix product (either their web console or through their CLI tools). If the ELM is not properly white listed for the selected storage container, then the validation phase will fail, and the error will be indicated with the storage container selection.\n\n\n\nHow Virtual Machines are Organized\n\n\nNutanix does not provide a mechanism for organizing virtual machines. Because of this, it may be difficult to find the virtual machines created by your Unidesk ELM when the total number of virtual machines is large. To help you find these VMs, the following naming conventions are used:\n\n\nPackaging Machines\n (virtual machines created during the process of creating an App Layer or OS Version)\nThe virtual machine name will start with the layer name that is being created/modified\nThe virtual machine names will end with the following text: (Unidesk Packaging Machine)\nLayered Image Virtual Machines\n (virtual machines created as a result of publishing a Layered Image)\nThe virtual machine name will start with the image name that was published\nThe virtual machine name will end with the following text: (Unidesk Published Image)\n\n\n\nWhen viewing virtual machines through the Nutanix web console, you can search for virtual machines by filtering on:\n\n\n\"Unidesk\" to find all virtual machines created by Unidesk\n\"Unidesk Packaging Machine\" to find all virtual machines created for Layer management jobs.\n\"Unidesk Layered Image\" to find all virtual machines created to publish a Layered Image.\nImage name or Layer name to find virtual machines related to a specific Layered Image publishing job or App or OS creation.\n\n\n\nVirtual Machine Network Connectivity\n\n\nThe virtual network settings of the source template specified in the Nutanix AHV Connector Configuration will be carried over when creating any VMs through the Nutanix Acropolis Hypervisor (AHV) Connector. There is no option in the Connector Configuration UI to override the network settings.\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three Connector fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually, click to put the cursor in the field and type the value, making sure that the case matches the value in Acropolis.\nTo select a value from a drop-down list, click once to put the cursor in the field, and a second time to display the list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and container where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nAcropolis Address\n, \nUser Name\n, and \nPassword\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the Acropolis Configuration fields. The Virtual Machine Clone Settings field is then enabled.\nSelect the Virtual Machine Template.\nSelect the Storage Repository and click the \nTEST\n button to verify that Unidesk can access the container specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script to run on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image.\n\n\nSome preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published Layered Image in Acropolis.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The Acropolis connector logs will contain the output of the executed script.\n\n\nConfigure a Script (optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed here, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nCommon\nCommon\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nCommon\nCommon\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nCommon\nCommon\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows7 64-bit\nWindows2008 64-bit\nWindows2012 64-bit\nWindows10\nWindows1064\nvirtualInfrastructureServer\nCommon\nNutanix AHV\nThe Nutanix AHV (Prism Server) specified in the connector configuraiton.\nvmId\nCommon\nNutanix AHV\nThe virtual machine UUID (same as vmUuid).\nvmName\nCommon\nNutanix AHV\nThe name of the virtual machine that was created.\nvmNetwork\nCommon\nNutanix AHV\nThe name of the virtual network that the main NIC of the virtual machine is connected to.\nvmNetworkId\nCommon\nNutanix AHV\nThe UUID of the virtual network that the main NIC of the virtual machine is connected to.\nvmNetworkMAC\nCommon\nNutanix AHV\nThe MAC address of the main NIC that is connected to the virtual network specified in vmNetwork and vmNetworkId.\nvmUuid\nCommon\nNutanix AHV\nThe virtual machine UUID (same as vmId).\n\n\n\nDefinition Scope\n\n\nDefines whether the \nscripts\n  variable is set for all Connector types or whether it is specific to a particular Connector type.\n\n\nValue Source\n\n\nDefines whether the variable value is determined by common code or by Connector-specific code.\n\n\nConnector Configuration ; Optional Script (VMware Horizon View for vSphere)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nVMware Horizon for vSphere Connector Configuration\n  contains the credentials and storage location Unidesk needs to publish Layered Images to \nVMware Horizon View\n  in your vSphere environment.\n\n\nYou can publish Layered Images to be used in any of the following pools:\n\n\nA Horizon View Composer \nLinked Clone Desktop Pool\n.\nA Horizon View \nInstant Clone Desktop Pool\n.\n\n\n\nIn the Connector Configuration wizard, be sure to configure a \nVirtual Machine Template\n , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications. For example, if you are publishing a Layered Image to a Linked Clone Desktop Pool, the Layered Image becomes a 'Parent VM' that you can select for your Linked Clones pool.\n\n\nEach Connector Configuration is set to publish Layered Images to a specific storage location in your vSphere environment, so you may need more than one VMware Horizon Connector Configuration if publishing to multiple locations. Further, you may want to publish each Layered Image to a location convenient to the systems you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see Connector essentials.\n\n\nNotes:\n \n\n\nThis Connector Configuration is for publishing Layered Images only. (You cannot package Layers using this connector.)\nPersonal vDisks are \nnot\n supported for View. The published desktop images will be non-persistent. Currently, vDisks can only be used when publishing to Citrix PVS.\nWhen installing the Horizon Agent on the VM, select the custom setup option as follows:\nSelect the \nVMware Horizon View Composer Agent\n option when deploying View Composer \nlinked-clone desktops\n.\nSelect the \nVMware Horizon Instant Clone Agent\n option when deploying \ninstant-clone desktops\n.\n\n\n\nBefore you start\n\n\nThe first time you create an Image Template for publishing Layered Images to a location in your Horizon environment, you will create a Connector Configuration for that location.\n\n\nRequired information for this Connector Configuration\n\n\nThe Connector Configuration wizard let's you browse for the vCenter Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object your environment, or the validation will fail.\n\n\nName\n - A useful name to help identify and keep track of this connector configuration.\nvCenter Server\n - The name of the vSphere server with which the Unidesk ELM will integrate.\nvCenter User Name\n - The user name of the account that the Unidesk ELM will use to connect to vSphere.\nvCenter Password\n - The password of the account that the Unidesk ELM will use to connect to vSphere.\nDataCenter Name\n - The name of the vSphere DataCenter in which the Unidesk ELM will create and retrieve virtual machines.\nVirtual Machine Template (recommended)\n - The VM to use as a template for cloning. Use the template to create a VM with the hardware settings for View, including memory, CPUs and video settings. You can specify the host, datastore and network for configuring the resulting VMs. The VM must \nnot\n have any connected disks.\nDataStore Name\n - The name of the vSphere DataStore in which the Unidesk ELM will create and retrieve virtual machines.\nESX Host Name\n - The name of the vSphere ESX Host on which the Unidesk ELM will create and retrieve virtual machines.\nNetwork Name\n - The name of the vSphere Network in which the Unidesk ELM will create and retrieve virtual machines.\nVirtual Machine Folder Name\n - The name of the vSphere Folder in which the Unidesk ELM will create and retrieve virtual machines.\n\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three vCenter fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually: Click to put the cursor in the field and type the value.\nTo select a value from a drop-down list: Click once to put the cursor in the field, and a second time to choose from a list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nvCenter Server\n, \nvCenter User Name\n, and \nvCenter Password\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the vCenter fields. The DataCenter field is then enabled with a list of DataCenters available.\nSelect the DataCenter, and the remaining dropdowns will be enabled.\n(Recommended) Select a virtual machine to use as the template. Although a VM Template is optional, it is strongly recommended.\nComplete the remaining fields and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script on any Windows machine running a Unidesk Agent. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image. Some preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published layered image in vSphere.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The vSphere connector logs will contain the output of the executed script.\n\n\nConfigure a Script (Remember, this is optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows200864\nWindows201264\nWindows10\nWindows1064\nvirtualInfrastructureServer\nAll\nvSphere connector code\nThe vCenter server specified in the connector configuration.\nvmName\nAll\nvSphere connector code\nThe name of the virtual machine that was created.\nvmId\nAll\nvSphere connector code\nThe virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\")\nvmUuid\nAll\nvSphere connector code\nThe virtual machine UUID as set by the underlying highbrd.\n\n\n\nUser Impersonation\n\n\nThe Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.\n\n\nScript Execution Policy\n\n\nScript execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.\n\n\nConnector Configuration ; Optional Script (vSphere)\n\n\nIn this article:\n\n\nBefore you start\nCreate a Connector Configuration\nScript Configuration (Optional, Advanced feature)\n\n\n\nA \nvSphere Connector Configuration\n  contains the credentials and storage location Unidesk needs to connect to vSphere.\n\n\nBefore you start\n\n\nYou can use your vSphere environment for creating Layers, and for publishing Layered Images. Each Connector Configuration accesses a specific storage location. You may need more than one vSphere Connector Configuration to access the correct location for each purpose. Further, you may want to publish each Layered Image to a location convenient to the system you will be provisioning with the published image. For more about Connectors, and Connector Configurations, see \nAbout Connectors\n.\n\n\nIf this is your first time using Unidesk\n\n\nIf this is your first time using Unidesk and you want to create Unidesk Layers using a vSphere VM, you will need a vSphere Connector. If you are also publishing Layered Images to vSphere, you can create a Connector Configuration for each of your publishing locations as well.\n\n\nThe Create Layer and Publish Layered Image wizards each ask you to select a Connector Configuration. If you don't yet have the right Connector Configuration for the task, you can create one by clicking \nNew\n  on the Connector wizard tab (details below).\n\n\nRequired information for vSphere Connector Configuration settings\n\n\nThe vSphere Connector Configuration wizard let's you browse for the vCenter Server, Data Store, and Host to use for a new configuration.\n\n\nImportant\n : The fields are case sensitive, so any values that you enter manually must match the case of the object in vSphere, or the validation will fail.\n\n\nName\n - A useful name to help identify and keep track of this connector configuration.\nvCenter Server\n - The name of the vSphere server with which the Unidesk ELM will integrate.\nvCenter User Name\n - The user name of the account that the Unidesk ELM will use to connect to vSphere.\nvCenter Password\n - The password of the account that the Unidesk ELM will use to connect to vSphere.\nDataCenter Name\n - The name of the vSphere DataCenter in which the Unidesk ELM will create and retrieve virtual machines.\nLayer Disk Cache Size in GB (optional)\n - The size of the Disk Cache that Unidesk use when creating Layers. If you leave the size blank or set it to 0, Unidesk does not use a Disk Cache. If you specify a size, Unidesk users a Disk Cache of up to this size to keep copies of boot disks and packaging disks and reuses these disks to create new packaging machines. The reuse of these boot disks and packaging disks reduces the time it takes to package an Application Layer.\nDataStore Name\n - The name of the vSphere DataStore in which the Unidesk ELM will create and retrieve virtual machines.\nESX Host Name\n - The name of the vSphere ESX Host on which the Unidesk ELM will create and retrieve virtual machines.\nNetwork Name\n - The name of the vSphere Network in which the Unidesk ELM will create and retrieve virtual machines.\nVirtual Machine Folder Name\n - The name of the vSphere Folder in which the Unidesk ELM will create and retrieve virtual machines.\n\n\n\nCreate a Connector Configuration\n\n\nTo enter values:\n\n\nThe first three vCenter fields must be entered manually. Once the credentials in those fields are validated, you can select values for the remaining fields from drop-down menus.\nTo enter values manually, click to put the cursor in the field and type the value, making sure that the case matches the value in vCenter.\nTo select a value from a drop-down list, click once to put the cursor in the field, and a second time to display the list of possible values.\n\n\n\nTo add a new Connector Configuration:\n\n\nOn the wizard for creating a Layer or for adding a Layer Version, click the \nConnector\n tab.\nBelow the list of Connector Configurations, click the \nNew\n button. This opens a small dialog box.\nSelect the Connector Type for the platform and location where you are creating the Layer or publishing the image. Then click \nNew\n to open the Connector Configuration page.\nEnter the configuration \nName\n, and the \nvCenter Server\n, \nvCenter User Name\n, and \nvCenter Password\n). For guidance, see the above field definitions.\nClick the \nCHECK CREDENTIALS\n button below the vCenter fields. The DataCenter field is then enabled with a list of DataCenters available.\nSelect the DataCenter, and the remaining dropdowns will be enabled.\nComplete the remaining fields and click the \nTEST\n button to verify that Unidesk can access the location specified using the credentials supplied.\nClick \nSave\n. The new Connector Configuration should now be listed on the Connector page.\n\n\n\nScript Configuration (Optional, Advanced feature)\n\n\nWhen creating a new Connector Configuration, you can configure an optional Powershell script on any Windows machine running a Unidesk Agentthe same agent used on the PVS server. These scripts must be stored on the same machine that the Unidesk Agent is installed on, and will only be executed after a successful deployment of a Layered Image. Some preset variables are available to enable scripts to be reusable with different template images and different connector configurations. These variables will also contain information needed to identify the virtual machine created as part of the published layered image in vSphere.\n\n\nExecution of these scripts will not affect the outcome of the publish job, and progress of commands executed in the script will \nnot\n  be visible. The vSphere connector logs will contain the output of the executed script.\n\n\nConfigure a Script (Remember, this is optional)\n\n\nIf you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.\n\n\nComplete and save the Connector Configuration as described above.\nNote:\n Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings,\nIf the Navigation menu on the left is not open, select it and click \nScript Configuration\n to open the Script Path page.\nComplete the required fields using the values detailed herein, and click \nSave\n.\n\n\n\nScript Configuration fields\n\n\nEnable script\n - Select this check box to enable the remaining fields. This allows you to enter a script that will be executed each time a Layered Image is published.\nScript Agent\n - The agent machine where the scripts will be located and executed from.\nUsername (optional)\n - The username to \nimpersonate\n when running the script. This can be used to ensure the script runs in the context of a user that has the needed rights/permissions to perform the operations in the script.\nPassword (optional)\n - The password for the specified username.\nPath\n - A full path and filename on the agent machine where the script file resides.\n\n\n\nOther Script Configuration values\n\n\nPowershell variables\n\n\nWhen the script is executed the following variables will be set and can be used in the powershell script:\n\n\nValue\nApplies to connector types:\nValue determined by which code:\nDescription\nconnectorCfgName\nAll\nCommon code\nThis is the name of the connector configuration that the script configuration is associated with.\nimageName\nAll\nCommon code\nThis is the name of the layered image template that was used to build/publish the layered image.\nosType\nAll\nCommon code\nThis is the OS type of the layered image that was published. It can be one of the following values:\nWindows7\nWindows764\nWindows8\nWindows864\nWindows200864\nWindows201264\nWindows10\nWindows1064\nvirtualInfrastructureServer\nAll\nvSphere connector code\nThe vCenter server specified in the connector configuration.\nvmName\nAll\nvSphere connector code\nThe name of the virtual machine that was created.\nvmId\nAll\nvSphere connector code\nThe virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\")\nvmUuid\nAll\nvSphere connector code\nThe virtual machine UUID as set by the underlying highbrd.\n\n\n\nUser Impersonation\n\n\nThe Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.\n\n\nScript Execution Policy\n\n\nScript execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.\n\n\nSystem Settings and Configuration\n\n\nYou can specify settings for the following Unidesk configuration parameters by clicking on the \nEdit\n  button of each option, making your changes, and clicking the \nSave\n  button.\n\n\nAppliance settings\nSummary\nHTTP Certificate Settings\nDisplays the currently set security certificate. Use the \nUpload\n and \nGenerate\n buttons to upload an existing certificate or to generate a new one. Optionally, enter a comment that describes the changes you made.\nNetwork File Shares\nAfter you specify a \nNetwork File Share Type\n, \nNetwork File Share Path\n, \nUser name\n, and \nPassword\n, click \nTest Network File Share\n to see if you can connect to the file share. The test returns a message stating either \"Success\" or \"Failed to mount network file share path\". Optionally, enter a comment that describes the changes you made.\nSecurity Settings\nSpecify the number of minutes of inactivity before the Unidesk Management Console logs you out. Optionally, enter a comment that describes the changes you made.\nTask Retention Settings\nSpecify the number of days that Unidesk should retain completed Tasks before deleting them. Optionally, enter a comment that describes the changes you made.\nAudit Log Retention Settings\nSpecify the number of days that Unidesk should retain audit log files. After that time elapses, the software begins to overwrite the audit log. Optionally, enter a comment that describes the changes you made.\nNotification Settings\nConfigure automatic email notification settings for yourself or other Unidesk users. When you export logs, Unidesk sends the specified recipients an email notification that includes a link to the log files.\nTo set up email notifications:\nIn the Mail Server box, enter the name of your email server or the name of the SMTP relay server.\nIn the Mail Server port, enter the number of the port that the email server uses for communication.\nIn the User Name box, enter the user name for the email account you want to use for sending notifications. For example, username@domain.com.\nIn the Password box, enter the password for the email account.\nIn the From box, enter an email address to identify the source of the email message. For example, if you enter myaddress@mycompany.com, the email message displays the following in the From box of the received notification:\nUnidesk Enterprise Layer Manager [myaddress@mycompany.com] \nIn the Recipient List box, enter the email addresses that should receive notifications. Use a comma or semicolon to separate the email addresses.\nClick \nTest Email Configuration\n to verify that the settings for the email server and account work correctly. If the test succeeds, the software displays a success message and sends the recipients a confirmation email.\nEnter a comment, if necessary, and click \nSave \nto save the email settings. Any comments you enter will appear in the Information view Audit History.\nFor more information, see \nExport log files and send to Support\n.\nLog File Retention Settings\nSpecify the maximum disk space to use for all logs (in megabytes) and the number of days that Unidesk should retain Unidesk ELM log files. Optionally, enter a comment that describes the changes you made.\n\n\n\nManage system storage\n\n\nIn this article:\n\n\nCheck the amount of free space in the Unidesk ELM's local storage\nAdd space to an existing disk in locally attached storage\nAdd a disk to locally attached storage\n\n\n\nCheck the amount of free space in the Unidesk ELM's local storage\n\n\nThe ELM's local storage is your Layer Repository where the ELM creates, composites, and stores Layers and Layered Images. You can see how much disk space is used in the System module of the Unidesk Management Appliance (UMC).\n\n\nLog into the UMC and select \nSystem -> Manage Appliance\n.\nIn the Unidesk Services table, the Local Storage for the Layering Service shows how much space is used and how much is free.\nNotes:\nDisk space is shown in 1024-based Gigabytes, not metric.\nFree space is updated every time a Layering Service job completes. If you want to make sure the page has been refreshed, click the Refresh icon just above the Manage Appliance subtab.\nWhen creating a Layer or adding a Version to it, extra space is temporarily required to build the Packaging Disk. You can calculate the amount of space needed during Layer creation by adding the following Layer sizes:\nThe size of the OS Layer Version you're using.\nThe size of the writable disk you want for the App Layer.\nThe size of any Prerequisite Layers (if you have any).\n\n\n\nAdd space to an existing disk in locally attached storage\n\n\nYou can add storage space to an existing local storage disk as follows.\n\n\nLog into your hypervisor's management console, and follow the normal procedure to increase the size of the ELM's local storage disk. (You may have more than one of these disks, and can expand each one of them.)\nLog into the UMC and select System -> Manage Appliance.\nSelect Expand Storage. A list of expanded disks is displayed. (You might also see attached disks that are not yet part of the layer repository, but you can ignore those.)\nNotice that the New Size of the disk you expanded is larger than the Current Size.\nSelect the check box for the disk that you want to expand to the New Size.\nOn the Confirm and Complete tab, click Expand Storage.\n\n\n\nAdd a disk to locally attached storage\n\n\nWhen you install the Unidesk ELM in vSphere, it comes equipped with an additional 200 GB data disk that is used as a Layer Repository. You can expand the ELM's local storage by adding another disk to it.\n\n\nLog into your hypervisor's management console, and follow the normal procedure to add a blank SCSI disk to the ELM appliance.\nLog into the UMC and select System -> Manage Appliance.\nSelect Expand Storage.\nOn the Disk Selection tab, a list is displayed of disks that are attached to the system and are not part of the layer repository.\nSelect the check box for each disk that you want to use to expand the layer repository.\nIf a check box is grayed out and a yellow icon with an ! (exclamation point) is displayed, it means that the attached disk is not eligible for use (for example, if the disk is not blank). Once the attached disk is blank and unpartitioned, you will be able to use it to expand the ELM's local storage.\nOn the Confirm and Complete tab, click Expand Storage.\n\n\n\nManage the Unidesk ELM (virtual appliance)\n\n\nIn this article:\n\n\nBefore you start\nLog into the ELM using an account with administrator privileges\nChange the administrator password\nConfigure networking (includes Static IP Address option)\nSynchronize the system clock with NTP servers\nChange the Time Zone\n\n\n\nThe Enterprise Layer Manager (ELM) is a virtual appliance that coordinates communication in the Unidesk environment and manages copies of your Layers and Image Templates. Based on CentOS, the ELM hosts the Unidesk Management Console (UMC), a friendly interface where you create Unidesk Layers and use those Layers to publish Layered Images.\n\n\nYou can log into the ELM and modify the administrator password, network address, NTP servers, and Time Zone settings using the Unidesk Appliance Configuration utility, as described here.\n\n\nBefore you start\n\n\no Make sure that the Unidesk Enterprise Layer Manager (ELM) is running in your hypervisor.\n\n\no Make sure you have the password for an account with administrator privileges\n\n\nLog into the ELM using an account with administrator privileges\n\n\nUsing either your hypervisor console or SSH, log into the ELM as \nadministrator\n (default password \nUnidesk1\n).\nNote:\n If the ELM is in \nAzure\n, type \n/opt/sbin/cfg_launcher\n, and press \nEnter\n.\nThis opens the Unidesk Appliance Configuration utility.\n\n\n\nChange the administrator password\n\n\nLog in\n to the ELM's Appliance Configuration utility, as described above.\nAt the Appliance Configuration utility's Action prompt, enter \nP\n (for \nPassword change\n), and press \nReturn\n.\nWhen prompted, enter the new password, and then confirm the password. A message confirms that the \n** Password changed successfully\n.\nPress the \nEnter\n key to continue.\nAt the Action prompt, enter \nQ\n to quit.\n\n\n\nConfigure networking (includes Static IP Address option)\n\n\nYou can change the ELM's IP address and/or its DNS servers.\n\n\nWhen the ELM is first deployed, the DNS settings are retrieved through DHCP. If DHCP is not available and you will be using static IP addresses, once you select \nStatic\n , you will be prompted to enter the IP addresses for your DNS servers.\n\n\nLog in\n to the ELM's Appliance Configuration utility, as described above.\nAt the Action prompt, enter \nC\n (for Configure Networking), and press \nReturn\n.\nAt the next prompt, type \nD\n for Dynamic (DHCP) or \nS\n for Static.\nIf you choose \nStatic\n, you will be prompted for the IP address and Subnet mask, along with default addresses for the Gateway and DNS addresses.\nWhen prompted, enter \nY\n to save settings.\nAt the Action prompt, enter \nQ\n to quit.\nRestart the appliance.\n\n\n\nSynchronize the system clock with NTP servers\n\n\nYou can synchronize the system clock on the ELM by configuring NTP servers. You can specify how many NTP servers you need, with 6 being the maximum. And, you can add and remove NTP servers, as needed. Where possible your existing servers will be used as defaults.\n\n\nLog in\n to the ELM's Appliance Configuration utility, as described above.\nAt the Action prompt, enter \nN\n for \nNTP servers change\n, and press \nReturn\n. A list of your current NTP servers is displayed.\nAt the prompt, specify how many NTP servers you need by typing a number from 0 to 6.\n0 - All servers will be removed (you will be warned).\n1-6 - You will be prompted to accept or replace each of the current servers. \nFor each server, press \nEnter\n to accept the current value. Or, enter a new server address (Example: \n3.pool.ntp.org\n). Once the last address is entered, an NTP Server Summary is displayed.\nEnter \nS\n to save the settings.\nAt the Action prompt, enter \nQ\n to quit.\nRestart the appliance.\n\n\n\nChange the Time Zone\n\n\nLog in\n to the ELM's Appliance Configuration utility, as described above.\nAt the Action prompt, enter \nT\n for \nTimezone change\n, and press \nReturn\n. The current time zone is displayed.\nPress \nEnter\n to display available timezones. The first bunch of time zones are displayed in alphabetical order, starting with the\nAdvance through the timezone codes until you see yours:\nEnter\n - Advances one line at a time.\nPage Up\n \nPage Down\n - Displays the next or previous screen full of choices.\nOr search the timezones:\nType \nSlash\n (\n/\n) and part of the name you are looking for.\nWhen your timezone is displayed, press \nQ\n to get to the prompt.\nType the number for your timezone. The timezone you entered is displayed.\nPress \nEnter\n to complete the change.\nAt the Action prompt, enter \nQ\n to quit.\nRestart the appliance.\n\n\n\nOpen firewall ports for Unidesk, as needed\n\n\nIn this article:\n\n\nAdmin User\nUnidesk Enterprise Layer Manager Appliance\nNext step\n\n\n\nThe Unidesk ELM must be connected to a network file share.\n\n\nThe Unidesk installer opens ports that the Unidesk Enterprise Layer Manager (ELM) needs to interact with services on the virtual server where it is hosted. The default ports that Unidesk uses are listed in the tables below.\n\n\nIf there is a firewall between the Unidesk appliance and the machine on which you are running the Unidesk Agent or one of the Unidesk Connectors, you must manually open the port in the firewall used for that purpose. If during installation you changed any of the ports from the default setting, be sure to open the correct port.\n\n\nAdmin User\n\n\nBy default, Unidesk uses the following ports in your firewall for the Unidesk Admin User to interact with the Unidesk Management Console (UMC).\n\n\nDestination\nActivity\nProtocol\nPorts\nUnidesk Enterprise Layer Manager (ELM)\nUnidesk Management Console (UMC)\nTCP\n80,443\n\n\n\nUnidesk Enterprise Layer Manager Appliance\n\n\nInternal Connections\n\n\nBy default, Unidesk uses the following ports in your firewall for internal connections between the Unidesk appliance and each of the destinations listed below.\n\n\nDestination\nActivity\nProtocol\nPorts\nUnidesk ELM\nActiveMQ Console\nTCP\n8161\nUnidesk ELM\nLog deliveries from the Unidesk Agent\nTCP\n8787\nUnidesk ELM\nLog deliveries from users\nTCP\n8888\nUnidesk ELM\nCommunication with datastore via ESXI Host\nTCP\n443\nUnidesk Agent\nCommunication\nTCP\n8016\nUnidesk Agent\nLog gathering\nTCP\n14243\nActive Directory\nLDAP\nTCP\n389, 636\nConnector for Azure\nCommunication\nTCP\n3000 (HTTP) \n3500 (HTTPS)\nConnector for PVS\nCommunication\nTCP\n3009 (HTTP) \n3509 (HTTPS)\nConnector for vSphere\nCommunication\nTCP\n3004 (HTTP)\n3504 (HTTPS)\nConnector for XenServer\nCommunication\nTCP\n3002 (HTTP)\n3502 (HTTPS)\n\n\n\nExternal connection\n\n\nBy default, Unidesk uses the following port in your firewall for external connections between the Unidesk appliance and the destination listed below.\n\n\nDestination\nActivity\nProtocol\nPorts\napi.unidesk.com\nLogs and Phone Home data uploads from the Unidesk ELM (optional)\nTCP\n443\n\n\n\nOS Image (XenServer requirement)\n\n\nCitrix XenServer uses Port 5900 for communications between your OS Image and XenCenter or other Xen client.\n\n\nDestination\nActivity\nProtocol\nPorts\nXenCenter\nCommunications\n \n5900\n\n\n\nNext step\n\n\nIf you are publishing to PVS: Install the Unidesk Agent (required for PVS and Connector Scripts)\n\n\nIf you are \nnot\n  publishing to PVS: Assign Unidesk Roles to users\n\n\nUpdate your Unidesk license\n\n\nIn this article:\n\n\nLog into the Unidesk site\nUpdate your Unidesk license (with web access to the ELM)\nUpdate your Unidesk license (without web access to the ELM))\n\n\n\nTo acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.\n\n\nLog into the Unidesk site\n\n\nIn a web browser, navigate to \nthe Unidesk website\n and click \nLogin\n.\nIf you have not yet registered with Unidesk, go to the Register section of the login page, enter your email address and click \nRegister.\nUnidesk sends a confirmation email message to the address you provided.\nOpen the confirmation email message from Unidesk, which contains the Subject line \"Confirming your registration at www.unidesk.com\", and click the link it contains or paste the link into a web browser.\nTo finish registering, fill out the fields in the \"Email address confirmed\" page and click the \nComplete registration\n button.\n\n\n\nUpdate your Unidesk license (\nwith\n  web access to the ELM)\n\n\nIf you receive a message that your license needs updating, and your Enterprise Layer Manager has web access:\n\n\nIn the License Expired message, click \nLicense\n. This opens the Update License wizard.\nSelect \nDownload your license now by entering your credentials for the www.unidesk.com website\n.\nEnter your credentials for the Unidesk website.\nOn the Confirm Your License tab, click \nFinish\n.\nYou can return to the Licensing wizard at any time by logging into the Unidesk Management Console and clicking \nAbout\n, and then the \nLicense\n tab.\n\n\n\nUpdate your Unidesk license (\nwithout\n  web access to the ELM))\n\n\nIf you receive a message that your license needs updating, and your Enterprise Layer Manager does \nnot\n  have web access:\n\n\nObtain a license file from Unidesk Sales or Support, and move the file to a drive that Enterprise Layer Manager can access.\nIf the License Expired message, is still open, click \nLicense\n in the message. If not, click \nAbout\n, then the \nUpdate License\n button. This opens the Update License wizard.\nSelect \nUpload your license file from a local drive\n.\nClick \nBrowse\n, and select the license file.\nOn the Confirm Your License tab, click \nFinish\n.\nYou can return to the Licensing wizard at any time by logging into the Unidesk Management Console and clicking \nAbout\n, and then the \nLicense\n tab.\n\n\n\nSupport resources\n\n\nIn this article:\n\n\nNeed help getting started?\n\n\nQuestions about how Unidesk layering works?\n\n\nTroubleshooting an issue?\n\n\nNeed help getting started?\n\n\nTry Unidesk for the first time\n\n\nInstall the Unidesk Enterprise Layer Manager (ELM)\nSet up the ELM in your environment\nTake a test drive\n\n\n\nSchedule a personalized demo\n\n\nJoin us for a one-on-one \"Day-in-the-Life\" with a Unidesk Solution Architect\n\n\n\nDeploy rapidly with expert assistance\n\n\nRequest a Unidesk Pilot, if you haven't already\nCreate a Support Case\n\n\n\nQuestions about how Unidesk layering works?\n\n\nAsk Unidesk employees and contributing users\n\n\nPost your questions on the Unidesk Community Forum\n\n\n\nSearch the Forum\n\n\nApp Layer Recipes\n\n\n\nTroubleshooting an issue?\n\n\nTroubleshooting Unidesk 4.0 (Forum posts)\n \nTroubleshooting Unidesk 4.0 (Knowledge base)\n \n\n\n\nExport log files for Support\n\n\nYou can export logs for your Unidesk Enterprise Layer Manager (ELM), and send them to the Unidesk Support team via HTTPS or to yourself and others by email.\n\n\nThis topic explains what log files are available for export, and which log files are useful for what kinds of issues. It then explains how to export each of the logs.\n\n\nAbout exporting Unidesk logs\n\n\nUnidesk log files are text files that contain useful information for the Unidesk Support Team when helping you to resolve an issue. The exported logs are stripped of any passwords and encryption keys, so none of your credentials can be compromised.\n\n\nWhat log files are exported?\n\n\nEach export includes the logs for the Unidesk ELM. The Database Crash Dump file export is optional. When you export logs, the Unidesk software creates a gzipped tar file (.tgz) containing the log files. A task with the URL for each tar file appears in the Task bar.\n\n\nVirtual Machine\nExported files\nEnterprise Layer Manager (ELM)\nThe gzipped tar file (.tgz) with:\nManagement Services logs\nLayering Services logs\nCrash Dump files (optional)\n\n\n\nTo view the log files, download them and extract them using a file compression utility such as the WinZip\n product.\n\n\nBefore you start\n\n\nBefore you can...\nYou must...\nSend logs to Unidesk Support\nHave an open Support Case. Create a Support Case explaining the issue you're seeing.\nSend email notices\nSpecify your email server in the System > Settings and Configuration > Notifications Settings box.\nExport logs\nMake sure the Log File Retention Settings are configured to keep the logs you need for the length of time you need.\n\n\n\nExport and send Unidesk ELM logs\n\n\nWhen configuring an export, you can choose to send a copy of the logs to Unidesk Support via HTTPS, or to yourself or others who need access to the logs via email.\n\n\nIn the Unidesk Management Console, select \nSystem > Manage Appliance\n and click \nExport Logs\n. The Export Logs Wizard opens to the Send Options tab.\nIf you want to send the logs to Unidesk via HTTPS and you have a Unidesk Support Case open, click \nSend to Unidesk Support\n, choose the support case, and type a description in the Comments field.\nNote:\n This option is only available if you have an open Support Case. You can open one and come back to this screen to select the option.\nIf you want to send the files to yourself or others who need access to the logs, select the \nEmail\n check box and type the addresses in the Recipients field. (Use a comma (,) or semi-colon (;) between addresses.)\nNote:\n This field is only active if you've configured an email Notification in the \nSystem > Settings and Configuration > Notifications Settings\n box.\nIn the Log Selection tab, the Enterprise Layer Manager Logs option is selected by default. If you need to include the Crash Dump files, mark the check box to include those.\nIn the Confirm and Complete tab, click \nExport Logs\n to start the export process. The software locates the log files and exports them to a gzipped archive file (*.tgz) on the appliance.\n\n\n\nThe free \nonline div table generator\n allows you to create nice grids for your websites. Please subsribe for a \nhtmlg\n membership to stop adding promotional messages to the edited documents.", 
            "title": "Unidesk Documentation"
        }, 
        {
            "location": "/#welcome-to-citrix-app-layering-4", 
            "text": "In this article:  The ultimate in application management simplicity Provision servers in any environment Deliver applications with ease A simple addition to your environment Get started", 
            "title": "Welcome to Citrix App Layering 4"
        }, 
        {
            "location": "/#unidesk-layers", 
            "text": "With Unidesk you can create an OS Layer or App Layer once, and use it to create any number of images. You can then update the OS or application by adding a new Version to the Layer for each patch or update that you apply.  In App Layers you can deploy virtually any applications compatible with the OS. Each App Layer can include one or more applications. When it's time to upgrade an application, you can add a new version to the Layer for the latest update.  Platform Layers are designed to support your environment. A Platform Layer containing your hypervisor tools and settings makes it easy to create layers using VMs in your hypervisor environment. A Platform Layer containing your hypervisor, provisioning service, and connection broker software isolates App and OS Layers from the infrastructure where they will be published.", 
            "title": "Unidesk Layers"
        }, 
        {
            "location": "/#layered-images-for-provisioning-session-hosts", 
            "text": "Image Templates are where you choose the Operating System and Layer assignments for an Image. You can include OS and App layers in any number of Image Templates. Using an Image Template and a Platform Layer, you can publish a Layered Image to your provisioning service, hypervisor, or network file share .  You can publish Layered Images as virtual disks to any location to which the ELM has access, and use the disks to provision as many servers as you need.", 
            "title": "Layered Images for provisioning Session Hosts"
        }, 
        {
            "location": "/#platform-connectors", 
            "text": "A Unidesk Platform Connector configured with the credentials for a specific location in your virtual environment, allows Unidesk to publish the Layered Images and provision servers in a specific location.", 
            "title": "Platform Connectors"
        }, 
        {
            "location": "/#compatibility", 
            "text": "For compatibility details, see Supported Platforms.", 
            "title": "Compatibility"
        }, 
        {
            "location": "/#unidesk-release-notes-and-platform-support", 
            "text": "Find out what's new, what to watch out for, and what platforms are supported in this release.", 
            "title": "Unidesk Release Notes and Platform Support"
        }, 
        {
            "location": "/#unidesk-4-release-notes", 
            "text": "In this article:  Welcome to Unidesk 4.0.8! Unidesk 4 Release Notes New in Unidesk Labs! Supported Platforms Upgrade path Known issues and considerations How can I contact Unidesk?", 
            "title": "Unidesk 4 Release Notes"
        }, 
        {
            "location": "/#whats-new-in-this-release", 
            "text": "Full support for Nutanix AHV.  Unidesk now fully supports Nutanix AHV, adding to our existing support for Hyper-V, vSphere/ESX, Citrix XenServer, and Azure. Like the other platforms, you can now use Nutanix AHV to host the Unidesk Enterprise Layer Manager (ELM) virtual appliance; package App Layers and Layer versions; create and publish Layered Images; and use Elastic Layering to deliver custom applications to both virtual desktops and XenApp/RDSH sessions at login. You can also deliver Layers and Layered Images to all supported platforms without costly re-packaging or re-imaging. Moving your users from one end user computing environment or hypervisor to another, and managing across multiple environments has never been easier. Unidesk Connector for Citrix MCS support for Nutanix AHV.  You can now publish Unidesk Layered Images directly to Citrix Machine Creation Services (MCS) running on Nutanix AHV. You'll be able to manage image content (OS and Apps) once with Unidesk and continue to use MCS to manage image delivery for both your XenApp and XenDesktop environments. Instead of having to update Windows and common applications once for every delivery group and MCS image, you'll only have to apply updates once. Windows Server 2016 Support.  You can now use Windows Server 2016 as a supported operating system (OS) layer for Citrix XenApp and RDSH published application and desktop deployments. Import your Windows Server 2016 OS and you can start building App Layers and Platform Layers on top of it! Improved performance when Creating App Layers on VMware vSphere.  You can configure the VMware vSphere Connector to cache boot and packaging disks and reuse them. Once these disks have been cached as part of creating your first App Layer, the time it takes to create subsequent App Layers is cut in half. Layer Management updates.  We made several enhancements to general layer management usability including improvements to the Virtual Appliance Configuration Tool, the ability to edit the Layer version description, and listing the OS type in the OS Layer detail information. Imprivata OneSign Single Sign-On.  Unidesk is fully compatible with Imprivata OneSign for single sign-on efficiency. Imprivata can be packaged as a Unidesk application layer to make distribution to all virtual workspaces fast and easy. Unidesk Roles.  Previously released in Labs, Unidesk Roles are now generally available and with a new capability to assign Roles to AD Groups in addition to directly assigning Roles to individual users. Elastic Fit.  Also previously released in Labs, Elastic Fit is now Generally Available. This feature alerts you if an Application Layer can be delivered as an Elastic Layer at login. Unidesk gives you the option of delivering applications as Layered Images or as Elastic Layers, Elastic Fit will advise you on which of Unidesk's layer delivery options to use. User Layer (Unidesk Labs).  You can now test the ability to persist user profile settings, data, and user-installed applications in non-persistent VDI environments with the new User Layer. Initially, the User Layer will support Windows 7 64-bit environments for Citrix XenDesktop, VMware Horizon View and View JIT. Additional operating systems and session environments will be supported going forward.", 
            "title": "What's new in this release?"
        }, 
        {
            "location": "/#user-layer-unidesk-labs", 
            "text": "MS Office should be in the Layered Image. If using add-ins or Office 365, you  must  include Office in the Layered Image, not in the User Layer. If not, you will have activation issues. (UNI-53474) There are issues with Windows Search when using a User Layer. (UNI-53320), (UNI-54524), (UNI-54520) Red ' X ' network adapter icon indicates there's an issue even when the network is functional. When using a User Layer, the network icon will appear as a red x, even when everything is functional. You can ignore the red ' X '. (UNI-53443)", 
            "title": "User Layer (Unidesk Labs)"
        }, 
        {
            "location": "/#common-across-platforms", 
            "text": "Tasks created prior to this release do not have fully qualified owners and can only be canceled by an Administrator. (UNI-52741) App may appear to load slowly on a user's session. For applications that automatically update, like Chrome and Firefox, updates should be turned off. Windows will prompt the user to make changes with Admin rights even though the user does not have those rights. Instruct the user to click  No  when prompted, and the application will load successfully. Unidesk Agent requires .NET Framework 4.5, but the installer lists 4.0 as a prerequisite.The Unidesk Agent needs .NET Framework 4.5 but lists 4.0 as a prerequisite. This causes the installer to fail when it reaches \"Starting services\", and the Unidesk Agent logs show the service trying to start up repeatedly. Please install .NET Framework 4.5 as a prerequisite for the Unidesk Agent. (UNI-50769) User receives alert on first launch of an elastically assigned Skype Layer.When a Skype Layer is elastically assigned, the user receives this alert the first time the app is launched, \"The Installer has insufficient privileges to modify this file:  url .\" If the user clicks the  Ignore  button, Skype opens as expected. (UNI-52164)  Use the same hypervisor when adding a Version to your OS Layer. When adding a Version to an OS Layer, you must package the Layer on the same hypervisor from which you imported the OS during Layer creation. (UNI-44372) After adding new disks to the ELM, be sure to reboot. When adding disks to expand storage, a reboot of the ELM is recommended after the disk expansion wizard has completed the operation. (UNI-53580)", 
            "title": "Common across platforms"
        }, 
        {
            "location": "/#elastic-layering", 
            "text": "Elastic Layers require .NET Framework 4.5.If you are using Unidesk Elastic Layers, .NET Framework 4.5 must be installed on any Layered Image where Elastic Layers are enabled. Empty directories visible to Windows Explorer users when Unidesk drivers are running. When an image has been enabled with Elastic Layering, a user using Windows Explorer to view files and directories may be able to see empty directories associated with other sessions using Elastic Layering if they also use Windows Explorer to browse files. Directories explored in the other session may create folders visible to all sessions that have the rights to browse that directory. The directories and the contents of them will not be visible to users who do not have access to the volume. If using Elastic Layer Assignments with Windows Server 2008 or Windows 7, your fileshare must be created with a sector size of 512.   For details about this issue and related OS updates, see the Microsoft articles about  Microsoft support policy for 4K sector hard drives in Windows , and  Update that improves the compatibility of Win 7 and Win Server 2008 R2 with Advanced Format Disks . (UNI-48984) When using Elastic Layer Assignments, Persona Management in Horizon View is  not  supported. Although Unidesk supports Horizon View 6.1 and later, Elastic Layer Assignments do not work with these versions of View Persona Management. (UNI-53639)", 
            "title": "Elastic Layering"
        }, 
        {
            "location": "/#elastic-layering-ms-office", 
            "text": "Shortcuts to elastically assigned Office apps may be visible on the Start menu for users who are not assigned the apps. Although these shortcuts are visible, they only work for users who are assigned the apps. (UNI-49687) When MS Office is assigned elastically, use built-in license activation scripting. For best results when using office elastically, consider using built-in license activation scripting and adding c:\\windows\\setup\\scripts\\officeactivate.cmd to the script path when finalizing the Office App Layer or editing its properties. (UNI-50467) When elastically layering MS Office, do not install One Note. Instead, include OneNote in the Layered Image. The One Note printer driver allows other Office apps to print to One Note. For further details, refer to the  Microsoft Office Recipe . (UNI-50449)", 
            "title": "Elastic Layering MS Office"
        }, 
        {
            "location": "/#windows-10", 
            "text": "Windows 10 upgrades require a 60 GB disk for the OS Layer Version. When adding a Version for upgrading your Windows 10 OS Layer, be sure to change the Max Layer Size from the default of 30 GB to the required 60 GB. (UNI-52422) Additional step required when upgrading a major Win 10. During a major upgrade, for example when upgrading from 1511 to 1607, Windows 10 sometimes creates a Recovery Volume as a new partition on the same disk as the OS Layer Version. This volume should always be removed before you finalize the OS Layer Version. Otherwise, the recovery volume can cause desktops to fail to boot correctly. For the steps to safely remove a recovery volume, click  here .", 
            "title": "Windows 10"
        }, 
        {
            "location": "/#citrix-pvs", 
            "text": "When creating an Image Template, the template's target device hardware settings must match the Windows OS and Platform Layer settings. Make sure the target device hardware settings match the OS and Platform layer hardware settings, especially the number of CPUs. If they don't match, you can get a  reboot required  message when the published image is booted. (UNI-50799, UNI-46333, UNI-51599) When using PVS, you must disable IPv6 in the OS Layer. If this is configured in the Platform Layer instead of in the OS Layer, when the resulting PVS machines boot, they will lose their network connection and hang. (UNI-53600) If permissions are wrong when publishing an image, you may get an error message that states that the operation has timed out. (UNI-54516) Although the UMC allows image names that contain a period (\".\"), those names fail in the PVS environment. Do not include a period in the name. UNI-54263)", 
            "title": "Citrix PVS"
        }, 
        {
            "location": "/#xenserver", 
            "text": "When preparing your OS image for use in XenServer, you must open port 5900. (UNI-50846) Creating a Unidesk Connector Configuration that points to a  slave  node in a XenServer pool produces an unexpected error message. To avoid this issue, only use the  master  node when creating Connector Configurations. (UNI-52454)", 
            "title": "XenServer"
        }, 
        {
            "location": "/#vmware-horizon-view", 
            "text": "Elastic layers are only supported with floating desktop pools. (UNI-53442)", 
            "title": "VMware Horizon View"
        }, 
        {
            "location": "/#microsoft-hyper-v", 
            "text": "When using Elastic Layering in Hyper-V, you must use  unmanaged  RDS pools. (UNI-53545)", 
            "title": "Microsoft Hyper-V"
        }, 
        {
            "location": "/#imprivata", 
            "text": "Imprivata App Layers must be created with the appropriate broker Platform Layer as a prerequisite. This is critical for Citrix PVS/MCS and Horizon View environments", 
            "title": "Imprivata"
        }, 
        {
            "location": "/#supported-platforms_1", 
            "text": "In this article:  Hypervisor Image publishing Operating System for Layered Images Directory Service Internet browser", 
            "title": "Supported Platforms"
        }, 
        {
            "location": "/#unidesk-enterprise-layer-manager-elm", 
            "text": "The Unidesk ELM can be installed in the following environments:  Azure Resource Manager Citrix XenServer 6.5, 7.0 Microsoft Hyper-V, Windows Server 2012 R2 Nutanix Acropolis vSphere vCenter 5.5.x, 6.0.x", 
            "title": "Unidesk Enterprise Layer Manager (ELM)"
        }, 
        {
            "location": "/#network-file-share-protocol", 
            "text": "Server Message Block (SMB) Network File System (NFS) Note:   Elastic Layers  can only use SMB file shares. NFS shares are not supported for Elastic Layering.", 
            "title": "Network File Share protocol"
        }, 
        {
            "location": "/#network-connection", 
            "text": "A 10 GB connection is recommended between the Unidesk ELM and the file share.", 
            "title": "Network connection"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm", 
            "text": "Where are you installing the Unidesk ELM?", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM)"
        }, 
        {
            "location": "/#install-the-unidesk-elm-in-citrix-xenserver", 
            "text": "Review the prerequisites and follow the steps to install the ELM in Citrix XenServer. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.", 
            "title": "Install the Unidesk ELM in Citrix XenServer"
        }, 
        {
            "location": "/#unidesk-prerequisites-xenserver", 
            "text": "In this article:    Storage requirements XenServer requirements", 
            "title": "Unidesk Prerequisites (XenServer)"
        }, 
        {
            "location": "/#storage-requirements", 
            "text": "350-500 GB Storage Space The Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed. 40-100 GB network file share (SMB/NFS) The file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.", 
            "title": "Storage requirements"
        }, 
        {
            "location": "/#citrix-xenserver-prerequisites", 
            "text": "XenServer account and privileges A XenServer account (new or existing) to use for Unidesk. The account must have XenServer privileges to: Create and remove virtual disks. Copy and delete layers on virtual disks using XenServer file APIs. Citrix XenServer software and settings Access to the XenServer Tools to install on the layer. XenServer resource information The XenServer info listed in  Citrix XenServer Connector Configuration . Network access to Unidesk OS Machine Tools When you create Layer or add a Version to it, the Unidesk Management Console (UMC) uses a Connector Configuration to create a VM called a Packaging Machine for the Layer you are building. The Packaging Machine  must  have access to the Unidesk OS Machine Tools download, which is available on the Unidesk Download page.", 
            "title": "Citrix XenServer prerequisites"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm-xenserver", 
            "text": "In this article:  Before you start Deploy the Unidesk Enterprise Layer Manager (ELM) Expand locally attached storage, if needed Next Step", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM) (XenServer)"
        }, 
        {
            "location": "/#configure-advanced-settings", 
            "text": "Once you've completed the ELM installation, you should immediately log into the ELM and:  Modify the administrator password. (Optional) Configure advanced network options, such as Static IP, as needed. Make any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.  The Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .", 
            "title": "Configure advanced settings"
        }, 
        {
            "location": "/#log-into-the-unidesk-management-console-umc", 
            "text": "In this article:  Log into the UMC Next step", 
            "title": "Log into the Unidesk Management Console (UMC)"
        }, 
        {
            "location": "/#install-the-unidesk-elm-in-azure", 
            "text": "Review the prerequisites for installing the Unidesk Enterprise Layer Manager in Azure. Next,follow the steps to install the ELM in Azure. You will then be able to log in to the Unidesk Management Console and complete the Unidesk setup.", 
            "title": "Install the Unidesk ELM in Azure"
        }, 
        {
            "location": "/#unidesk-prerequisites-azure", 
            "text": "In this article:  Unidesk Prerequisites (Azure) Storage requirements Azure-specific requirements", 
            "title": "Unidesk Prerequisites (Azure)"
        }, 
        {
            "location": "/#storage-requirements_1", 
            "text": "350-500 GB Storage Space The Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed. 40-100 GB network file share (SMB/NFS) The file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.", 
            "title": "Storage requirements"
        }, 
        {
            "location": "/#azure-prerequisites", 
            "text": "Before installing the Unidesk ELM in Azure, be sure to meet the following prerequisites.  Network File Share (Azure specifics) A file share server in Azure will perform significantly better than an on-premise file share. Even though the  Azure  file share feature is not supported, you can use an existing network file share or create a new file share in the Azure environment. Using  Premium Storage  is strongly recommended. Only fixed VHD disks will deploy successfully. Azure account and subscription To deploy and configure the Unidesk Enterprise Layer Manager, you will need the credentials for an account that has administrative access to your Azure subscription. For more information, refer to the  Microsoft Azure Sign in page .  Azure Resource Manager Unidesk is designed to work with Azure's new Resource Management (ARM) model. It does not support Azure's Classic deployment model. All resources such as virtual network, file shares and OS machines that Unidesk will work with must be created with Azure Resource Manager. For more information, refer to the  Azure Resource Manager overview page . Azure network topology Before deploying the Unidesk Enterprise Layer Manager (ELM), you must define and create your Azure network topology. The ELM and its Network File Share must have network connectivity. However, the ELM does not require network connectivity to the Session Hosts that are created. Unidesk recommends utilizing a site-to-site connection between your corporate and Azure networks to access the Unidesk Management Console on the ELM. For more information, refer to the  Microsoft Azure Virtual Network page .", 
            "title": "Azure prerequisites"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm-with-local-storage-azure", 
            "text": "In this article:  Before you start Deploy the Unidesk ELM from the Azure Marketplace Next Step", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM) with local storage (Azure)"
        }, 
        {
            "location": "/#configure-advanced-settings_1", 
            "text": "Once you've completed the ELM installation, you should immediately log into the ELM and:  Modify the administrator password. (Optional) Configure advanced network options, such as Static IP, as needed. Make any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.  The Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .", 
            "title": "Configure advanced settings"
        }, 
        {
            "location": "/#log-into-the-unidesk-management-console-umc_1", 
            "text": "In this article:  Log into the UMC  Next step", 
            "title": "Log into the Unidesk Management Console (UMC)"
        }, 
        {
            "location": "/#install-the-unidesk-elm-in-hyper-v", 
            "text": "Review the prerequisites and follow the steps to install the ELM in Hyper-V. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.", 
            "title": "Install the Unidesk ELM in Hyper-V"
        }, 
        {
            "location": "/#unidesk-prerequisites-hyper-v", 
            "text": "In this article:    Storage requirements Hyper-V-specific requirements", 
            "title": "Unidesk Prerequisites (Hyper-V)"
        }, 
        {
            "location": "/#storage-requirements_2", 
            "text": "350-500 GB Storage Space The Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed. 40-100 GB network file share (SMB/NFS) The file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.", 
            "title": "Storage requirements"
        }, 
        {
            "location": "/#hyper-v-prerequisites", 
            "text": "Be sure the Hyper-V VM where you are installing the ELM meets the following prerequisites.  A Windows Hyper-V 2012 R2 server A Virtual Network in Hyper-V", 
            "title": "Hyper-V prerequisites"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm-hyper-v", 
            "text": "In this article:  Before you start Deploy the Unidesk Enterprise Layer Manager (ELM) Next Step", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM) (Hyper-V)"
        }, 
        {
            "location": "/#prerequisites", 
            "text": "To install the Unidesk ELM in Hyper-V environment you need:  A Unidesk account. The Storage and Hyper-V requirements listed  here .", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#virtual-appliance-details", 
            "text": "Name Value Virtual Machine Name Unidesk Enterprise Layer Manager VIrtual Machine Generation Generation 1 Memory 8192 MB CPUs 4 Disk 1 unidesk_hyperv-system.vhdx Disk 2 unidesk_hyperv-repository.vhdx", 
            "title": "Virtual appliance details"
        }, 
        {
            "location": "/#configure-advanced-settings_2", 
            "text": "Once you've completed the ELM installation, you should immediately log into the ELM and:  Change the  administrator password . (Optional) Configure  advanced network  options, such as Static IP, as needed. Make any changes required to the existing settings, for example, the  NTP servers  you use or the  Time Zone .  The Unidesk  Appliance Configuration utility  lets you configure these settings.", 
            "title": "Configure advanced settings"
        }, 
        {
            "location": "/#log-into-the-unidesk-management-console-umc_2", 
            "text": "In this article:  Log into the UMC Next step", 
            "title": "Log into the Unidesk Management Console (UMC)"
        }, 
        {
            "location": "/#install-the-unidesk-elm-in-nutanix-ahv", 
            "text": "Review the prerequisites and follow the steps to install the ELM in Nutanix AHV. You will then be able to log into the Unidesk Management Console (UMC) and complete the Unidesk setup.", 
            "title": "Install the Unidesk ELM in Nutanix AHV"
        }, 
        {
            "location": "/#unidesk-prerequisites-nutanix-ahv", 
            "text": "In this article:  OS requirements Storage requirements Nutanix Acropolis requirements", 
            "title": "Unidesk Prerequisites (Nutanix AHV)"
        }, 
        {
            "location": "/#nutanix-acropolis-requirements-for-installing-the-unidesk-elm", 
            "text": "If you are installing the Unidesk ELM and building your Layers on Acropolis VMs, or you are publishing Layered Images that will be used in a Acropolis environment, you need:  Acropolis account and privileges An existing or new Acropolis account to use for Unidesk. The account must have Acropolis privileges to: Create and remove virtual disks. Copy and delete layers on virtual disks using Acropolis file APIs. Nutanix Acropolis software and settings Access to the Acropolis Tools to install on the layer. Acropolis resource information The Acropolis info listed in  Acropolis Connector Configuration .", 
            "title": "Nutanix Acropolis requirements for installing the Unidesk ELM"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm-nutanix-ahv", 
            "text": "In this article:  Before you start Deploy the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV) Change the administrator password Configure advanced settings Expand locally attached storage, if needed Next Step", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM) (Nutanix AHV)"
        }, 
        {
            "location": "/#if-you-receive-the-error-cannot-create-uuid-from-string-undefined", 
            "text": "Ensure that you have waited for both tasks for each disk to be completed before attempting to create the VM.", 
            "title": "If you receive the error: \"Cannot create UUID from string \"undefined\"\""
        }, 
        {
            "location": "/#log-into-the-unidesk-management-console-umc_3", 
            "text": "In this article:  Log into the UMC Next step", 
            "title": "Log into the Unidesk Management Console (UMC)"
        }, 
        {
            "location": "/#install-the-unidesk-elm-in-vsphere", 
            "text": "Review the prerequisites for installing the Unidesk Enterprise Layer Manager in vSphere. Next, follow the steps to install the ELM on your vSphere server. You will then be able to log in to the Unidesk Management Console and complete the Unidesk setup.", 
            "title": "Install the Unidesk ELM in vSphere"
        }, 
        {
            "location": "/#unidesk-prerequisites-vsphere", 
            "text": "In this article:    Storage requirements vSphere requirements", 
            "title": "Unidesk Prerequisites (vSphere)"
        }, 
        {
            "location": "/#storage-requirements_4", 
            "text": "350-500 GB Storage Space The Unidesk ELM uses local storage for temporary files and finalized layers. The more layers you create, the more space you need. However, if you run low on space, you can expand the size of the current disk, or add other disks to the ELM when needed. 40-100 GB network file share (SMB/NFS) The file share connected to the ELM is used for upgrades, Elastic Layers, and cross-platform publishing. This space is easy to expand, if needed.", 
            "title": "Storage requirements"
        }, 
        {
            "location": "/#vsphere-prerequisites", 
            "text": "If you are installing the Unidesk ELM in vSphere and building your layers on vSphere VMs or publishing Layered Images to vSphere, you need:  Network access to Unidesk Tools download You need access from the Packaging Machine VM in vSphere to the Unidesk Tools download (available on the Unidesk Download page). vCenter account and privileges An existing or new vCenter account to use for Unidesk. The account must have vCenter privileges to: Create and remove VMDKs, and to copy and delete layers on VMDKs using vSphere file APIs (see detailed list of vCenter permissions below). Dedicated vCenter role for Unidesk (optional) To set up a new role: In the vSphere Client, navigate to  Home > Administration > Roles . Click  Add Role . Enter a name. Example:  UDAdmin . Set the privileges for this account. Privileges set for the vCenter role you are using for Unidesk  Add the required vCenter permissions (detailed permissions list below). Open the  Assign Permissions  window. In the vSphere Client, navigate to  Home > Inventory > Hosts and Clusters . Select your  vCenter , right-click, and select  Add permission .  In the Assign Permissions window, under Assigned Role, expand All Privileges. Select the permissions listed below, make sure that the  Propogate to Child Objects  check box is selected, and click  OK . displayed. The  Unidesk  role associated with the administrator account Associate the Unidesk role with the administrator account: Add the administrator account and assign the Unidesk role to it. Allow the permissions to propagate to the entire Datacenter. Note:  If you want to restrict this use from accessing specific folders in the Datacenter, grant the user more restrictive permissions for those folders. vCenter permissions Unidesk needs vCenter-level privileges to request information about the execution status of tasks. Without those privileges, Unidesk would consider the tasks failed. Expand  All Privileges , and each of the following... Then select... Datastore Allocate space Browse datastore Low level file operations Folder Create folder Delete folder Global Cancel task Host > Configuration System Management Network Assign network Resource Assign virtual machine to resource pool vApp Export Import vApp application configuration Virtual machine > Configuration Add existing disk Add new disk Add or remove device  Advanced Change CPU count Change resource  Configure managedBy Disk change tracking Memory Modify device settings Remove disk Rename Reset guest information Set annotation Settings Swapfile placement Upgrade virtual hardware Virtual machine > Interaction Answer question Configure CD media Console interaction Device connection Power off Power on Reset Suspend Virtual machine > Inventory Create from existing Create new Register Remove Unregister Virtual machine > Provisioning Clone template (optional, but required to use a vSphere template as the source VM) Clone virtual machine Customize Deploy template Mark as template Virtual machine > Snapshot management Create snapshot Remove Snapshot", 
            "title": "vSphere prerequisites"
        }, 
        {
            "location": "/#install-the-unidesk-enterprise-layer-manager-elm-vsphere", 
            "text": "In this article:  Before you start Deploy the Unidesk Enterprise Layer Manager (ELM) Expand locally attached storage, if needed Next Step", 
            "title": "Install the Unidesk Enterprise Layer Manager (ELM) (vSphere)"
        }, 
        {
            "location": "/#configure-advanced-settings_4", 
            "text": "Once you've completed the ELM installation, you should immediately log into the ELM and:  Modify the administrator password. (Optional) Configure advanced network options, such as Static IP, as needed. Make any changes required to the existing settings, for example, the NTP servers you use or the Time Zone.  The Unidesk Appliance Configuration utility lets you configure these settings. For details, click Manage the Unidesk ELM (virtual appliance) .", 
            "title": "Configure advanced settings"
        }, 
        {
            "location": "/#log-into-the-unidesk-management-console-umc_4", 
            "text": "In this article:  Log into the UMC Next step", 
            "title": "Log into the Unidesk Management Console (UMC)"
        }, 
        {
            "location": "/#set-up-unidesk", 
            "text": "Once the Unidesk Enterprise Layer Manager (ELM) is installed, complete these setup instructions before attempting to use the ELM.", 
            "title": "Set up Unidesk"
        }, 
        {
            "location": "/#before-you-start_5", 
            "text": "Install the Unidesk Enterprise Layer Manager (ELM)", 
            "title": "Before you start"
        }, 
        {
            "location": "/#set-up-the-unidesk-environment", 
            "text": "Obtain a Unidesk license Change the Administrator password Set up a network file share Open firewall ports for Unidesk, as needed Install the Unidesk Agent (required for PVS and Connector Scripts) Create a directory junction  Assign Unidesk Roles to users Enable Unidesk Labs features", 
            "title": "Set up the Unidesk environment"
        }, 
        {
            "location": "/#next-step_10", 
            "text": "Create Layers", 
            "title": "Next Step"
        }, 
        {
            "location": "/#obtain-a-unidesk-license", 
            "text": "In this article:  Register with Unidesk and log in Download the license Next step  To acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.", 
            "title": "Obtain a Unidesk license"
        }, 
        {
            "location": "/#change-the-administrator-password_1", 
            "text": "Use these steps to change the password for the original Administrator account created for the Unidesk Management Console (UMC).  Log into the Unidesk Management Console (UMC). Select  User > Administrators . In the list of Administrators select  Administrator  and click  Edit Properties . Enter the new password and type it again in the  Confirm Password  field. On the Confirm and Complete tab, click  Update User .", 
            "title": "Change the Administrator password"
        }, 
        {
            "location": "/#next-step_12", 
            "text": "Set up a network file share", 
            "title": "Next step"
        }, 
        {
            "location": "/#set-up-a-network-file-share", 
            "text": "In this article:  Network file share requirements and recommendations Create the network file share Configure Unidesk to access the file share Next step  The Unidesk ELM must be connected to a network file share.", 
            "title": "Set up a network file share"
        }, 
        {
            "location": "/#requirements", 
            "text": "When setting up the ELM's file share:  The file share must be configured using SMB or NFS technology. However, if you plan to use Elastic Layer assignments, you must use SMB protocol, as NFS technology is  not  supported when using Elastic Layers. The user credentials for the file share must have full permissions for that share. The share must be set up by the admin to be  readonly  for all users except for the one configured in the ELM. This secures the Layers and other files stored on the share. Ensure that you have the minimum storage space requirement of 40-100GB for your file share. Note:  Storage space is expandable, as you can add space to a disk, or other disks to the ELM.", 
            "title": "Requirements"
        }, 
        {
            "location": "/#recommendations", 
            "text": "For convenience, set up a Network File Share hosted in your hypervisor. For Azure:  Currently, the Unidesk ELM does not support the  Azure File Share feature . For best performance, it is best to create a file share server in Azure using a fast system with a Premium Disk, for example, a DS class machine.", 
            "title": "Recommendations"
        }, 
        {
            "location": "/#open-firewall-ports-for-unidesk-as-needed", 
            "text": "In this article:  Admin User Unidesk Enterprise Layer Manager Appliance Next step  The Unidesk ELM must be connected to a network file share.  The Unidesk installer opens ports that the Unidesk Enterprise Layer Manager (ELM) needs to interact with services on the virtual server where it is hosted. The default ports that Unidesk uses are listed in the tables below.  If there is a firewall between the Unidesk appliance and the machine on which you are running the Unidesk Agent or one of the Unidesk Connectors, you must manually open the port in the firewall used for that purpose. If during installation you changed any of the ports from the default setting, be sure to open the correct port.", 
            "title": "Open firewall ports for Unidesk, as needed"
        }, 
        {
            "location": "/#internal-connections", 
            "text": "By default, Unidesk uses the following ports in your firewall for internal connections between the Unidesk appliance and each of the destinations listed below.  Destination Activity Protocol Ports Unidesk ELM ActiveMQ Console TCP 8161 Unidesk ELM Log deliveries from the Unidesk Agent TCP 8787 Unidesk ELM Log deliveries from users TCP 8888 Unidesk ELM Communication with datastore via ESXI Host TCP 443 Unidesk Agent Communication TCP 8016 Unidesk Agent Log gathering TCP 14243 Active Directory LDAP TCP 389, 636 Connector for Azure Communication TCP 3000 (HTTP)  3500 (HTTPS) Connector for PVS Communication TCP 3009 (HTTP)  3509 (HTTPS) Connector for vSphere Communication TCP 3004 (HTTP) 3504 (HTTPS) Connector for XenServer Communication TCP 3002 (HTTP) 3502 (HTTPS)", 
            "title": "Internal Connections"
        }, 
        {
            "location": "/#external-connection", 
            "text": "By default, Unidesk uses the following port in your firewall for external connections between the Unidesk appliance and the destination listed below.  Destination Activity Protocol Ports api.unidesk.com Logs and Phone Home data uploads from the Unidesk ELM (optional) TCP 443", 
            "title": "External connection"
        }, 
        {
            "location": "/#os-image-xenserver-requirement", 
            "text": "Citrix XenServer uses Port 5900 for communications between your OS Image and XenCenter or other Xen client.  Destination Activity Protocol Ports XenCenter Communications   5900", 
            "title": "OS Image (XenServer requirement)"
        }, 
        {
            "location": "/#install-the-unidesk-agent-required-for-pvs-and-connector-scripts", 
            "text": "In this article:  About installing the Unidesk Agent Prerequisites Install the Unidesk Agent Register with the Unidesk ELM manually Next step", 
            "title": "Install the Unidesk Agent (required for PVS and Connector Scripts)"
        }, 
        {
            "location": "/#connect-to-a-directory-service", 
            "text": "In this article:  About connecting Unidesk to a directory service Create a directory junction Connect to a Directory Service  You can configure Unidesk to connect to a Directory Service, for example, Active Directory. When you connect to your directory service, you will create one or more Directory Junctions to access specific domains or OUs. Unidesk does  not   modify the directory service you connect to. The Unidesk software caches the attributes for each directory service entry, so that if the connection to the directory service is lost temporarily, the software can use the cached information for management tasks.", 
            "title": "Connect to a Directory Service"
        }, 
        {
            "location": "/#overlapping-directory-junctions", 
            "text": "Overlapping (or nested) Directory Junctions occur when you create multiple Directory Junctions that contain the same users and then import the users into the Unidesk directory tree. When overlapping occurs, each Directory Junction contains its own copy of the duplicate users.  Example: Overlapping directory junctions  Assume you create Directory Junction A that starts at the Marketing folder in a directory service tree. Next, you create Directory Junction B which starts at a folder above the Marketing folder. If you browse both Directory Junctions, you can see the Marketing users in both folders.", 
            "title": "Overlapping Directory Junctions"
        }, 
        {
            "location": "/#user-attributes-are-imported-from-the-directory-service", 
            "text": "The Unidesk software imports and caches user and group attributes from your directory service when:  You assign administrator privileges to a user. The values of the attributes change in the directory service.  The attributes that the Unidesk software caches are read only. All changes to the attributes for directory service users come from the directory server.", 
            "title": "User attributes are imported from the directory service"
        }, 
        {
            "location": "/#imported-attributes-are-synchronized-regularly", 
            "text": "The Unidesk software synchronizes the information it caches for directory service users with the directory service every 12 hours. If the software discovers that a user is no longer an object in the directory service, it classifies the user as abandoned (you can view this information in the Information view for the user).", 
            "title": "Imported attributes are synchronized regularly"
        }, 
        {
            "location": "/#next-step_16", 
            "text": "Assign Unidesk Roles to users", 
            "title": "Next step"
        }, 
        {
            "location": "/#assign-unidesk-roles-to-users", 
            "text": "In this article:  Unidesk Roles defined Assign Unidesk Roles to users Next step", 
            "title": "Assign Unidesk Roles to users"
        }, 
        {
            "location": "/#about-unidesk-users-roles-and-rights", 
            "text": "Built-in Administrator account  When you first install the Unidesk ELM (appliance) and log onto the Unidesk Management Console (UMC), there is a \"built-in\" Administrator account that you can use to get started. This Administrator has the rights to perform all Unidesk operations. You can edit this user's properties, including the name, password, and contact info. Be sure to change the password for this built-in Administrator account as part of installing and configuring the Unidesk ELM.  AD User accounts  Other than the built-in Administrator account, all Unidesk users are actually AD users imported via one or more directory junctions. Once your directory junction(s) have been created, you can assign Unidesk Roles to each user, as described later in this topic. You can see which roles are assigned to a user in the User Details.", 
            "title": "About Unidesk users, roles, and rights"
        }, 
        {
            "location": "/#rights-by-role", 
            "text": "Role Rights Administrator Can do every operation available in the UMC. Only users assigned the Administrator Role can edit user properties on the Users tab (Select  Users > Users ). Only administrators can configure ELM system settings. and manage licenses. Manage App Layers Can create, edit, and delete application layers and versions. Manage Elastic Layer Assignments Can add, update, and remove Elastic layer assignments. Manage Image Templates Can create, edit and delete Image templates. Can add, update, and remove app layer assignments for image templates. Can update platform layer assignments for image templates. Can update OS layer assignments for image templates. Manage OS Layers Can create, edit, and delete OS layers and versions. Manage Platform Layers Can create, edit, and delete Platform layers and versions. Publish Layered Images Can publish layered images. Cannot create or modify existing image templates. Read Only Can view information about any items in the UMC. Cannot launch any wizards or make any changes. The Read Only user cannot cancel any tasks.", 
            "title": "Rights by Role"
        }, 
        {
            "location": "/#user-credentials-for-logging-into-the-umc", 
            "text": "When you assign Unidesk Roles to Directory Service users, they can use their Directory Service credentials to log into the UMC.", 
            "title": "User credentials for logging into the UMC"
        }, 
        {
            "location": "/#enable-unidesk-labs-features", 
            "text": "In this article:  Welcome to Unidesk Labs Enable a Unidesk Labs feature Labs features in this release", 
            "title": "Enable Unidesk Labs features"
        }, 
        {
            "location": "/#enable-unidesk-labs-features_1", 
            "text": "In this article:  Welcome to Unidesk Labs Enable a Unidesk Labs feature Labs features in this release", 
            "title": "Enable Unidesk Labs features"
        }, 
        {
            "location": "/#upgrade-unidesk", 
            "text": "Are you upgrading the Unidesk ELM and Agent, or your Unidesk license?", 
            "title": "Upgrade Unidesk"
        }, 
        {
            "location": "/#upgrade-the-unidesk-elm-and-agent", 
            "text": "In this article:  Prerequisites Download the upgrade media to the Network File Share Load the Unidesk upgrade Upgrade the Unidesk Agent (PVS Servers only)", 
            "title": "Upgrade the Unidesk ELM and Agent"
        }, 
        {
            "location": "/#download-packages", 
            "text": "Platform Package Files included Citrix XenServer unidesk_upgrade_xenserver_pkg_4.x.x.zip upgrade_xenserver_elm_4.x.x.xx.vhd MS Azure unidesk_upgrade_azure_pkg_4.x.x.zip upgrade_azure_elm_4.x.x.xx.vhd MS Hyper-V unidesk_upgrade_hyperv_pkg_4.x.x.zip upgrade_hyperv_elm_4.x.x.xx.vhd VMware vSphere unidesk_upgrade_pkg_4.x.x.zip upgrade_vmware_elm_4.x.x.xx.vhd unidesk_agent_installer.exe Note:  A Unidesk Agent upgrade is only required if you've installed the agent for your implementation, for example, if you are using PVS, or Connector Scripts.", 
            "title": "Download Packages"
        }, 
        {
            "location": "/#back-up-the-unidesk-elm", 
            "text": "Take a snapshot or checkpoint of the Unidesk ELM.", 
            "title": "Back up the Unidesk ELM"
        }, 
        {
            "location": "/#update-your-unidesk-license", 
            "text": "In this article:  Log into the Unidesk site Update your Unidesk license (with web access to the ELM) Update your Unidesk license (without web access to the ELM))  To acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.", 
            "title": "Update your Unidesk license"
        }, 
        {
            "location": "/#unidesk-glossary", 
            "text": "This section contains terminology across all platforms and operating systems that Unidesk supports. Note that some of the terms may not pertain to your specific environment.  A  App Layer  A virtual disk containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.  C  Connector  Connectors are the interfaces to environments where layers are created and images are published. The type of platform connector determines the information required to create a specific Connector Configuration.  Connector Configuration  A stored set of values for connecting to a specific environment. A configuration typically includes credentials for authentication, a storage location, and any other information required to interface with the environment where you will be creating layers or publishing images.  D  Directory Junction  A connection to a base Distinguished Name in a directory service (such as Microsoft Active Directory). Adding a Directory Junction to the local tree allows you to assign Administrator privileges to users that are defined in the directory service instead of in the Unidesk Management Console.  Directory service  A hierarchical repository of information about users, devices and services on a network server. Microsoft Active Directory and LDAP are examples of directory services.  Directory service user  A user whose attributes reside in a remote directory service but is also visible in the Unidesk environment through the use of a directory junction. You can assign Unidesk Administrator privileges to users.  Directory tree  A view of data in a hierarchical, tree-like structure. The Unidesk directory tree contains entries for users, groups, containers, and Virtual Machines. You can extend this view by adding connections to a remote directory service, such as Active Directory.  E  Elastic Layer  A Unidesk App Layer that the Unidesk administrator can deliver based on user entitlements when users log onto sessions or standalone desktops. Elastic Layers allow administrators to give each user his/her own unique set of applications, on top of the base Layered Image used across sessions (in the case of session hosts), and across floating pools/shared groups (in the case of desktops). This can drastically reduce the number of base Layered Images that administrators need to maintain.  Enterprise Layer Manager (ELM)  A virtual appliance that coordinates communication in the Unidesk environment, and hosts the Unidesk Management Console (UMC), the administrator interface for the Unidesk environment. The ELM also manages copies of all Layers.  I  Image Template  An Image Template saves the OS Layer, App Layer, and Platform Layer assignments you have chosen for a Layered Image, allowing you to use any combination of layers to provision any number of servers.  L  Layer  A Unidesk layer captures a Windows Operating System, a Windows Application, or the configuration settings and tools required for Images to run on a particular platform in a virtual disk that can be combined with other layers to create a Layered Image. Layers are created from a simple install of the application or operating system. You can select any combination of Layers for each Layered Image. You can reuse the same layers in any combination to provision a variety of servers.  Layered Image  A bootable image composited from an OS Layer, a Platform Layer, and any number of App Layers. Layered Image(s) are published using Image Templates where you save your layer selections for a particular use, usually provisioning servers in a specific silo.  Layering Management Console (LMC)  The Web-based management console that runs on the Enterprise Layer Manager (ELM). This console allows you to manage the App Layering components in your environment. You can use is to create Layers, publish Layered Images, and manage system settings.  Local Storage  A Layer repository where the ELM creates, composites, and stores Layers and Layered Images. Local storage is used for temporary files during the creation of Layers and Layered Images, and for persistent files, for example, Layers and Image Templates. Administrators can define the Network File Share location that will be used for Elastic Layers in the UMC's System and Settings.  O  OS Disk  The virtual disk containing the Operating System that is imported to create an OS layer. To prepare the OS disk you will install and configure an Operating System on a virtual machine and install the Unidesk tools. The OS Disk is the virtual disk where the Operating System was installed.  OS Layer  A virtual disk containing the operating system. You can use an OS Layer with any compatible App Layers in any number of Layered Images. You can create a new Version of the OS Layer for every patch you need to roll out, and continue deploying every and all versions of the layer as you add patches.  OS Machine  The Operating System (OS) Machine is a virtual machine that you create from which you can generate an OS Disk and an OS Layer.  P  Packaging Disk  A bootable virtual disk used to create a Packaging Machine needed for creating or updating a Layer. The Packaging Disk always includes your OS Layer and may also include selected Application and Platform Layers.  Packaging Machine  A virtual machine that acts as a staging area for the creation of App Layers, App Layer Versions, and OS Layer Versions. The Packaging Machine is booted from a Packaging Disk using the credentials and location specified in the selected Connector Configuration.  Platform Layer  A layer that includes configuration settings, tools, and other software required for Images to run on a particular platform. For example, a platform layer for vSphere would include vmTools. Platform Layers also remove leftover software from other platforms from your image.  Prerequisite Layer  An application that is required when installing another application for a new Application Layer or Layer Version. For example, you would select your Microsoft Office App Layer as a Prerequisite Layer when installing a Microsoft Office plugin in a separate App Layer. Or, you would select your Java App Layer as a Prerequisite Layer when creating a Layer for an application that requires Java.  S  Session Container  A Citrix technology that allows different users logged into the same Session Host to be assigned different versions of the same Elastic Layer, and ensures that those Layer versions do not conflict.", 
            "title": "Unidesk Glossary"
        }, 
        {
            "location": "/#test-drive-publish-to-citrix-xenserver", 
            "text": "Once Unidesk is set up, you can use this test drive to create your first layers in XenServer, and then publish a test image to Citrix PVS. This example uses Windows Server 2012, Citrix PVS 7, and Citrix XenApp 7.  Please download the Test Drive from this Unidesk  forum article .  If you have any questions, please ask your Unidesk Solutions Architect for assistance.", 
            "title": "Test drive: Publish to Citrix XenServer"
        }, 
        {
            "location": "/#test-drive-publish-to-pvs-xenapp-7-in-vsphere", 
            "text": "In this article:  Platforms used in this test drive Components you will create Prerequisites Publish a test image with an OS Layer and a Platform Layer Add your first App Layer and republish the Layered Image", 
            "title": "Test drive: Publish to PVS, XenApp 7 in vSphere"
        }, 
        {
            "location": "/#test-drive-publish-to-pvs-for-xenapp-65-users", 
            "text": "Once Unidesk is set up, you can use this test drive to create your first layers in vSphere, and then publish a test image to Horizon View. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.  Please download the Test Drive from this Unidesk  forum article .  If you have any questions, please ask your Unidesk Solutions Architect for assistance.", 
            "title": "Test drive: Publish to PVS for XenApp 6.5 users"
        }, 
        {
            "location": "/#test-drive-publish-to-mcs-for-nutanix-ahv", 
            "text": "Once Unidesk is set up, you can use this test drive to create your first layers in Nutanix AHV, and then publish a test image to Citrix MCS. This example uses Windows 10 64-bit, Citrix MCS, and Citrix XenDesktop 7.  Please download the Test Drive from this Unidesk  forum article .  If you have any questions, please ask your Unidesk Solutions Architect for assistance.", 
            "title": "Test drive: Publish to MCS for Nutanix AHV"
        }, 
        {
            "location": "/#test-drive-publishing-to-azure-rdsh", 
            "text": "In this article:  Platforms used in this test drive Components you will create Prerequisites Publish a test image with an OS Layer and a Platform Layer Add your first App Layer and republish the Layered Image", 
            "title": "Test drive: Publishing to Azure RDSH"
        }, 
        {
            "location": "/#test-drive-publish-to-vmware-horizon-view", 
            "text": "Once Unidesk is set up, you can use this test drive to create your first layers in vSphere, and then publish a test image to Horizon View. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.  Please download the Test Drive from this Unidesk  forum article .  If you have any questions, please ask your Unidesk Solutions Architect for assistance.", 
            "title": "Test drive: Publish to VMware Horizon View"
        }, 
        {
            "location": "/#test-drive-publish-to-microsoft-rds-in-hyper-v", 
            "text": "Once Unidesk is set up, you can use this test drive to create your first layers in Hyper-V, and then publish a test image to MS RDS. With this first experience will come an understanding of the layering work flow, and relatively easy image maintenance.  Please download the Test Drive from this Unidesk  forum article .  If you have any questions, please ask your Unidesk Solutions Architect for assistance.", 
            "title": "Test drive: Publish to Microsoft RDS in Hyper-V"
        }, 
        {
            "location": "/#layer-essentials", 
            "text": "In this article:  OS Layers Platform Layers App Layers User Layers (Unidesk Labs) Verifying Layers", 
            "title": "Layer Essentials"
        }, 
        {
            "location": "/#platform-layer-for-packaging-layers-and-versions", 
            "text": "The only time you need a Platform Layer for  Packaging   layers is when your OS image was created on a different hypervisor than the one where you are building your other layers. When  creating an App Layer or Layer Version  , or OS Versions, the purpose of the Platform Layer is to ensure that any hypervisor-related software and settings are available during the installation of the application(s) on that layer, if needed. If you choose to use a Platform Layer for Packaging a layer, the hypervisor-related software will only be used during layer packaging, and has  no effect   on where you can  publish   the layer as part of a Layered Image.", 
            "title": "Platform Layer for packaging layers and versions"
        }, 
        {
            "location": "/#platform-layer-for-publishing-layered-images", 
            "text": "A Platform Layer for  Publishing   is  required   when you publish Layered Images. The purpose of the Platform Layer for Publishing is to include the settings and software that the Layered Image needs to be  deployed in your environment  . When creating a Platform Layer for Publishing, Unidesk removes unselected (and unnecessary) tools and software related to the platforms you are  not   publishing to. This is to prevent any unnecessary platform software from slowing down the Layered Image when it runs in the target environment.", 
            "title": "Platform Layer for publishing Layered Images"
        }, 
        {
            "location": "/#create-layers", 
            "text": "Once Unidesk is installed and set up, you can install your software in Layers.", 
            "title": "Create Layers"
        }, 
        {
            "location": "/#before-you-start_6", 
            "text": "Install the Unidesk Enterprise Layer Manager (ELM)  Set up Unidesk", 
            "title": "Before you start"
        }, 
        {
            "location": "/#install-your-software-in-reusable-unidesk-layers", 
            "text": "Create an OS Layer Create a Platform Layer Create an App Layer", 
            "title": "Install your software in reusable Unidesk Layers"
        }, 
        {
            "location": "/#next-step_18", 
            "text": "Publish a Layered Image", 
            "title": "Next Step"
        }, 
        {
            "location": "/#create-and-update-os-layers", 
            "text": "Start by preparing your OS image for use in Unidesk, then import it to create your OS Layer. Then use the instructions listed below to update the layer.", 
            "title": "Create and update OS Layers"
        }, 
        {
            "location": "/#prepare-an-os-image", 
            "text": "On which platform are you preparing the OS?", 
            "title": "Prepare an OS image"
        }, 
        {
            "location": "/#prepare-the-os-image-vsphere", 
            "text": "This topic explains how to prepare an OS Image for the Unidesk environment, using the  OS Machine Tools   available for download on the Unidesk  Download  page.  Notes:  The OS Image should  not  be in a domain. The OS Image should get its IP address from DHCP. Using Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image. Ensure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools. The Paravirtual SCSI controller is  not  supported. You must use the default controller (SCSI BusLogic) for the OS to be functional. Unidesk supports the LSI Logic SAS controller type. If you subsequently change the SCSI controller type to anything else, such as VMware Paravirtual SCSI controller, the OS Layer import will fail.", 
            "title": "Prepare the OS Image (vSphere)"
        }, 
        {
            "location": "/#which-operating-system-are-you-using", 
            "text": "Choose the operating system you are using for the OS Image:  Windows Server 2012 R2 (Session Host) Windows Server 2008 R2 Windows 10 Windows 7", 
            "title": "Which operating system are you using?"
        }, 
        {
            "location": "/#step-5-if-using-pvs-follow-these-steps-to-avoid-ghost-nics", 
            "text": "Install KB2550978 hotfix. Reboot the VM, Enter the commands: set devmgr_show_nonpresent_devices=1devmgmt.msc Remove any ghost NICs. Reboot the system.", 
            "title": "STEP 5: If using PVS, follow these steps to avoid ghost NICs"
        }, 
        {
            "location": "/#prepare-the-os-image-azure", 
            "text": "This topic explains how to prepare an OS Image for the Unidesk environment.", 
            "title": "Prepare the OS Image (Azure)"
        }, 
        {
            "location": "/#step-1-set-up-a-windows-server-2012-r2-os-image-on-a-virtual-machine_1", 
            "text": "In the Azure Portal, create a new VM from the \"Windows Server Remote Desktop Session Host Windows Server 2012 R2\" image ( New > Compute > Virtual Machine > From Gallery > Windows Server Remote Desktop Session Host Windows Server 2012 R2 ). When specifying the Size of the virtual machine, we recommend you select A2 or larger. Important:  When specifying the Cloud Service, select the same Cloud Service that contains your [[[Undefined variable Unidesk.MA]]]. Select the same Storage Account that contains your appliances, unless your appliances are in  Premium Storage , in which case you must use a  Standard Storage  group. Log into the new VM, open a Windows PowerShell window, and run the  Enable-PSRemoting  command. Restart the new VM.", 
            "title": "STEP 1: Set up a Windows Server 2012 R2 OS Image on a virtual machine"
        }, 
        {
            "location": "/#step-2-apply-windows-updates", 
            "text": "Apply all Windows Updates to the image so that it is at the most current Microsoft patch level and complete any reboot processes that Windows Updates may require.", 
            "title": "STEP 2: Apply Windows Updates"
        }, 
        {
            "location": "/#step-3-copy-the-unidesk-tools-onto-the-os-image", 
            "text": "Copy the Unidesk_OS_Machine_Tools RAR file onto the OS Image. You can find these tools in the Unidesk Download center. Run the RAR file. This copies the tools to the C:windows\\setup\\scripts directory.", 
            "title": "STEP 3: Copy the Unidesk Tools onto the OS Image"
        }, 
        {
            "location": "/#step-4-install-the-unidesk-tools-onto-the-os-image", 
            "text": "In the c:\\Windows\\Setup\\Scripts folder, run Unidesk setup_x64.exe.      The installation prompts for the location of the Management Appliance  IP address  and the location of the unattend.xml file (the default location is c:\\windows\\panther). Note: Do  not  run the UnattendBuilder included with the tools.", 
            "title": "STEP 4: Install the Unidesk tools onto the OS Image"
        }, 
        {
            "location": "/#step-5-run-ngen", 
            "text": "About Microsoft NGen operations  NGen is the Microsoft \"Native Image Generator\". It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.  Force an NGen operation to the foreground  Normally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible.  Open a command prompt as Administrator. Go to the Microsoft .NET Framework directory for the version currently in use: cd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX Enter the NGen command to execute the queued items: ngen update /force This brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled. Ensure that all NGen processes have run to completion. Optionally, you can now shut down the OS Image VM.  Once you have completed these steps, you are ready to  create a Unidesk Operating System Layer .", 
            "title": "STEP 5: Run NGen"
        }, 
        {
            "location": "/#prepare-the-os-image-nutanix-ahv", 
            "text": "This topic explains how to prepare an OS Image for the Unidesk environment, using the  OS Machine Tools   available for download on the Unidesk  Download  page.  Notes:  The OS Image should  not  be in a domain. The OS Image should get its IP address from DHCP. Ensure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools. Using Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image.", 
            "title": "Prepare the OS Image (Nutanix AHV)"
        }, 
        {
            "location": "/#which-operating-system-are-you-using_1", 
            "text": "Choose the operating system you are using for the OS Image:  Windows Server 2016 (Session Host) Windows Server 2012 R2 (Session Host) Windows Server 2008 R2  Windows 10 Windows 7", 
            "title": "Which operating system are you using?"
        }, 
        {
            "location": "/#step-5-if-using-pvs-follow-these-steps-to-avoid-ghost-nics_1", 
            "text": "Install KB2550978 hotfix. Reboot the VM, Enter the commands: set devmgr_show_nonpresent_devices=1devmgmt.msc Remove any ghost NICs. Reboot the system.", 
            "title": "STEP 5: If using PVS, follow these steps to avoid ghost NICs"
        }, 
        {
            "location": "/#prepare-the-os-image-xenserver", 
            "text": "This topic explains how to prepare an OS Image for the Unidesk environment, using the  OS Machine Tools   available for download on the Unidesk  Download  page.  Notes:  The OS Image should  not  be in a domain. The OS Image should get its IP address from DHCP. Using Third-party optimization scripts can have adverse effects in Unidesk, as they can change services and features that Unidesk uses, for example, Universal Plug and Play and the 8.3 file names setting. Use the optimization tools in the Unidesk Installer download to optimize your image. Ensure that the VM for your OS Layer is MBR partitioned, rather than GPT partitioned. Otherwise, you will not be able to install the Unidesk OS Machine Tools. XenCenter uses Port 5900 to access the console on each VM. Make sure that this port is open on your OS image. Otherwise, the packaging machines or publish images the console will not work until you reboot the VM.", 
            "title": "Prepare the OS Image (XenServer)"
        }, 
        {
            "location": "/#which-operating-system-are-you-using_2", 
            "text": "Choose the operating system you are using for the OS Image:  Windows Server 2012 R2 (Session Host) Windows Server 2008 R2  Windows 10 Windows 7", 
            "title": "Which operating system are you using?"
        }, 
        {
            "location": "/#step-5-if-using-pvs-follow-these-steps-to-avoid-ghost-nics_2", 
            "text": "Install KB2550978 hotfix. Reboot the VM, Enter the commands: set devmgr_show_nonpresent_devices=1devmgmt.msc Remove any ghost NICs. Reboot the system.", 
            "title": "STEP 5: If using PVS, follow these steps to avoid ghost NICs"
        }, 
        {
            "location": "/#create-an-os-layer", 
            "text": "Where are you importing the OS from?", 
            "title": "Create an OS Layer"
        }, 
        {
            "location": "/#create-an-os-layer-vsphere", 
            "text": "In this article:  Before you start Prepare your OS Image Import the OS Image into a new OS Layer Reference: Create OS Wizard values  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.  To create an OS Layer, you need to create a virtual machine in vSphere to serve as the OS Machine, download the OS to a network file share, and then import theOS into Unidesk to create the OS Layer.", 
            "title": "Create an OS Layer (vSphere)"
        }, 
        {
            "location": "/#create-an-os-layer-azure", 
            "text": "In this article:  Before you start Create an OS Machine in Azure Prepare the OS Image (Windows 2012 R2) Import the OS Image into a new OS Layer  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you need.  The OS Layer is created using a virtual machine in your infrastructure and the Windows Operating System that you want to use for your Layered Images. You can import the OS from your Azure environment or from the Network File Share attached to the Unidesk ELM.  Note:   The OS image  must   be created from a Microsoft ISO, rather than an existing template.", 
            "title": "Create an OS Layer (Azure)"
        }, 
        {
            "location": "/#create-an-os-layer-nutanix-ahv", 
            "text": "In this article:  Before you start Import the OS Image into a new OS Layer  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the  supported  Windows OS that you use for your Layered Images.  To create an OS Layer, you create a virtual machine in Nutanix AHV to serve as the OS Machine, and import it into the new OS Layer.", 
            "title": "Create an OS Layer (Nutanix AHV)"
        }, 
        {
            "location": "/#create-an-os-layer-xenserver", 
            "text": "In this article:  Before you start Prepare your OS Image Import the OS Image into a new OS Layer  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.  To create an OS Layer, you create a virtual machine in XenServer to serve as the OS Machine, then export the OS to the ELM's network file share, and import the OS into Unidesk to create the OS Layer.", 
            "title": "Create an OS Layer (XenServer)"
        }, 
        {
            "location": "/#create-an-os-layer-network-file-share", 
            "text": "In this article:  Create an OS Machine Prepare the OS Import the OS Disk  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images. You can import the OS from the Network File Share attached to the Unidesk ELM.", 
            "title": "Create an OS Layer (network file share)"
        }, 
        {
            "location": "/#add-a-version-to-an-os-layer", 
            "text": "Where are you creating this App Layer Version?", 
            "title": "Add a version to an OS Layer"
        }, 
        {
            "location": "/#add-a-version-to-an-os-layer-xenserver", 
            "text": "In this article:  Before you start  Add a Version to an OS Layer Deploy a Packaging Machine Install your changes Verify the Layer and shut down the Packaging Machine Finalize the OS Layer Reference: Create OS Version Wizard values  The Unidesk OS Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.", 
            "title": "Add a version to an OS Layer (XenServer)"
        }, 
        {
            "location": "/#add-a-version-to-an-os-layer-azure", 
            "text": "In this article:  Before you start   Add a Version to an OS Layer  Deploy a Packaging Machine  Install your changes  Verify the Layer and shut down the Packaging Machine  Finalize the OS Layer  Reference: Create OS Version Wizard values  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.", 
            "title": "Add a version to an OS Layer (Azure)"
        }, 
        {
            "location": "/#azure-environment", 
            "text": "To deploy your Packaging Machine to Azure:  Click the link (shown in red below) in the Unidesk Management Console task to open the Azure portal to the Custom deployment area where you can create the virtual machine that you will use as your Unidesk Packaging Machine. Note:  We recommend that you log into the Microsoft Azure account that has the same Subscription before clicking the link or pasting it into a browser. Complete the required fields for customizing your Azure parameters.  Notes:    Unidesk does not recommend using less than two CPUs for the Packaging Machine. Consequently, the machine size must be at least A2. On the Custom deployment panel, ensure that the value for the Resource Group location matches the Storage location you specified earlier.", 
            "title": "Azure environment"
        }, 
        {
            "location": "/#add-a-version-to-an-os-layer-nutanix-ahv", 
            "text": "In this article:  Before you start  Add a Version to an OS Layer Deploy a Packaging Machine Install your changes Verify the Layer and shut down the Packaging Machine Finalize the OS Layer Reference: Create OS Version Wizard values  The Unidesk OS Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.", 
            "title": "Add a version to an OS Layer (Nutanix AHV)"
        }, 
        {
            "location": "/#access-the-packaging-machine-in-nutanix-ahv", 
            "text": "Log into Nutanix Prism. Back in the Unidesk Management Console (UMC), expand the Tasks bar at the bottom of the UI, and double-click the  Create Platform Layer  task to see the full Task Description (example below). Use the instructions in the Task Description to navigate to the Packaging Machine in Prism. Install the app for your Layer. This may require a reboot as part of the installation. Once complete, you should see that you have access to the tools, as well as all of the  data  available under the Performance tab for your VM.", 
            "title": "Access the Packaging Machine in Nutanix AHV"
        }, 
        {
            "location": "/#add-a-version-to-an-os-layer-vsphere", 
            "text": "In this article:  Before you start   Add a Version to an OS Layer  Deploy a Packaging Machine  Install your changes  Verify the Layer and shut down the Packaging Machine  Finalize the OS Layer  Reference: Create OS Version Wizard values  The Unidesk Operating System (OS) Layer contains the Windows Operating System that is assigned to any Unidesk Layered Images you create using that OS Layer. Once created, you can use the OS Layer to build as many Layered Images as you want.  The OS Layer includes a virtual machine in your infrastructure running the Unidesk-supported Windows Operating System that you want to use for your Layered Images.", 
            "title": "Add a version to an OS Layer (vSphere)"
        }, 
        {
            "location": "/#create-a-platform-layer", 
            "text": "Which  Connector   are you using to create this Platform Layer?  For more about Platform Layers, see  Layer Essentials: Platform Layers", 
            "title": "Create a Platform Layer"
        }, 
        {
            "location": "/#create-a-platform-layer-azure-connector", 
            "text": "In this article:  Create a Platform Layer (Azure connector) Prepare a new Platform Layer Deploy a Packaging Machine Install the platform software Verify the Layer and shut down the Packaging Machine Finalize the Layer  A Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.", 
            "title": "Create a Platform Layer (Azure connector)"
        }, 
        {
            "location": "/#prerequisites_5", 
            "text": "When creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the  type   of Platform Layer you choose to create.  Type of Platform Layer Prerequisites Publishing Layered Images Software installers, and settings you use for your: Hypervisor Provisioning service Connection broker Packaging Layers The software and settings for your: Hypervisor For example, your hypervisor installer and settings. Note:  You only need a Platform Layer for  packaging  Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#deploy-a-packaging-machine-to-azure", 
            "text": "The Task Description (example shown in the last step above) contains a link to the location in the Azure portal where the Packaging Machine for this Layer has been published.  To create your Packaging Machine in Azure, begin with the expanded Packaging Disk Task shown in the last step above.  Log into the Azure portal (https://portal.azure.com) from your web browser. In the expanded Packaging Disk Task shown below, copy the full URL and paste it into the web browser where you logged into the Azure portal. This opens the Microsoft Azure portal to the  Custom deployment  template where you can create the virtual machine that you will use as your Unidesk Packaging Machine. Note:  We recommend copying the full URL instead of using the Click  here  link. On the Custom deployment panel, complete the required fields for customizing your Azure parameters. Packaging Machine Name - must conform to Azure VM name requirements. Size - the Azure VM size of the packaging machine. Virtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine. IMPORTANT: Be sure that the value for the  Resource group location  matches the  Storage account location  that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.", 
            "title": "Deploy a Packaging Machine to Azure"
        }, 
        {
            "location": "/#create-a-platform-layer-citrix-mcs-for-vsphere", 
            "text": "In this article:    Prepare a new Platform Layer Deploy a Packaging Machine Create a Platform Layer (Citrix MCS for vSphere) Verify the Layer and shut down the Packaging Machine Finalize the Layer  A Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to Citrix MCS in vSphere with XenApp as the broker would include the MCS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).  This article explains the next steps to create a Platform Layer, based on your connector and platform choices. If you need more information than is included here, check these other Unidesk sources:  Layer essentials (Unidesk Learning Center)  and the  Unidesk Forum .  A Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - A Platform Layer for  publishing  is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - A Platform Layer for  packaging  is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.", 
            "title": "Create a Platform Layer (Citrix MCS for vSphere)"
        }, 
        {
            "location": "/#prerequisites_6", 
            "text": "When creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the  type   of Platform Layer you choose to create.  Type of Platform Layer Prerequisites Publishing Layered Images Software installers, and settings you use for your: Hypervisor Provisioning service Connection broker Packaging Layers The software and settings for your: Hypervisor For example, your hypervisor installer and settings. Note:  You only need a Platform Layer for  packaging  Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#citrix-mcs-prerequisites", 
            "text": "When creating a Platform Layer for publishing images to an MCS environment, you need:  An OS Layer Network access to Unidesk Tools Access from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page). Citrix Virtual Delivery Agent (VDA) installed on the Platform Layer The Citrix VDA installer for the Windows OS you are using must be installed on the Platform Layer. Citrix Desktop Delivery Controller (DDC) The Citrix DDC software must be installed on the server where the Layered Image will be published. As part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the following: Unidesk Agent  - Installed and running on the DDC. This allows Unidesk to run the script on the DDC. PowerShell Snap-in  - Appropriate PowerShell Snap-in must be installed on the DDC. Citrix resource information The Citrix info listed in this  MCS Connector Configuration  topic.", 
            "title": "Citrix MCS prerequisites"
        }, 
        {
            "location": "/#log-into-the-packaging-machine", 
            "text": "The Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.  Log into your vSphere web client. Back in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine. Power on the Packaging Machine.", 
            "title": "Log into the Packaging Machine"
        }, 
        {
            "location": "/#install-the-required-platform-tools", 
            "text": "This section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.", 
            "title": "Install the required platform tools"
        }, 
        {
            "location": "/#platform-software-to-install", 
            "text": "You need the installers for your hypervisor, provisioning service, and connection broker.  If you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.  Keep in mind that the state of the software before you finalize the layer is what the image will use.  Remote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS. Install the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed. If a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically. Make sure the Packaging Machine is in the state you want it to be in when the image is booted: If the tools you install require any post-installation setup or registration, complete those steps now. Remove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.  Next, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.  Verify the Layer and shut down the Packaging Machine  Once the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.  To verify that any outstanding processes are complete, you can run the  Shutdown For Finalize   tool (icon below), which appears on the Packaging Machine's desktop.  To use the Shutdown For Finalize tool:  If you are not logged into the Packaging Machine, remote log in as the user who created the machine. Double-click the  Shutdown For Finalize  icon. A command line window displays messages detailing the layer verification process. If there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed  below . Once any pending operations are complete, double-click the  Shutdown For Finalize  icon again. This shuts down the Packaging Machine.  The Layer is now ready to finalize.", 
            "title": "Platform software to install"
        }, 
        {
            "location": "/#finalize-the-layer_1", 
            "text": "Once the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.  Note:   When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.  When the Layer has been verified and is ready to finalize:  Return to the Unidesk Management Console. Select  Layers >App Layers , and then the layer you just prepared. Select  Finalize  in the Action bar.  Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.", 
            "title": "Finalize the Layer"
        }, 
        {
            "location": "/#create-a-platform-layer-citrix-mcs-for-nutanix-ahv", 
            "text": "In this article:  Prerequisites Prepare a new Platform Layer Install the required platform tools Verify the Layer and shut down the Packaging Machine Finalize the Layer  For cross-platform deployments, a Platform Layer includes the platform software and settings required to deploy images in your environment.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Use this type of Platform Layer when publishing Layered Images to a platform other than the one where you created the OS Layer. Platform Layers for  packaging Layers  (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment. Use this type of Platform Layer when creating Layers on a platform other than the one from which you imported the OS for your OS Layer.", 
            "title": "Create a Platform Layer (Citrix MCS for Nutanix AHV)"
        }, 
        {
            "location": "/#citrix-mcs-prerequisites_1", 
            "text": "When creating a Platform Layer for publishing images to an MCS environment, you need:  An OS Layer Network access to Unidesk Tools Access from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page). Citrix Virtual Delivery Agent (VDA) installed on the Platform Layer The Citrix VDA installer for the Windows OS you are using must be installed on the Platform Layer. Citrix Desktop Delivery Controller (DDC) The Citrix DDC software must be installed on the server where the Layered Image will be published. As part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the following: Unidesk Agent  - Installed and running on the DDC. This allows Unidesk to run the script on the DDC. PowerShell Snap-in  - Appropriate PowerShell Snap-in must be installed on the DDC. Citrix resource information The Citrix info listed in this  MCS Connector Configuration  topic.", 
            "title": "Citrix MCS prerequisites"
        }, 
        {
            "location": "/#nutanix-ahv-acropolis-prerequisites", 
            "text": "Nutanix Prism account and privileges A Nutanix Prism account (new or existing) to use for Unidesk. The account must have privileges to perform the following operations: VM operations: clone delete power on/off attach virtual disks Image operations: create update (aka upload) delete Virtual disks create attach to VMs Nutanix AHV software and settings Access to the VM Mobility Tools to install on the layer. Nutanix AHV resource information The Acropolis Server info listed in  Nutanix AHV Connector Configuration  or  MCS for Nutanix AHV Connector Configuration . Nutanix AHV Connector   When creating Layers for the Nutanix environment, you must use a Nutanix AHV Connector Configuration. The MCS for Nutanix AHV Connector does not support Layer creation.", 
            "title": "Nutanix AHV (Acropolis) prerequisites"
        }, 
        {
            "location": "/#create-a-platform-layer-pvs", 
            "text": "In this article:  Before you start Prepare a new Platform Layer Deploy a Packaging Machine Create a Platform Layer (PVS) Verify the Layer and shut down the Packaging Machine Finalize the Layer  A Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.  To create a Platform Layer you prepare the layer using the Create Platform Layer wizard, deploy a Packaging Machine in your environment, install the tools and configure the settings for PVS, and finalize the Layer.", 
            "title": "Create a Platform Layer (PVS)"
        }, 
        {
            "location": "/#platform-layer-prerequisites", 
            "text": "An OS Layer", 
            "title": "Platform Layer Prerequisites"
        }, 
        {
            "location": "/#pvs-prerequisites", 
            "text": "IPv6 must be  disabled  on the OS Layer.   If IPv6 is not disabled on your OS Layer, add a new Version to the OS Layer and disable IPv6 in the new Version. IMPORTANT:  If you disable IPv6 on the  Platform Layer  instead of on the  OS Layer , the resulting PVS machines will lose their network connection and hang when they are booted. Unidesk Agent The Unidesk Agent must be installed on all PVS servers used to access the PVS servers to which you will publish images. (Each Agent must be registered wit the Unidesk ELM.) PVS servers where the Unidesk Agent is installed The PVS Console must be installed on all PVS servers where the Unidesk Agent is installed. PVS Target Device Imaging software The PVS Target Device Imaging software must be available to install on the Platform Layer. The version must match the PVS server where the Layered Image will be published. PVS resource information The PVS info listed in this  PVS Connector Configuration  topic. PowerShell Snap-in Appropriate PowerShell Snap-in must be installed. Unique CMID for each target device (if using KMS) When using KMS licensing, PVS requires that each target device has a unique CMID. For the full story, check out this Citrix article,  Demystifying KMS and Provisioning Services . Rearming KMS is covered in the steps to Create a Platform Layer. Any additional PVS settings you use in your environment Any settings you need to configure PVS on your Platform Layer so that it matches the environment where the Layered Image will be used.", 
            "title": "PVS Prerequisites"
        }, 
        {
            "location": "/#required-tools-and-settings", 
            "text": "Unidesk Tools download PVS settings KMS settings", 
            "title": "Required Tools and Settings"
        }, 
        {
            "location": "/#log-into-the-packaging-machine_1", 
            "text": "The Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.  Log into your vSphere web client. Back in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine. Power on the Packaging Machine.", 
            "title": "Log into the Packaging Machine"
        }, 
        {
            "location": "/#install-the-required-platform-tools_2", 
            "text": "This section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.", 
            "title": "Install the required platform tools"
        }, 
        {
            "location": "/#platform-software-to-install_1", 
            "text": "You need the installers for your hypervisor, provisioning service, and connection broker.  If you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.  Keep in mind that the state of the software before you finalize the layer is what the image will use.  Remote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS. Install the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed. If a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically. Make sure the Packaging Machine is in the state you want it to be in when the image is booted: If the tools you install require any post-installation setup or registration, complete those steps now. Remove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.  Next, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.  Verify the Layer and shut down the Packaging Machine  Once the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.  To verify that any outstanding processes are complete, you can run the  Shutdown For Finalize   tool (icon below), which appears on the Packaging Machine's desktop.  To use the Shutdown For Finalize tool:  If you are not logged into the Packaging Machine, remote log in as the user who created the machine. Double-click the  Shutdown For Finalize  icon. A command line window displays messages detailing the layer verification process. If there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed  below . Once any pending operations are complete, double-click the  Shutdown For Finalize  icon again. This shuts down the Packaging Machine.  The Layer is now ready to finalize.", 
            "title": "Platform software to install"
        }, 
        {
            "location": "/#finalize-the-layer_3", 
            "text": "Once the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.  Note:   When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.  When the Layer has been verified and is ready to finalize:  Return to the Unidesk Management Console. Select  Layers >App Layers , and then the layer you just prepared. Select  Finalize  in the Action bar.  Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.", 
            "title": "Finalize the Layer"
        }, 
        {
            "location": "/#create-a-platform-layer-xenserver-connector", 
            "text": "In this article:    Prepare a new Platform Layer        A Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - A Platform Layer for  publishing  is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - A Platform Layer for  packaging  is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.", 
            "title": "Create a Platform Layer (XenServer Connector)"
        }, 
        {
            "location": "/#prerequisites_8", 
            "text": "When creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the  type   of Platform Layer you choose to create.  Type of Platform Layer Prerequisites Publishing Layered Images Software installers, and settings you use for your: Hypervisor Provisioning service Connection broker Packaging Layers The software and settings for your: Hypervisor For example, your hypervisor installer and settings. Note:  You only need a Platform Layer for  packaging  Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#citrix-xenserver-prerequisites_1", 
            "text": "XenServer account and privileges A XenServer account (new or existing) to use for Unidesk. The account must have XenServer privileges to: Create and remove virtual disks. Copy and delete layers on virtual disks using XenServer file APIs. Citrix XenServer software and settings Access to the XenServer Tools to install on the layer. XenServer resource information The XenServer info listed in  Citrix XenServer Connector Configuration . Network access to Unidesk OS Machine Tools When you create Layer or add a Version to it, the Unidesk Management Console (UMC) uses a Connector Configuration to create a VM called a Packaging Machine for the Layer you are building. The Packaging Machine  must  have access to the Unidesk OS Machine Tools download, which is available on the Unidesk Download page.", 
            "title": "Citrix XenServer prerequisites"
        }, 
        {
            "location": "/#install-the-platform-tools-on-the-packaging-machine", 
            "text": "Whether you are creating a Platform Layer or adding a version to it:  Remote log in to the Packaging Machine. Be sure to log in using the User account you used to create the OS. Install the platform software and tools, along with any drivers, boot-level applications, or files needed. Keep in mind that the state of the software before you finalize the layer is what the image will use. If this Platform Layer is going to be used for packaging new layers, install and configure your hypervisor tools and settings. If this Platform Layer is going to be used for publishing Layered Images, install and configure your hypervisor, provisioning service, and connection broker tools and settings. If a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically. Make sure the Packaging Machine is in the state you want it to be in for users: If the tools you install require any post-installation setup or registration, complete those steps now. Remove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine. When using PVS, if your OS image was activated using KMS, rearm KMS  just before you shut down Verify the Rearm count on the OS by running slmgr /dlv from a command prompt. The Rearm count must  not  be zero. slmgr /dlv Rearm KMS: slmgr /rearm", 
            "title": "Install the platform tools on the Packaging Machine"
        }, 
        {
            "location": "/#verify-the-layer-and-shut-down-the-packaging-machine_6", 
            "text": "Once the software is installed on the Packaging Machine, it is important to verify that the Layer is ready to be finalized. To be ready for finalization, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.  To verify that any outstanding processes are complete, you can run the  Shutdown For Finalize   tool (icon below), which appears on the Packaging Machine's desktop.  To use the Shutdown For Finalize tool:  If you are not logged into the Packaging Machine, remote log in as the user who created the machine. Double-click the  Shutdown For Finalize  icon. A command line window displays messages detailing the layer verification process. If there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation. For details, see Verifying Layers. If you are using KMS licensing, once any pending operations are complete, be sure to rearm KMS yet again  just before you shutdown . First, enter this command to verify that the Rearm count is > 0: slmgr /dlv Then, rearm KMS: slmgr /rearm Double-click the  Shutdown For Finalize  icon again to shut down the Packaging Machine.  The Layer should be ready to finalize.", 
            "title": "Verify the Layer and shut down the Packaging Machine"
        }, 
        {
            "location": "/#finalize-the-layer_4", 
            "text": "To finalize the Layer, you import the installed software into the Platform Layer you prepared in the Unidesk Management Console (UMC).  Return to the UMC. Select  Layers > Platform Layers . Select  Finalize  in the Action bar. Monitor the Task bar to verify that the action completes successfully and that the layer is deployable.", 
            "title": "Finalize the Layer"
        }, 
        {
            "location": "/#create-a-platform-layer-network-file-share-connector", 
            "text": "In this article:  Prerequisites Prepare a new Platform Layer Deploy a Packaging Machine Install the required platform tools Verify the Layer and shut down the Packaging Machine Finalize the Layer  A Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).  When do you need a Platform Layer?  When creating your App Layers and OS Layer Versions, you will need a Platform Layer for Packaging Layers, if you imported your OS image (aka gold image) from a different hypervisor than the one where the ELM is installed. Whenever you publish a Layered Image, you will need a Platform Layer for Publishing.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.", 
            "title": "Create a Platform Layer (Network File Share Connector)"
        }, 
        {
            "location": "/#create-the-packaging-machine", 
            "text": "The Task Description (example shown in the last step above) contains the location in your environment where the disks for this Layer have been created.  Log into the client for your hypervisor. Locate the Packaging disks in the following directory on the Network File Share: \\Unidesk\\Packaging Disks Copy the disks to the hypervisor where you will install the software for the Layer. Note:  Even if the Packaging Disks in \\Unidesk\\Packaging Disks are already in the hypervisor where you will be installing the tools, we recommend copying the disks to another location. This is because when you use the disk to create a new VM, the directory will quickly become crowded with files generated by your hypervisor. Important:  Do not copy the disk to the Finalize folder until it is ready to finalize. A disk in the Finalize folder cannot be attached to the new VM that you are going to create next. In your hypervisor, create a VM from the  Boot  disk and name it  Layer_Name Boot . xxx . In your hypervisor, select the VM, and attach the disk called  Layer_Name Pkg . xxx  to the VM. Create a virtual machine using the Packaging Disk as the boot disk. This is the Packaging Machine where you will install the application(s) to include in the layer. Power on the Packaging Machine.", 
            "title": "Create the Packaging Machine"
        }, 
        {
            "location": "/#create-a-platform-layer-nutanix-ahv", 
            "text": "In this article:  Prerequisites Prepare a new Platform Layer Install the required platform tools Verify the Layer and shut down the Packaging Machine Finalize the Layer  For cross-platform deployments, a Platform Layer includes the platform software and settings required to deploy images in your environment.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Use this type of Platform Layer when publishing Layered Images to a platform other than the one where you created the OS Layer. Platform Layers for  packaging Layers  (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment. Use this type of Platform Layer when creating Layers on a platform other than the one from which you imported the OS for your OS Layer.", 
            "title": "Create a Platform Layer (Nutanix AHV)"
        }, 
        {
            "location": "/#nutanix-ahv-acropolis-prerequisites_1", 
            "text": "Nutanix Prism account and privileges A Nutanix Prism account (new or existing) to use for Unidesk. The account must have privileges to perform the following operations: VM operations: clone delete power on/off attach virtual disks Image operations: create update (aka upload) delete Virtual disks create attach to VMs Nutanix AHV software and settings Access to the VM Mobility Tools to install on the layer. Nutanix AHV resource information The Acropolis Server info listed in  Nutanix AHV Connector Configuration  or  MCS for Nutanix AHV Connector Configuration . Nutanix AHV Connector   When creating Layers for the Nutanix environment, you must use a Nutanix AHV Connector Configuration. The MCS for Nutanix AHV Connector does not support Layer creation.", 
            "title": "Nutanix AHV (Acropolis) prerequisites"
        }, 
        {
            "location": "/#create-a-platform-layer-vmware-horizon-for-vsphere", 
            "text": "In this article:    Prepare a new Platform Layer Deploy a Packaging Machine Create a Platform Layer (VMware Horizon for vSphere) Verify the Layer and shut down the Packaging Machine Finalize the Layer  A Platform Layer includes the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to VMware Horizon in vSphere with XenDesktop as the broker would include the VMware View Agent, vmTools, and other platform-related software..  This article explains the next steps to create a Platform Layer, based on your connector and platform choices. If you need more information than is included here, check these other Unidesk sources:  Layer essentials (Unidesk Learning Center)  and the  Unidesk Forum .  A Platform Layer should include the platform software and settings required to deploy images in your environment, given your choice of hypervisor, provisioning service, and connection broker.  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - A Platform Layer for  publishing  is used in Image Templates to ensure that your published Layered Images include the software and settings required to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - A Platform Layer for  packaging  is used for creating App Layers and OS Layer Versions in your hypervisor environment. This Layer includes the hypervisor software and settings required to easily install the app or OS update on a VM in the selected hypervisor.", 
            "title": "Create a Platform Layer (VMware Horizon for vSphere)"
        }, 
        {
            "location": "/#prerequisites_11", 
            "text": "When creating a Platform Layer, the software installers for your platform must be available in a location that's accessible to the Packaging Machine VM where you are going to create the Layer. As summarized in the following table, the prerequisites vary based on the  type   of Platform Layer you choose to create.  Type of Platform Layer Prerequisites Publishing Layered Images Software installers, and settings you use for your: Hypervisor Provisioning service Connection broker Packaging Layers The software and settings for your: Hypervisor For example, your hypervisor installer and settings. Note:  You only need a Platform Layer for  packaging  Layers if you are creating your Layers on a different hypervisor than the one from which you imported your OS image.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#vmware-horizon-view-composer-prerequisites", 
            "text": "When creating a Platform Layer for publishing images to an MCS environment, you need:  An OS Layer Network access to Unidesk Tools Access from the Platform Layer Packaging Machine VM to the Unidesk Tools download (available on the Unidesk Download page). VMware View Agent installed on the Platform layer The VMware View Agent installer for the Windows OS you are using must be installed on the Platform Layer. Unidesk Agent and PowerShell Snap-in, if using a Script as part of the Connector Configuration   As part of the Connector Configuration, if you include a script to run on the newly published Layered Image, you will need the Unidesk Agent and PowerShell Snap-in installed and running. VMware Horizon View Composer resource information The Horizon View info listed in this  VMware Horizon for vSphere Connector Configuration  topic. vSphere resource information The vSphere info listed in  vSphere Connector Configuration . vSphere software and settings Access to the vSphere software to install on the layer.", 
            "title": "VMware Horizon View Composer prerequisites"
        }, 
        {
            "location": "/#log-into-the-packaging-machine_2", 
            "text": "The Task Description (example shown in the last step above) contains the location of the Packaging Machine in your environment.  Log into your vSphere web client. Back in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the Packaging Machine. Power on the Packaging Machine.", 
            "title": "Log into the Packaging Machine"
        }, 
        {
            "location": "/#install-the-required-platform-tools_5", 
            "text": "This section explains how to install the platform software to be used by the Platform Layer. The platform software to install includes the provisioning server software and/or connection broker software that your Layered Images will need to run in the target environment.", 
            "title": "Install the required platform tools"
        }, 
        {
            "location": "/#platform-software-to-install_2", 
            "text": "You need the installers for your hypervisor, provisioning service, and connection broker.  If you are using a supported Unidesk Connector to connect to your environment, you will install the provisioning service and/or connection broker software on the Packaging Machine that Unidesk created in that environment. Otherwise, you will be installing the software on a VM in your hypervisor of choice, moving the VM to the Unidesk network file share, from which you can import the VM into Unidesk.  Keep in mind that the state of the software before you finalize the layer is what the image will use.  Remote log in to the Packaging Machine you created. Be sure to log in using the User account you used to create the OS. Install the tools that your Layered Image will need to run on vSphere and in PVS, along with any drivers, boot-level applications, or files needed. If a software installation requires a system restart, restart it manually. The Packaging Machine does not restart automatically. Make sure the Packaging Machine is in the state you want it to be in when the image is booted: If the tools you install require any post-installation setup or registration, complete those steps now. Remove any settings, configurations, files, mapped drives, or applications that you do not want to include on the Packaging Machine.  Next, you'll need to shut down the Packaging Machine and verify that the Platform Layer is ready to finalize.  Verify the Layer and shut down the Packaging Machine  Once the tools are installed on the Packaging Machine, the next step is to verify that the Layer is ready to finalize. At this point, any required post-installation processing needs to be completed. For example, a reboot may be required, or a Microsoft NGen process may need to complete.  To verify that any outstanding processes are complete, you can run the  Shutdown For Finalize   tool (icon below), which appears on the Packaging Machine's desktop.  To use the Shutdown For Finalize tool:  If you are not logged into the Packaging Machine, remote log in as the user who created the machine. Double-click the  Shutdown For Finalize  icon. A command line window displays messages detailing the layer verification process. If there is an outstanding operation that must be completed before the Layer can be finalized, you are prompted to complete the process. For example, if a Microsoft NGen operation needs to complete, you may be able to expedite the NGen operation, as detailed  below . Once any pending operations are complete, double-click the  Shutdown For Finalize  icon again. This shuts down the Packaging Machine.  The Layer is now ready to finalize.", 
            "title": "Platform software to install"
        }, 
        {
            "location": "/#finalize-the-layer_7", 
            "text": "Once the Packaging Machine is created, the software is installed and ready to finalize, and you have shut down the machine, you'll need to finalize the Layer.  Note:   When you finalize a Layer, Unidesk may delete the Packaging Machine so as not to incur extra cost for storage.  When the Layer has been verified and is ready to finalize:  Return to the Unidesk Management Console. Select  Layers >App Layers , and then the layer you just prepared. Select  Finalize  in the Action bar.  Monitor the Task bar to verify that the action completes successfully and that the Layer is deployable.", 
            "title": "Finalize the Layer"
        }, 
        {
            "location": "/#create-a-platform-layer-vsphere-connector", 
            "text": "In this article:  Prerequisites Prepare a new Platform Layer Connect to and log into the Packaging Machine Install the required platform tools Verify the Layer and shut down the Packaging Machine    A Platform Layer is intended to include the platform software and settings required to deploy images in your environment. For example, a Platform Layer for publishing to PVS in vSphere with XenApp as the broker would include the PVS Target Device Imaging software, vmTools, and the XenApp Virtual Delivery Agent Installer (and other platform-related software as well).  You can create two kinds of Platform Layers:  Platform Layers for  publishing Layered Images  (Required) - These Layers include the software and settings required for a Layered Image to run flawlessly in your environment. Platform Layers for  packaging Layers  (Required in some cases) - These Layers include the hypervisor software and settings you need to easily install the software for your other layers on a VM in your hypervisor environment.  The general steps for creating a Platform Layer are:  Prepare a Platform Layer Connect to and log into the Packaging Machine Install the Platform Software Verify the Layer and Shutdown the Packaging Machine Copy the Packaging Machine to the ELM's Network File Share (if needed) Finalize the Layer", 
            "title": "Create a Platform Layer (vSphere connector)"
        }, 
        {
            "location": "/#vsphere-prerequisites_1", 
            "text": "Network access to Unidesk Tools Access from the Packaging Machine VM in vSphere to the Unidesk Tools download (available on the Unidesk Download page). vSphere software and settings Access to the vSphere software to install on the layer. vSphere resource information The vSphere info listed in  vSphere Connector Configuration .", 
            "title": "vSphere prerequisites"
        }, 
        {
            "location": "/#finalize-the-layer_8", 
            "text": "To finalize the Layer, you import the installed software into the Platform Layer you prepared in the Unidesk Management Console (UMC).  Return to the UMC. Select  Layers > Platform Layers . Select  Finalize  in the Action bar. Monitor the Task bar to verify that the action completes successfully and that the layer is deployable.", 
            "title": "Finalize the Layer"
        }, 
        {
            "location": "/#app-layers_1", 
            "text": "Would you like to create an App Layer, assign one to Layered Images or to specific users, or learn how to layer some of the more challenging apps (most are easy to layer)?", 
            "title": "App Layers"
        }, 
        {
            "location": "/#create-an-app-layer", 
            "text": "What type of Connector are you using to create this App Layer?", 
            "title": "Create an App Layer"
        }, 
        {
            "location": "/#create-an-app-layer-vsphere", 
            "text": "In this article:  Before you start  Prepare a new App Layer  Install the software on the Packaging Machine  Finalize the Layer  Reference: Create App Layer Wizard values  An App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.  To create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.  A Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.", 
            "title": "Create an App Layer (vSphere)"
        }, 
        {
            "location": "/#requirements_1", 
            "text": "To create an App Layer, you need:  Create an OS Layer", 
            "title": "Requirements"
        }, 
        {
            "location": "/#optional", 
            "text": "Before you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.  Prerequisite Layer Platform Layer (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer) Run Once Script  If the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.", 
            "title": "Optional"
        }, 
        {
            "location": "/#prerequisite-layer", 
            "text": "Prerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers  should only be used if they are required  , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.  Reasons to consider using Prerequisite Layers:  The application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer. The add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer. Two applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.  Note:   Some of these issues can also be handled by putting the two applications in the same layer.", 
            "title": "Prerequisite Layer"
        }, 
        {
            "location": "/#platform-layer-only-required-if-creating-app-layers-on-a-hypervisor-other-than-the-one-from-which-you-imported-your-os-layer", 
            "text": "If you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, you should consider creating a Platform Layer with the hypervisor tools and hardware settings that will make it easy to install and package applications in your environment.", 
            "title": "Platform Layer (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer)"
        }, 
        {
            "location": "/#run-once-script", 
            "text": "You can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.", 
            "title": "Run Once Script"
        }, 
        {
            "location": "/#layer-caching-for-faster-app-layer-creation", 
            "text": "If you will be creating multiple App Layers that use the same OS Layer, Prerquisite Layer(s), and Platform Layer, you can save significant time by setting the Layer Disk Cache Size in the vSphere Connector. If Cache Size is set to a value greater than 0, the first time you create an App Layer with a specific OS Layer, Prerequisite Layer(s) and Platform Layer, Unidesk will save a template in the cache that consists of the boot disk and the empty packaging disk. The next time you create an App Layer that uses the same OS Layer, Prerequisite Layer(s) and Platform Layer, Unidesk will re-use this template, thereby significantly cutting the time it takes to create this App Layer in half.  Please note that if you create an App Layer that uses a different OS Layer, Prerequisite Layer(s) or Platform Layers from what is saved in the template, Unidesk will create a new template and store it in cache.  The size that you need to set for your cache depends on how many different combinations of OS Layers, Prerequisite Layer(s), Platform Layer combinations and therefore how many cached templates you will use as you layer various Apps. To estimate the space required for each template you can you can determine how much space a Boot disk will use by selecting the i for the OS Layer you are using and observing the Maximum Layer Size value in the Version Information section.  Likewise, you can obtain the Pkg disk size for an existing Application/Platform layer using the same approach. When creating new layers, you can set the Max Layer Size used by setting the Max Layer Size (GB) field in the Create Layer Wizard. By looking at the size of your existing layers, and estimating how many layers you are going to be creating/editing you can determine how large to set the Cache Size in your connector configuration.", 
            "title": "Layer Caching for faster App Layer creation"
        }, 
        {
            "location": "/#layer-integrity-messages-you-may-see-during-the-finalization-process_8", 
            "text": "Layer integrity messages let you know what queued tasks must be completed before a Layer is finalized.  The new Layer or Version can only be finalized when the following conditions have been addressed:  A reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine. A post-installation reboot is pending - please check and reboot the Packaging Machine. An MSI install operation is in progress - please check the Packaging Machine. A Microsoft NGen operation is in progress in the background. Note:  If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.", 
            "title": "Layer integrity messages you may see during the finalization process"
        }, 
        {
            "location": "/#expediting-a-microsoft-ngen-operation_14", 
            "text": "NGen is the Microsoft  Native Image Generator  . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.  You have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.  Forcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.  Force an NGen operation to the foreground. Normally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this: Open a command prompt as Administrator. Go to the Microsoft .NET Framework directory for the version currently in use: cd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX Enter the NGen command to execute the queued items: ngen update /force This brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled. Note:  It's okay if you see several compilation failed messages! Look in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run  ngen update /force . Do  not  reboot to stop the task. You  must  allow it to complete. Check the status of an NGen operation Open a command prompt as Administrator. Check status by running this command: ngen queue status When you receive the following status, the NGen is complete, and you can finalize the Layer. The .NET Runtime Optimization Service is stopped", 
            "title": "Expediting a Microsoft NGen operation"
        }, 
        {
            "location": "/#create-an-app-layer-azure", 
            "text": "In this article:  Before you start Prepare a new App Layer Deploy a Packaging Machine Install the Application(s) Verify the Layer and shut down the Packaging Machine Finalize the Layer  An App Layer includes one or more installed applications that you can use in your Layered Images. You can create any number of App Layers, each with one or more applications. When it's time to update an app, you can add a new version to the layer. When you are ready to deliver the application updates to users, you can update your Image Templates, republish your Layered Images, and provision your servers with the new Layered Image.  To create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine, then install the application(s). Once the application(s) are installed, you finalize the Layer.", 
            "title": "Create an App Layer (Azure)"
        }, 
        {
            "location": "/#requirements_2", 
            "text": "To create an App Layer, you need:  Create an OS Layer", 
            "title": "Requirements"
        }, 
        {
            "location": "/#optional_1", 
            "text": "Before you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.  Create Prerequisite Layers   Create a Platform Layer (Azure connector) Run Once Script  If the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.", 
            "title": "Optional"
        }, 
        {
            "location": "/#does-this-app-layer-require-prerequisite-layers", 
            "text": "Prerequisite Layers provide a mechanism to include existing Application Layers on the Packaging Disk when creating or adding a version to an Application Layer. Prerequisite Layers  should only be used if they are required  , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future. Prerequisite Layers can be required for several reasons:  If the software installed in one layer is required by the current layer's application just to be installed. For example, if you are installing an application that requires Java and you have Java in a separate layer. If the software to be installed adds settings of an existing application. For example, when installing an Office add-in, Microsoft Office must first be installed. If two applications modify the same registry key and the second application must add to a key and not replace it. For example, two application that both modify logon keys in Windows like a Citrix Agent and Imprivata.  Note:   Some of these issues can also be handled by putting the two applications in the same layer rather than using prerequisite layers.", 
            "title": "Does this App Layer require Prerequisite Layers?"
        }, 
        {
            "location": "/#run-once-script_1", 
            "text": "You can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.", 
            "title": "Run Once Script"
        }, 
        {
            "location": "/#deploy-a-packaging-machine-to-azure_1", 
            "text": "The Task Description (example shown in the last step above) contains a link to the location in the Azure portal where the Packaging Machine for this Layer has been published.  To create your Packaging Machine in Azure, begin with the expanded Packaging Disk Task shown in the last step above.  Log into the Azure portal (https://portal.azure.com) from your web browser. In the expanded Packaging Disk Task shown below, copy the full URL and paste it into the web browser where you logged into the Azure portal. This opens the Microsoft Azure portal to the  Custom deployment  template where you can create the virtual machine that you will use as your Unidesk Packaging Machine. Note:  We recommend copying the full URL instead of using the Click  here  link. On the Custom deployment panel, complete the required fields for customizing your Azure parameters. Packaging Machine Name - must conform to Azure VM name requirements. Size - the Azure VM size of the packaging machine. Virtual Network and Subnet - the virtual network and subnet for deploying the Packaging Machine. IMPORTANT: Be sure that the value for the  Resource group location  matches the  Storage account location  that you configured in the Platform Connector Configuration. If these locations are not the same, the Packaging Machine will fail to deploy and you will have to reattempt deployment. If your deployment does fail, you can simply re-paste the link into the browser to start over.", 
            "title": "Deploy a Packaging Machine to Azure"
        }, 
        {
            "location": "/#create-an-app-layer-vsphere_1", 
            "text": "In this article:  Before you start  Prepare a new App Layer  Deploy a Packaging Machine  Install the Application(s)  Verify the Layer and shut down the Packaging Machine  Finalize the Layer  An App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When creating an Image Template to use for publishing a Layered Image, you can include an OS Layer, a Platform Layer, and any combination of App Layers, as long as the OS Layer used to create all of them is the same.  To create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application on it. Once the application is installed, you finalize the Layer.  A Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine using the location and credentials you supply by selecting the Platform Target (hypervisor) and Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.", 
            "title": "Create an App Layer (vSphere)"
        }, 
        {
            "location": "/#requirements_3", 
            "text": "To create an App Layer, you need:  Create an OS Layer  (Contains the OS for this application.)", 
            "title": "Requirements"
        }, 
        {
            "location": "/#optional-resources", 
            "text": "You may want to create resources to facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.  Prerequisite Layers   Platform Layer for Packaging Layers (Required if creating App Layers on a different hypervisor than the one from which you imported your OS Layer) Run Once Script", 
            "title": "Optional resources"
        }, 
        {
            "location": "/#prerequisite-layers-what-are-they-and-do-i-need-any", 
            "text": "Prerequisite Layers provide a mechanism to include existing Application Layers on the Packaging Disk when creating or adding a version to an Application Layer. Prerequisite Layers  should only be used if they are required  , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future. Prerequisite Layers can be required for several reasons:  If the software installed in one layer is required by the current layer's application just to be installed. For example, if you are installing an application that requires Java and you have Java in a separate layer. If the software to be installed adds settings of an existing application. For example, when installing an Office add-in, Microsoft Office must first be installed. If two applications modify the same registry key and the second application must add to a key and not replace it. For example, two application that both modify logon keys in Windows like a Citrix Agent and Imprivata.  Note:   Some of these issues can also be handled by putting the two applications in the same layer rather than using prerequisite layers.", 
            "title": "Prerequisite Layers: What are they and do I need any?"
        }, 
        {
            "location": "/#platform-layer-what-is-it-and-do-i-need-one", 
            "text": "A Platform Layer is a Unidesk Layer that contains the tools and hardware settings needed to either install and package an application during Layer creation, or to publish a Layered Image for provisioning servers in a specific environment. You can create a different Platform Layer for each environment in which you are creating Layers, or publishing Layered Images.  There are two types of Platform Layers you can create: Platform Layers to use for Packaging other Layers, and Platform Layers for Publishing Layered Images.", 
            "title": "Platform Layer: What is it and do I need one?"
        }, 
        {
            "location": "/#run-once-script_2", 
            "text": "You can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.", 
            "title": "Run Once Script"
        }, 
        {
            "location": "/#create-the-packaging-machine_1", 
            "text": "The Task Description (example shown in the last step above) contains the location in your hypervisor environment where the disks for this Layer have been created.  Log into your hypervisor. Back in the Unidesk Management Console, use the instructions in the expanded Packaging Disk Task shown below to navigate to the location where the Boot Disk and Packaging Disk have been created. In your hypervisor, create a VM from the Boot disk and name it  Layer_Name Boot. xxx . Use the hypervisor to attach the disk called  Layer_Name Pkg. xxx  to the VM you just created. Important:  Both disks you exported  must  be attached to the IDE. Power on the VM. This is your Packaging Machine where you will install the app(s) to include in this Layer.", 
            "title": "Create the Packaging Machine"
        }, 
        {
            "location": "/#create-an-app-layer-nutanix-ahv-connector", 
            "text": "In this article:  Before you start Prepare a new App Layer Install the software on the Packaging Machine  Finalize the Layer Reference: Create App Layer Wizard values  An App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.  To create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.  A Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.  Before you start", 
            "title": "Create an App Layer (Nutanix AHV Connector)"
        }, 
        {
            "location": "/#requirements_4", 
            "text": "To create an App Layer, you need:  Create an OS Layer", 
            "title": "Requirements"
        }, 
        {
            "location": "/#optional_2", 
            "text": "Before you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.  Prerequisite Layer Platform Layer (for cross-platform deployments) (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer) Run Once Script  If the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.", 
            "title": "Optional"
        }, 
        {
            "location": "/#prerequisite-layer_1", 
            "text": "Prerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers  should only be used if they are required  , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.  Reasons to consider using Prerequisite Layers:  The application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer. The add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer. Two applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.  Note:   Some of these issues can also be handled by putting the two applications in the same layer.", 
            "title": "Prerequisite Layer"
        }, 
        {
            "location": "/#platform-layer-for-cross-platform-deployments", 
            "text": "A Platform Layer is  only   required when creating App Layers on a hypervisor other than the one from which you imported your OS Layer.  If you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, it is strongly recommended that you create a Platform Layer containing the hypervisor tools and hardware settings you need to seamlessly install and package applications in your environment.", 
            "title": "Platform Layer (for cross-platform deployments)"
        }, 
        {
            "location": "/#run-once-script_3", 
            "text": "You can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.", 
            "title": "Run Once Script"
        }, 
        {
            "location": "/#layer-integrity-messages-you-may-see-during-the-finalization-process_11", 
            "text": "Layer integrity messages let you know what queued tasks must be completed before a Layer is finalized.  The new Layer or Version can only be finalized when the following conditions have been addressed:  A reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine. A post-installation reboot is pending - please check and reboot the Packaging Machine. An MSI install operation is in progress - please check the Packaging Machine. A Microsoft NGen operation is in progress in the background. Note:  If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.", 
            "title": "Layer integrity messages you may see during the finalization process"
        }, 
        {
            "location": "/#expediting-a-microsoft-ngen-operation_17", 
            "text": "NGen is the Microsoft  Native Image Generator  . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.  You have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.  Forcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.  Force an NGen operation to the foreground. Normally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this: Open a command prompt as Administrator. Go to the Microsoft .NET Framework directory for the version currently in use: cd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX Enter the NGen command to execute the queued items: ngen update /force This brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled. Note:  It's okay if you see several compilation failed messages! Look in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run  ngen update /force . Do  not  reboot to stop the task. You  must  allow it to complete. Check the status of an NGen operation Open a command prompt as Administrator. Check status by running this command: ngen queue status When you receive the following status, the NGen is complete, and you can finalize the Layer. The .NET Runtime Optimization Service is stopped", 
            "title": "Expediting a Microsoft NGen operation"
        }, 
        {
            "location": "/#create-an-app-layer-xenserver-connector", 
            "text": "In this article:  Before you start Prepare a new App Layer Install the software on the Packaging Machine  Finalize the Layer Reference: Create App Layer Wizard values  An App Layer is a bootable software image (virtual disk) containing one or more applications that you can use in any number of Layered Images. When publishing a Layered Image, you can combine an App Layer with the OS Layer used to create it, other App Layers, and a Platform Layer.  To create an App Layer, you open the Create Layer wizard, deploy a Packaging Machine in your environment, then install the application(s). Once the application(s) are installed, you finalize the Layer.  A Packaging Machine is a VM where you install the application(s) that will be included in the Layer. Unidesk creates the Packaging Machine in the location and using the credentials you supply by choosing the Platform Target (hypervisor) and selecting a Connector Configuration containing this information. If you don't yet have the Connector Configuration you need, you can add a new one, as described in the steps below.  Before you start", 
            "title": "Create an App Layer (XenServer Connector)"
        }, 
        {
            "location": "/#requirements_5", 
            "text": "To create an App Layer, you need:  Create an OS Layer", 
            "title": "Requirements"
        }, 
        {
            "location": "/#optional_3", 
            "text": "Before you create an App Layer, you may also want to create resources that facilitate the application installation process. These resources are for temporary use during installation only, and will not be used to deliver the application.  Prerequisite Layer Platform Layer (for cross-platform deployments) (Only required if creating App Layers on a hypervisor other than the one from which you imported your OS Layer) Run Once Script  If the application you install affects boot-level components, you'll need to restart the Packaging Machine as part of finalizing the layer or version.", 
            "title": "Optional"
        }, 
        {
            "location": "/#prerequisite-layer_2", 
            "text": "Prerequisite Layers let you include existing App Layers on the Packaging Disk when creating or adding a version to an App Layer. Prerequisite Layers  should only be used if they are required  , since it is possible that the prerequisite applications will pull something into the Layer that is not required for the current application deployment, and which may cause conflict in the future.  Reasons to consider using Prerequisite Layers:  The application you are installing requires another application during installation. For example, if you are installing an application that requires Java and you have Java in a separate layer. The add-in or plugin you are installing adds settings to an application. For example, when installing an Office add-in, you would use your Microsoft Office App Layer as a prerequisite layer. Two applications modify the same registry key, and the second application must add to an existing key rather than replace it. For example, Citrix Agent and Imprivata software both modify login keys in Windows.  Note:   Some of these issues can also be handled by putting the two applications in the same layer.", 
            "title": "Prerequisite Layer"
        }, 
        {
            "location": "/#platform-layer-for-cross-platform-deployments_1", 
            "text": "A Platform Layer is  only   required when creating App Layers on a hypervisor other than the one from which you imported your OS Layer.  If you are creating App Layers and Versions on a different hypervisor than the one you used to create your OS Layer, it is strongly recommended that you create a Platform Layer containing the hypervisor tools and hardware settings you need to seamlessly install and package applications in your environment.", 
            "title": "Platform Layer (for cross-platform deployments)"
        }, 
        {
            "location": "/#run-once-script_4", 
            "text": "You can include a Run Once script in an App Layer. This allows you to run a script the first time any Layered Image that includes the App Layer boots. If the App Layer is elastically layered, the Run Once script runs when the App Layer Disk is mounted. Run Once scripts are typically used for apps, such as MS Office, that require license activation on the first boot.", 
            "title": "Run Once Script"
        }, 
        {
            "location": "/#layer-integrity-messages-you-may-see-during-the-finalization-process_12", 
            "text": "Layer integrity messages let you know what queued tasks must be completed before a Layer is finalized.  The new Layer or Version can only be finalized when the following conditions have been addressed:  A reboot is pending to update drivers on the boot disk - please check and reboot the Packaging Machine. A post-installation reboot is pending - please check and reboot the Packaging Machine. An MSI install operation is in progress - please check the Packaging Machine. A Microsoft NGen operation is in progress in the background. Note:  If a Microsoft NGen operation is in progress, you may be able to expedite it, as described in the next section.", 
            "title": "Layer integrity messages you may see during the finalization process"
        }, 
        {
            "location": "/#expediting-a-microsoft-ngen-operation_18", 
            "text": "NGen is the Microsoft  Native Image Generator  . It is part of the .NET system, and basically re-compiles .NET byte code into native images and constructs the registry entries to manage them. Windows will decide when to run NGen, based on what is being installed and what Windows detects in the configuration. When NGen is running, you must let it complete. An interrupted NGen operation can leave you with non-functioning .NET assemblies or other problems in the .NET system.  You have the choice of waiting for the NGen to complete in the background, or you can force the NGen to the foreground. You can also check the status of the NGen operation, as described below. However, every time you check the queue status, you are creating foreground activity, which might cause the background processing to temporarily pause.  Forcing the NGen to the foreground will allow you to view the progress and once the output has completed, you should be able to finalize the layer.  Force an NGen operation to the foreground. Normally, NGen is a background operation and will pause if there is foreground activity. Bringing the task into the foreground can help the task to complete as quickly as possible. To do this: Open a command prompt as Administrator. Go to the Microsoft .NET Framework directory for the version currently in use: cd C:\\Windows\\Microsoft.NET\\FrameworkNN\\vX.X.XXXXX Enter the NGen command to execute the queued items: ngen update /force This brings the NGen task to the foreground in the command prompt, and lists the assemblies being compiled. Note:  It's okay if you see several compilation failed messages! Look in the Task Manager to see if an instance of MSCORSVW.EXE is running. If it is, you must allow it to complete, or re-run  ngen update /force . Do  not  reboot to stop the task. You  must  allow it to complete. Check the status of an NGen operation Open a command prompt as Administrator. Check status by running this command: ngen queue status When you receive the following status, the NGen is complete, and you can finalize the Layer. The .NET Runtime Optimization Service is stopped", 
            "title": "Expediting a Microsoft NGen operation"
        }, 
        {
            "location": "/#recipes-for-layering-applications", 
            "text": "Most applications layer without a hitch, but there are a few that are trickier to layer, for example, Java, iTunes, Microsoft Office, and print drivers.  For recipes and tips about layering specific applications, visit the Unidesk Forum about  Application Layer Recipes . If you experience issues layering an application that is not included in these Application Layer Recipes, you can post a question to this Forum.  Note: If in the unlikely event you find yourself reading the recipe for an application you want to layer in a 4.X image and it requires using a script path, please call our Tech Support so we can guide you through it.", 
            "title": "Recipes for layering Applications"
        }, 
        {
            "location": "/#user-layer-unidesk-labs_1", 
            "text": "In this article:  Before you start Enable User Layers in the Layered Image User Layer (Unidesk Labs)  With the Unidesk User Layer you now have the ability to persist user profile settings, data, and user-installed applications in non-persistent VDI environments.  User Layers are created when:  You set  Elastic Layering  on an Image Template to  Application and User Layers , so that the Layered Image supports User Layers. A user logs in to their desktop for the first time, and a User Layer is created for them. From then on, the user's data and settings are saved in the User Layer, along with any applications that the user installs locally on their desktops.", 
            "title": "User Layer (Unidesk Labs)"
        }, 
        {
            "location": "/#prerequisites_13", 
            "text": "Create your  OS Layer . Create your  Platform Layer  for publishing, if needed. Create your  App Layers . Enough free disk space on your ELM's file share to ensure that these additional Layers do not cause you to run out. Allow enough space for the user's locally installed apps, plus the data and configuration settings for the user's Layers. Make sure network bandwidth is adequate, as bandwidth and latency have a significant effect on the User Layer. Every write goes across the network.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#compatibility_1", 
            "text": "Currently, User Layers are supported in conjunction with the following platforms:  Operating systems: Windows 7, 64-bit Publishing platforms: VMware Horizon View and Citrix XenDesktop.", 
            "title": "Compatibility"
        }, 
        {
            "location": "/#user-layer-creation-process", 
            "text": "Enable User Layers in your Image Template: Set  Elastic Layering  in the Image Template wizard on the Image Disk tab) to  Application and User Layers . Publish Layered Images using the above Image Template. When a user logs on to their desktop for the first time, a User Layer is created for them.", 
            "title": "User Layer creation process"
        }, 
        {
            "location": "/#user-layer-size-and-location", 
            "text": "The default size of a User Layer is 10 GB.  User Layers are created in the  Users   folder on the ELM's network file share, for example:  \\ MyServer  * MyShare * \\Users  Each user will have his/her own directory within the Users directory, and it will be named as follows:  Users* domainIname  * *username * * OS-Layer-ID-in-hex  _ OS-Layer-name  * *username * .vhd  For example:  User's login name:  jdoe   User's Domain:  testdomain1   OS layer: MyOSLayer (ID is in hexidecimal format:  123456 ) User Layer would be created in:  \\MyServer\\MyShare\\Users\\testdomain1\\jdoe\\123456_MyOSLayer\\jdoe.vhd", 
            "title": "User Layer size and location"
        }, 
        {
            "location": "/#expected-behavior", 
            "text": "", 
            "title": "Expected behavior"
        }, 
        {
            "location": "/#considerations", 
            "text": "Before deploying User Layers, please consider the following guidelines and limitations.  The User Layer is delivered via the ELM's file share, therefore: If the host is disconnected from the User Layer storage, the user will have to log out and log in again to re-establish the disk mount. The user will have to wait approximately 5 minutes because the user layer will be inaccessible. Certain enterprise applications, such as MS Office and Visual Studio should be installed in Layers, not as user-installed applications in the User Layer. In addition, the Elastic Layering limitations are applicable for User Layer. For more information on Layering limitations, please see the  Elastic Layering Limitations  section. Windows updates must be disabled on the User Layer. VMware Horizon View: View must be configured for non-persistent desktops, and the desktop  must  be set to  Refresh at log off . Delete or refresh the machine on log off. Example: After logging off with View set to  Refresh Immediately , the desktop goes into maintenance mode. If there is only one machine in the pool, the pool will not be available until that machine has completed the refresh.  The first time a user logs into his/her desktop, a User Layer is created for the him/her. If there is problem loading the elastically assigned Layers for the user, they will still receive their User Layer. If you rename the user in AD, a new directory and User Layer will be created for the new name. To avoid this, rename the directory on the file share and the VHD file in the directory structure to the new AD user name.", 
            "title": "Considerations"
        }, 
        {
            "location": "/#assign-app-layers", 
            "text": "Do you want to assign this App Layer to Layered Images, or directly to users as an Elastic Layer? You can make both kinds of assignments, as long as each user is assigned a single instance of the Layer, either as part of an image or as an elastic layer.", 
            "title": "Assign App Layers"
        }, 
        {
            "location": "/#assign-an-app-layer-to-image-templates", 
            "text": "In this article:  Prerequisites Add an App Layer Assignment to one or more Image Templates Update App Layers and Image Template Assignments Remove Template Assignments  An Image Template is a stored selection of Layers and settings that you use to publish Layered Images. At minimum, an Image Template contains an OS Layer, Platform Layer, and settings. Ideally, each template also contains your choice of App Layers for a particular image, for example, an image suited for the users served by a particular silo. Once you publish a Layered Image, you can provision systems using the image.  When you create a new App Layer, you can assign the App Layer to one or more Unidesk Image Templates, and then use the templates to publish Layered Images that include the layer. This article explains how to assign an App Layer to one or more Image Templates, and update the assignments when you update the Layer.  When you first update an App Layer, the new Layer Version is not assigned to any Image Templates, so you'll need to update the Layer Assignments. Updating the assignments allows you to assign different Versions of the Layer to different Image Templates. You cannot assign an App Layer to  Important:   When assigning App Layers, be sure to avoid assigning the app elastically to a user, if the app is already in the Layered Image that the user gets.", 
            "title": "Assign an App Layer to Image Templates"
        }, 
        {
            "location": "/#how-users-access-elastic-layers-assigned-to-them", 
            "text": "When users log into their Session or Desktop, icons for their Elastic Layers will appear as shortcuts on the desktop.  A user receives an Elastic Layer in the following cases:  The user (an AD user in the Unidesk Management Console) is assigned the Layer. An AD group that the user belongs to is assigned the Layer. A machine that the user logs into is a member of an AD Group that receives the Elastic Layer. A machine that the user logs into is associated (via the UMC) with an AD Group that is assigned the Layer via the UMC.", 
            "title": "How users access Elastic Layers assigned to them"
        }, 
        {
            "location": "/#if-more-than-one-version-of-the-same-layer-is-assigned-to-a-user", 
            "text": "If a Layer is assigned directly to the user and indirectly to one or more of the user's groups, the user receives the most recent version of the Layer assigned  directly   to her/him. For example, if a user is assigned Version 2, and a group that the user belongs to is assigned Version 3, the user will get Version 2.  If the user is assigned a Layer via one or more group assignments, the user receives the most recent version of the Layer.", 
            "title": "If more than one version of the same Layer is assigned to a user"
        }, 
        {
            "location": "/#if-a-user-has-an-app-layer-in-their-layered-image-and-the-layer-is-also-assigned-to-them-elastically", 
            "text": "If a user has an App Layer in the Layered Image and the user is also assigned the Layer elastically, they will receive the Elastic Layer, even if the version in the base image is more recent.", 
            "title": "If a user has an App Layer in their Layered Image, and the Layer is also assigned to them elastically"
        }, 
        {
            "location": "/#prerequisites_15", 
            "text": "The ELM's Network File Share must be configured correctly: The Share must be configured using SMB technology. When using Elastic Layer assignments,  NFS technology is not supported . The Share must be set up by the admin to be  readonly  for all users  except  for the one configured in the ELM. This secures the Layers and other files stored on the Share. The User named in this configuration must have  Read/Write  permissions on the root of the network file share. Select  System > Settings and Configuration  and scroll to  Network File Share . Make sure that any users who will be assigned Elastic Layers have  Read only  access for the root directory of the Network File Share. .NET Framework 4.5 is required on any Layered Image where Elastic Layers are enabled. The  App Layers  you want to elastically assign. Note:  App Layers must be created using the  same OS Layer  used to create the Layered Image that you enable to deliver the Elastic App Layer to users.", 
            "title": "Prerequisites"
        }, 
        {
            "location": "/#elastic-fit-details", 
            "text": "You can learn more about the Elastic Fit of a Layer by expanding the Elastic Fit Analysis. If the Elastic Fit is less than ideal, the list of violated rules will be displayed.  Low Severity Warning.  This is unlikely to cause any change in behavior or functionality for most applications. Medium Severity Warning.  This may cause minor changes in behavior or functionality for some applications. High Severity Warning.  This is likely to cause significant changes in behavior or functionality for many applications.", 
            "title": "Elastic Fit Details"
        }, 
        {
            "location": "/#enable-elastic-fit-in-unidesk-labs", 
            "text": "To use this Unidesk Labs feature, you must enable it. To enable Elastic Fit:  In the Unidesk Management Appliance (UMC), select  System > Settings and Configuration . Click  Edit  Unidesk Labs. Select the  Elastic Fit  check box. Click  Save .", 
            "title": "Enable Elastic Fit in Unidesk Labs"
        }, 
        {
            "location": "/#analyze-an-app-layer-for-elastic-fit", 
            "text": "All new Layer Versions will be analyzed for elastic layering compatibility when they are finalized. To analyze existing App Layers for Elastic Fit:  Log into the Unidesk Management Console (UMC) . Select  Layers > App Layers . Select the Layer to analyze, and click  Analyze Layer . On the Select Versions tab, choose the Layer Versions to analyze. On the Confirm and Complete tab, click  Analyze Layer Versions . The analysis takes seconds. To see the Elastic Fit Analysis, select the App Layers module, move the mouse pointer over the Layer icon and click the  Info    icon. Expand the  Version Information  for each Layer Version, and look for the Elastic Fit rating. For a detailed report, expand the  Elastic Fit Details . If the Elastic Fit is less than ideal, the list of violated rules will be displayed. You can display the AD tree and hide the violated rules by clicking a button acknowledging that the layer is unlikely to work as expected.", 
            "title": "Analyze an App Layer for Elastic Fit"
        }, 
        {
            "location": "/#upgrading-from-earlier-releases", 
            "text": "After upgrading from an earlier Unidesk release, the Elastic Fit Detail shows that any existing Layer Version(s) have not been analyzed. Until you run the analysis on existing Layer Versions, the Versions will have a single  High severity   Elastic Fit Detail, and a  Poor   Elastic Fit.", 
            "title": "Upgrading from Earlier Releases"
        }, 
        {
            "location": "/#example", 
            "text": "You start with an AD User, and AD Group, and a machine that you provisioned using a Layered Image.  AD User:  Kenya Kenya has no elastic assignments. AD Group:  Marketing The  Marketing  group includes the member Kenya. Machine:  ElasticTestMachine The  ElasticTestMachine  base image includes the  MS Office App Layer .  In this example, you elastically assign the  Chrome App Layer   to  ElasticTestMachine  :  In AD, you add the machine  ElasticTestMachine  to the  Marketing  AD Group. In the Unidesk Management Console (UMC) you  elastically assign  the  Chrome App Layer  to the  Marketing  Group. When Kenya, who is part of the Marketing group, logs into  ElasticTestMachine , she receives both the  MS Office App Layer , which is in the base image, and the  Chrome App Layer . When any user who is  not  in the  Marketing  group logs into  ElasticTestMachine , they also receive both Layers:  MS Office  because it is in the base image, and  Chrome  because the  ElasticTestMachine  is a member of the  Marketing  AD Group.", 
            "title": "Example"
        }, 
        {
            "location": "/#associate-a-set-of-machines-with-an-ad-group", 
            "text": "Log into the Unidesk Management Console (UMC) as an Admin user, and select  Users > Tree . Expand the Tree, select the appropriate Group and click  Edit Properties  in the Action bar. This opens the Edit Group Wizard. Select the checkbox,  Associate machines with this AD Group . This reveals the  Machine Name Pattern  field: Specify a set of machines to associate with the AD group by entering a machine name pattern. For examples, see the above table of Machine name patterns. On the Confirm and Complete tab, select  Update Group . Notice the shape of a computer monitor superimposed over the group icon. This indicates that machines are associated with the group. When you click the group's   icon, the Detail view now includes a field called,  Associate With Machines  where the pattern.", 
            "title": "Associate a set of machines with an AD Group"
        }, 
        {
            "location": "/#example_1", 
            "text": "You start with the machine,  Mach1  , the AD Group,  MachineGroup  , and the App Layers for  Firefox   and  MS Office  .  Machine:  Mach1 AD Group:  MachineGroup App Layers:  Firefox ,  MS Office  Further, you have elastically assigned the Firefox and MS Office Layers to the AD Group.  If you add a Machine Association to  MachineGroup   with a name pattern of \" Mach * \", when any domain user logs into  Mach1  , they will receive the Firefox and MS Office Elastic App Layers.", 
            "title": "Example"
        }, 
        {
            "location": "/#is-this-a-delivery-issue", 
            "text": "Are the things you'd expect to see if this app were installed actually there as expected?  Do you see the files and registry entries for the layer? If the app is supposed to be in the Start menu, is it there? If there should be a shortcut for the app on the user's desktop, is there one?  If you discover that app delivery is an issue, you can collect the following data, open a case, and send the data to Unidesk Support.  Collect the data from these logs: Windows App Event log  In the Windows Event Viewer under Windows Logs, export the Application event log as an EVTX file. Unidesk Layering Service log (ulayersvc.log)  C:\\ProgramData\\Unidesk\\Logs\\ulayersvc.log Collect the values of these Registry keys: HKEY_LOCAL_MACHINE\\SOFTWARE\\Unidesk\\ULayer:AssignmentFile HKEY_LOCAL_MACHINE\\SOFTWARE\\Unidesk\\ULayer:RepositoryPath Collect the contents of the Assignment (ElasticLayerAssignments.json) and Layers (Layers.json) files from the Repository Path. Contact Support.", 
            "title": "Is this a Delivery issue?"
        }, 
        {
            "location": "/#is-this-an-operational-issue", 
            "text": "One of these issues could indicate that this is an Elastic Layering issue:  The app is being delivered but doesn't launch correctly. An operation within the app doesn't work correctly. A licensing problem or a security issue. The app launches, but then misbehaves, for example, it crashes on startup, or starts up but doesn't work right.  If the problem with the Layer is operational, test the App Layer in the base image to rule out general layering issues:  Add the App Layer to an Image Template, and publish a Layered Image that includes the App Layer. Log in as a user who is  not  assigned the Layer elastically, and make sure that the application is operational in the base image. Contact Support with your findings.", 
            "title": "Is this an operational issue?"
        }, 
        {
            "location": "/#delete-layers", 
            "text": "What type of layer do you want to delete?", 
            "title": "Delete Layers"
        }, 
        {
            "location": "/#delete-an-os-layer", 
            "text": "You can delete an OS Layer or Layer version, as long as it is not being used by another Unidesk Layer, or Image Template. Deleting the Layer itself removes all versions, volumes, and resources from Unidesk, where it is stored.  In this article:  Before you can delete a Layer or Layer Version   Delete a Layer or Layer Version", 
            "title": "Delete an OS Layer"
        }, 
        {
            "location": "/#delete-a-platform-layer", 
            "text": "You can delete a Platform Layer or Layer version, as long as it is not being used by an Image Template. Deleting the Layer itself removes all versions and resources associated with the Layer.  In this article:  Delete a Layer or Layer Version", 
            "title": "Delete a Platform Layer"
        }, 
        {
            "location": "/#delete-an-app-layer", 
            "text": "You can delete an App Layer or Layer version, as long as it is not being used by another Unidesk Layer, or Image Template. Deleting the Layer itself removes all versions and resources associated with the Layer.  In this article:  Before you can delete a Layer or Layer Version   Delete a Layer or Layer Version", 
            "title": "Delete an App Layer"
        }, 
        {
            "location": "/#publishing-essentials", 
            "text": "Unidesk lets you publish  Layered Images   as disks compatible with your platform. You can use a Layered Image to provision servers, as you would with any other image.", 
            "title": "Publishing essentials"
        }, 
        {
            "location": "/#about-layered-images", 
            "text": "Layered Images are bootable images composited from Unidesk Layers. Each Layered Image contains an OS Layer, a Platform Layer, and any number of App Layers.", 
            "title": "About Layered Images"
        }, 
        {
            "location": "/#creating-and-updating-layered-images", 
            "text": "The way you specify which layers to include in a Layered Image is by saving the combination of layers you want for a particular group of users in an Image Template. You then use this template to publish a Layered Image to your chosen platform.  When you need to update the Layered Image, you simply edit the Image Template to add or remove layer assignments, and publish a new version of the image.", 
            "title": "Creating and updating Layered Images"
        }, 
        {
            "location": "/#publish-layered-images", 
            "text": "Once you have an OS Layer and a Platform Layer, a best practice is to verify that the Layers can be published to your environment as part of a Layered Image. Then you can build out the image by adding App Layers to it.  To publish the Layered Image, you first add the Layers to an Image Template, and use the template to publish a Layered Image. Once you have verified that the Layered Image is successfully published, create your App Layers, add them to your Image Template, and publish a Layered Image.", 
            "title": "Publish Layered Images"
        }, 
        {
            "location": "/#before-you-start_20", 
            "text": "Install the Unidesk Enterprise Layer Manager (ELM)  Set up Unidesk  Create Layers", 
            "title": "Before you start"
        }, 
        {
            "location": "/#publish-layered-images_1", 
            "text": "Create an Image Template Publish a Layered Image", 
            "title": "Publish Layered Images"
        }, 
        {
            "location": "/#next-steps", 
            "text": "Now you can:  Update your OS Layer and App Layers, as needed Add the new layer version to your Image Template Publish the Layered Image", 
            "title": "Next Steps"
        }, 
        {
            "location": "/#create-image-templates", 
            "text": "On what platform are you publishing Layered Images?", 
            "title": "Create Image Templates"
        }, 
        {
            "location": "/#create-image-templates-mcs-for-nutanix-ahv", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit  an Image Template and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (MCS for Nutanix AHV)"
        }, 
        {
            "location": "/#create-image-templates-citrix-mcs-for-vsphere", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (Citrix MCS for vSphere)"
        }, 
        {
            "location": "/#create-image-templates-citrix-mcs-for-xenserver", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (Citrix MCS for XenServer)"
        }, 
        {
            "location": "/#create-image-templates-pvs", 
            "text": "In this article:  Prerequisites Create an Image Template  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (PVS)"
        }, 
        {
            "location": "/#create-image-templates-xenserver", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit  an Image Template and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (XenServer)"
        }, 
        {
            "location": "/#create-image-templates-azure", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to use for publishing Layered Images to your target platform. You can then use the published Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (Azure)"
        }, 
        {
            "location": "/#create-image-templates-nfs", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (NFS)"
        }, 
        {
            "location": "/#create-image-templates-nutanix-ahv", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit  an Image Template and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (Nutanix AHV)"
        }, 
        {
            "location": "/#create-image-templates-vmware-horizon-view-for-vsphere", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to VMware Horizon View Composer where you can then use the Layered Image(s) to provision servers on your chosen publishing platform. The Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.  As long as you select a  VMware Horizon for vSphere   Connector Configuration, using this Image Template to publish a Layered Image will result in a VM in a ready-to-use state, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications. Each Layered image is a new 'Parent VM' that you can select for your Linked Clones pool.", 
            "title": "Create Image Templates (VMware Horizon View for vSphere)"
        }, 
        {
            "location": "/#create-image-templates-vsphere", 
            "text": "In this article:  Prerequisites Create an Image Template Next Step  You can create Image Templates to publish Layered Images to your target platform where you can then use the Layered Image to provision servers on your chosen publishing platform. An Image Template stores your Layer assignments, along with a Layer icon and description. You can easily  edit an Image Template  and use it to publish new versions of your Layered Images.", 
            "title": "Create Image Templates (vSphere)"
        }, 
        {
            "location": "/#publish-layered-images_2", 
            "text": "On what platform are you publishing Layered Images?", 
            "title": "Publish Layered Images"
        }, 
        {
            "location": "/#publish-layered-images-azure-rdsh", 
            "text": "In this article:  Prerequisites Publish a Layered Image Provision a Session Host Next Step  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to your chosen platform and use them to provision systems.", 
            "title": "Publish Layered Images (Azure RDSH)"
        }, 
        {
            "location": "/#publish-layered-images-mcs-for-nutanix-ahv", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Nutanix Acropolis, and add each one to a collection, provisioning service, or other method for provisioning your systems.", 
            "title": "Publish Layered Images (MCS for Nutanix AHV)"
        }, 
        {
            "location": "/#next-step_29", 
            "text": "Next you can move the image to a collection or other location for provisioning servers.", 
            "title": "Next Step"
        }, 
        {
            "location": "/#publish-layered-images-citrix-mcs-for-vsphere", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Citrix MCS in your vSphere environment and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a  Virtual Machine Template  , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.", 
            "title": "Publish Layered Images (Citrix MCS for vSphere)"
        }, 
        {
            "location": "/#publish-layered-images-citrix-mcs-for-xenserver", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Citrix MCS in your XenServer environment and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a  Virtual Machine Template  , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.", 
            "title": "Publish Layered Images (Citrix MCS for XenServer)"
        }, 
        {
            "location": "/#publish-layered-images-citrix-pvs", 
            "text": "In this article:  Prerequisites Publish a Layered Image Assign the new vDisk to the targeted devices  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to PVS, and stream them to the systems you want to provision.", 
            "title": "Publish Layered Images (Citrix PVS)"
        }, 
        {
            "location": "/#publish-layered-images-xenserver", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to XenServer and add each one to a collection, provisioning service, or other method for provisioning your systems.", 
            "title": "Publish Layered Images (XenServer)"
        }, 
        {
            "location": "/#publish-layered-images-network-file-share", 
            "text": "In this article:  Prerequisites Publish a Layered Image Next Step  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to the ELM's Network File Share, copy the Image(s) to your target environment, and use them to provision Session Hosts in your environment. This is especially useful if Unidesk does not yet include Connectors for the platform where you're provisioning systems.", 
            "title": "Publish Layered Images (Network File Share)"
        }, 
        {
            "location": "/#publish-layered-images-nutanix-ahv", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to Nutanix AHV, and add each one to a collection, provisioning service, or other method for provisioning your systems.", 
            "title": "Publish Layered Images (Nutanix AHV)"
        }, 
        {
            "location": "/#next-step_31", 
            "text": "Use the image to provision Nutanix AHV servers.", 
            "title": "Next Step"
        }, 
        {
            "location": "/#publish-layered-images-vmware-horizon-view-for-vsphere", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to VMware Horizon View Composer in your vSphere environment, and add it to a catalog for provisioning systems. In the Connector Configuration wizard, be sure to configure a  Virtual Machine Template  , so that the Layered Image you publish will be in a ready-to-use VM, the image shut down and a snapshot taken. You can use the VM in your Horizon environment without further modifications.", 
            "title": "Publish Layered Images (VMware Horizon View for vSphere)"
        }, 
        {
            "location": "/#publish-layered-images-vsphere", 
            "text": "In this article:  Prerequisites Publish a Layered Image  A Layered Image is a virtual machine that Unidesk has composited from the Layers and settings specified in an Image Template. You can publish one or more Layered Images to vSphere and add each one to a collection, provisioning service, or other method for provisioning your systems.", 
            "title": "Publish Layered Images (vSphere)"
        }, 
        {
            "location": "/#manage-image-templates", 
            "text": "This article contains:  Update Image Templates with a new Layer Version Edit any Image Template setting Delete an Image Template  When you create new Layers and new Versions to them, you can edit the layer selection in your Image Templates, and use the templates to publish new versions of your Layered Images.  Once created, a Layered Image is no longer associated with the template used to create it. This means that you can change or delete a template without affecting any previously published Layered Images.", 
            "title": "Manage Image Templates"
        }, 
        {
            "location": "/#connector-essentials", 
            "text": "In this article:  What are Connectors?  What are Connector Configurations?  What Connector Configurations do I need?  How and when to add a new Connector Configuration", 
            "title": "Connector essentials"
        }, 
        {
            "location": "/#connector-configurations-for-importing-an-os-to-create-an-os-layer", 
            "text": "When you create an OS Layer, you need a Connector Configuration to give Unidesk access to the location of the OS image that you want to use for your OS Layer.", 
            "title": "Connector Configurations for importing an OS to create an OS Layer"
        }, 
        {
            "location": "/#connector-configurations-for-creating-and-updating-app-layers-and-adding-versions-to-os-layers", 
            "text": "When creating or updating an App Layer, or adding Versions to an OS Layer, you need a Connector Configuration for the location in your environment where you will package the Layer. You can create as many configurations as you need, for example, if you have more than one storage location in the environment.", 
            "title": "Connector Configurations for creating and updating App Layers, and adding Versions to OS Layers"
        }, 
        {
            "location": "/#connector-configurations-for-publishing-layered-images", 
            "text": "Publishing Layered Images will require different Connector Configurations than the ones you use for creating Layers, if, for example, you publish Layered Images to a variety of storage locations near the users being served. For example, you can prepare your Layers for a server farm in vSphere, and publish Layered Images to Citrix PVS for streaming to servers in vSphere. Or, you can publish Layered Images to more than one storage location in the same environment, each requiring a different Connector Configuration. Each location is likely to require different credentials.", 
            "title": "Connector Configurations for publishing Layered Images"
        }, 
        {
            "location": "/#add-a-new-connector-configuration", 
            "text": "What platform are you using this Connector Configuration to connect to?", 
            "title": "Add a new Connector Configuration"
        }, 
        {
            "location": "/#how-virtual-machines-are-organized", 
            "text": "Nutanix does not provide a mechanism for organizing virtual machines. Because of this, it may be difficult to find the virtual machines created by your Unidesk ELM when the total number of virtual machines is large. To help you find these VMs, the following naming conventions are used:  Packaging Machines  (virtual machines created during the process of creating an App Layer or OS Version) The virtual machine name will start with the layer name that is being created/modified The virtual machine names will end with the following text: (Unidesk Packaging Machine) Layered Image Virtual Machines  (virtual machines created as a result of publishing a Layered Image) The virtual machine name will start with the image name that was published The virtual machine name will end with the following text: (Unidesk Published Image)  When viewing virtual machines through the Nutanix web console, you can search for virtual machines by filtering on:  \"Unidesk\" to find all virtual machines created by Unidesk \"Unidesk Packaging Machine\" to find all virtual machines created for Layer management jobs. \"Unidesk Layered Image\" to find all virtual machines created to publish a Layered Image. Image name or Layer name to find virtual machines related to a specific Layered Image publishing job or App or OS creation.", 
            "title": "How Virtual Machines are Organized"
        }, 
        {
            "location": "/#virtual-machine-network-connectivity", 
            "text": "The virtual network settings of the source template specified in the Nutanix AHV Connector Configuration will be carried over when creating any VMs through the Nutanix Acropolis Hypervisor (AHV) Connector. There is no option in the Connector Configuration UI to override the network settings.", 
            "title": "Virtual Machine Network Connectivity"
        }, 
        {
            "location": "/#configure-a-script-optional", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (optional)"
        }, 
        {
            "location": "/#other-script-configuration-values", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName Common Common This is the name of the connector configuration that the script configuration is associated with. imageName Common Common This is the name of the layered image template that was used to build/publish the layered image. osType Common Common This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows7 64-bit Windows2008 64-bit Windows2012 64-bit Windows10 Windows1064 virtualInfrastructureServer Common Nutanix AHV The Nutanix AHV (Prism Server) specified in the connector configuraiton. vmId Common Nutanix AHV The virtual machine UUID (same as vmUuid). vmName Common Nutanix AHV The name of the virtual machine that was created. vmNetwork Common Nutanix AHV The name of the virtual network that the main NIC of the virtual machine is connected to. vmNetworkId Common Nutanix AHV The UUID of the virtual network that the main NIC of the virtual machine is connected to. vmNetworkMAC Common Nutanix AHV The MAC address of the main NIC that is connected to the virtual network specified in vmNetwork and vmNetworkId. vmUuid Common Nutanix AHV The virtual machine UUID (same as vmId).", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#definition-scope", 
            "text": "Defines whether the  scripts   variable is set for all Connector types or whether it is specific to a particular Connector type.", 
            "title": "Definition Scope"
        }, 
        {
            "location": "/#value-source", 
            "text": "Defines whether the variable value is determined by common code or by Connector-specific code.", 
            "title": "Value Source"
        }, 
        {
            "location": "/#configure-a-script-remember-this-is-optional", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (Remember, this is optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_1", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_1", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows8 Windows864 Windows200864 Windows201264 Windows10 Windows1064 virtualInfrastructureServer All vSphere connector code The vCenter server specified in the connector configuration. vmName All vSphere connector code The name of the virtual machine that was created. vmId All vSphere connector code The virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\") vmUuid All vSphere connector code The virtual machine UUID as set by the underlying highbrd.", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#user-impersonation", 
            "text": "The Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.", 
            "title": "User Impersonation"
        }, 
        {
            "location": "/#script-execution-policy", 
            "text": "Script execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.", 
            "title": "Script Execution Policy"
        }, 
        {
            "location": "/#virtual-machine-organization", 
            "text": "XenServer allows for VMs to be organized either by folder or by tag. These organizational tools are optional when creating and managing VMs through XenCenter or other tools. Although XenServer Connector Configurations do  not   allow the administrator to specify folders or tags, the VMs created by the XenServer Connector, both Packaging Machines and published Layered Images, can utilize both organizational tools.", 
            "title": "Virtual Machine organization"
        }, 
        {
            "location": "/#tags", 
            "text": "If the template specified in the XenServer connector configuration has any tags, then those tags will be carried over to any VM cloned from that template. Therefore all packaging VMs or published layered images will be tagged with the same tags that the template has. Additionally, the XenServer connector will add three tags.  Unidesk  - All VMs created by the XenServer connector can be found by this tag regardless of their purpose or image. Purpose Tag  - All packaging machines will be tagged with \"Unidesk Packaging Machine\" while all published layered image VMs will be tagged with \"Unidesk Published Images\". Image/Layer Name  - All packaging machines will be tagged with the layer name for the layer which they are generated, while all published layered images will be tagged with the template image name.  If you are using XenCenter, you can view your VMs by tag by selecting the \"Organization Views\" and then select \"By Tag\".", 
            "title": "Tags"
        }, 
        {
            "location": "/#folder", 
            "text": "By default VMs created by the XenServer Connector will not be placed in a folder. However, if the template specified in the XenServer Connector Configuration resides in a folder, then any VM that the Connector creates from that template will also reside in the same folder. All packaging VMs and published Layered Images will be placed in that same folder. There will  not   be separate subfolders for packaging VMs or published Layered Iimages.", 
            "title": "Folder"
        }, 
        {
            "location": "/#machine-network-connectivity", 
            "text": "The virtual network settings of the source template specified in the XenServer Connector Configuration will be carried over when creating any VMs through the XenServer Connector. There is no option in the Connector Configuration UI to override the network settings.", 
            "title": "Machine network connectivity"
        }, 
        {
            "location": "/#xenserver-clusters", 
            "text": "The XenServer Connector does  not   yet work correctly with XenServer clusters. If the host specified in the configuration is part of a cluster, then it must be the master host in the cluster for the connector to work. However, this means that any time the master XenServer host goes down and a new master is elected, the XenServer configuration must be updated.", 
            "title": "XenServer Clusters"
        }, 
        {
            "location": "/#configure-a-script-optional_1", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_2", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_2", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows200864 Windows201264 Windows10 Windows1064 virtualInfrastructureServer All XenServer connector code The XenServer host specified in the connector configuration. vmName All XenServer connector code The name of the virtual machine that was created. vmId All XenServer connector code The virtual machine UUID (same as vmUuid) vmUuid All XenServer connector code The virtual machine UUID (same as vmId)", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#definition-scope_1", 
            "text": "Whether the scripts variable is set for all platform connector types or whether it is specific to a particular connector type.", 
            "title": "Definition Scope"
        }, 
        {
            "location": "/#value-source_1", 
            "text": "Whether the variable value is determined by common code or by platform connector specific code.", 
            "title": "Value Source"
        }, 
        {
            "location": "/#pvs-requirements", 
            "text": "", 
            "title": "PVS requirements"
        }, 
        {
            "location": "/#pvs-services-must-be-running-as-a-domain-account", 
            "text": "For Unidesk to work correctly with PVS, the PVS services must be running as a  domain account  . This is because domain accounts have permissions to access the PVS store and the local system account does not.  If your PVS server is configured to use the local system account, which is the default setting, you can change the account by running the PVS configuration tool. This tool gives you an option to run as  local system   or use a  domain account  . Choose a  domain account  .", 
            "title": "PVS services must be running as a domain account"
        }, 
        {
            "location": "/#pvs-server-and-account-information", 
            "text": "For Unidesk to access the location in your PVS environment where you want to publish a Layered Image, you need to supply the credentials and location in a PVS Connector Configuration.  The information you need for the PVS Connector Configuration includes.  Name  - A useful name to help identify and keep track of this connector configuration. Console  - The name of the PVS server on which the Undesk agent is deployed. This is the server to which the vDisk will be published. Domain User  - User name of a domain account that has permission to manage PVS. This account will be used by the agent to run PVS Powershell commands. This account  must  have  Read/Write  access to the PVS store for writing the published vDisk. Password  - Password for the domain user account. Site Name  - Name of the Site this vDisk is to be a member of. Store Name  - Name of the Store that this vDisk is a member of. Write Cache  - When a new Disk is being created, this value sets the Write Cache type of the new Disk. Possible values include: Cache on Server Cache on Server, Persistent Cache in Device RAM Cache in Device RAM with Overflow on Hard Disk Cache on Device Hard Drive When choosing a  Write Cache  option, consult your  PVS documentation  to ensure that the PVS Servers and target devices that use this vDisk are properly configured for the type you select. License Mode  - Sets the Windows License Mode to: KMS - Key Management Service MAK - Multiple Activation Keys None Enable Active Directory machine account password management  - Enables Active Directory (AD) password management. The default value is  Enabled . Enable Load Balancing  - Enables load balancing. for the streaming of the vDisk Enable Printer Management  - When enabled, invalid printers will be deleted from the Device.", 
            "title": "PVS server and account information"
        }, 
        {
            "location": "/#configure-a-script-remember-this-is-optional_1", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (Remember, this is optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_3", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_3", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows200864 Windows201264 Windows10 Windows1064 diskLocatorId All PVS The internal id for the vDisk.", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#user-impersonation_1", 
            "text": "The Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.", 
            "title": "User Impersonation"
        }, 
        {
            "location": "/#script-execution-policy_1", 
            "text": "Script execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.", 
            "title": "Script Execution Policy"
        }, 
        {
            "location": "/#virtual-machine-organization_1", 
            "text": "XenServer allows for VMs to be organized either by folder or by tag. These organizational tools are optional when creating and managing VMs through XenCenter or other tools. Although XenServer Connector Configurations do  not   allow the administrator to specify folders or tags, the VMs created by the XenServer Connector, both Packaging Machines and published Layered Images, can utilize both organizational tools.", 
            "title": "Virtual Machine organization"
        }, 
        {
            "location": "/#tags_1", 
            "text": "If the template specified in the XenServer connector configuration has any tags, then those tags will be carried over to any VM cloned from that template. Therefore all packaging VMs or published layered images will be tagged with the same tags that the template has. Additionally, the XenServer connector will add three tags.  Unidesk  - All VMs created by the XenServer connector can be found by this tag regardless of their purpose or image. Purpose Tag  - All packaging machines will be tagged with \"Unidesk Packaging Machine\" while all published layered image VMs will be tagged with \"Unidesk Published Images\". Image/Layer Name  - All packaging machines will be tagged with the layer name for the layer which they are generated, while all published layered images will be tagged with the template image name.  If you are using XenCenter, you can view your VMs by tag by selecting the \"Organization Views\" and then select \"By Tag\".", 
            "title": "Tags"
        }, 
        {
            "location": "/#folder_1", 
            "text": "By default VMs created by the XenServer Connector will not be placed in a folder. However, if the template specified in the XenServer Connector Configuration resides in a folder, then any VM that the Connector creates from that template will also reside in the same folder. All packaging VMs and published Layered Images will be placed in that same folder. There will  not   be separate subfolders for packaging VMs or published Layered Iimages.", 
            "title": "Folder"
        }, 
        {
            "location": "/#machine-network-connectivity_1", 
            "text": "The virtual network settings of the source template specified in the XenServer Connector Configuration will be carried over when creating any VMs through the XenServer Connector. There is no option in the Connector Configuration UI to override the network settings.", 
            "title": "Machine network connectivity"
        }, 
        {
            "location": "/#xenserver-clusters_1", 
            "text": "The XenServer Connector does  not   yet work correctly with XenServer clusters. If the host specified in the configuration is part of a cluster, then it must be the master host in the cluster for the connector to work. However, this means that any time the master XenServer host goes down and a new master is elected, the XenServer configuration must be updated.", 
            "title": "XenServer Clusters"
        }, 
        {
            "location": "/#scripts", 
            "text": "The XenServer Connector supports script execution after publishing layered images just as the vSphere connectors do. The following script variables will be set:", 
            "title": "Scripts"
        }, 
        {
            "location": "/#configure-a-script-optional_2", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_4", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_4", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows200864 Windows201264 Windows10 Windows1064 virtualInfrastructureServer All XenServer connector code The XenServer host specified in the connector configuration. vmName All XenServer connector code The name of the virtual machine that was created. vmId All XenServer connector code The virtual machine UUID (same as vmUuid) vmUuid All XenServer connector code The virtual machine UUID (same as vmId)", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#definition-scope_2", 
            "text": "Whether the scripts variable is set for all platform connector types or whether it is specific to a particular connector type.", 
            "title": "Definition Scope"
        }, 
        {
            "location": "/#value-source_2", 
            "text": "Whether the variable value is determined by common code or by platform connector specific code.", 
            "title": "Value Source"
        }, 
        {
            "location": "/#requirements-for-running-the-azure-credentials-tool", 
            "text": "A system with access to Azure and running the following software: Windows Server 2008, or later Windows Powershell 2.0, or later (This ships with Windows Server 2008 and later.) Storage Account in Azure Login credentials for a  Global Admin  or  Service Admin  in the Azure Active Directory Tenant associated with your subscription. In Azure, you can manage Active Directory  here . An Azure AD tenant can be associated with many subscriptions, but each subscription can only have one tenant. If you are not sure which tenant is associated with which subscription, you can find out by clicking  Subscriptions  on the top of the old portal, and filtering by the directories listed until your subscription is listed as a check box under  Filter by Subscriptions .", 
            "title": "Requirements for running the Azure Credentials Tool"
        }, 
        {
            "location": "/#create-a-new-storage-account-in-azure-if-you-dont-have-one-for-this-purpose", 
            "text": "In a web browser, navigate to the  Microsoft Azure portal  and log in. On the sidebar, select  Storage accounts  or  Browser > Storage accounts . Do  not  select Storage accounts (classic). Select  Add  in the top-left corner of the window that opens. In the form that appears, select the options you need, making sure that the new storage location fits the same criteria for using any existing storage account.", 
            "title": "Create a new storage account in Azure, if you don't have one for this purpose"
        }, 
        {
            "location": "/#retrieve-information-for-a-new-azure-connector-configuration", 
            "text": "Here's how to set up your Azure credentials in the Connector Configuration wizard. It explains how to run the Azure for each Azure subscription that you want Unidesk to access.  On a Windows Server 2008 (or later version) machine, download and run the Unidesk Azure Credentials Tool from the  Unidesk 4 Downloads  page. Follow the directions in the command prompt to select a subscription and choose a Client Secret. When the tool is complete, it will display the fields below. These should be entered into the configuration. Enter the Client Secret that you chose while running the tool. If you did not enter a Client Secret, it has already been set up using this tool and you should use the one that was entered previously.  Note:   you will have to enter a new Client Secret each time you use a new subscription that has a new Tenant ID. This is because client secrets are logically associated with Azure tenants.", 
            "title": "Retrieve information for a new  Azure Connector Configuration"
        }, 
        {
            "location": "/#what-to-do-if-your-azure-client-secret-is-lost", 
            "text": "Once Unidesk creates the Client Secret for a Connector Configuration, the secret will always be hidden from view. If you forget and lose the Client Secret for a Configuration, you can reset it by using the following procedure:  Note:   You may have to be the primary Administrator of your Azure subscription to complete this procedure. Other Azure users may not have the access required.  Log in to the  Classic  Azure Portal at:  https://manage.windowsazure.com/ . In the left sidebar, select  Active Directory . From the list of Active Directories, select the entry corresponding to your Unidesk installation. From the top menu, select  Applications . In the Show field, select  Applications my company owns . In the Search box, enter  Unidesk  and click the check mark to perform the search. In the search results, locate an entry named \"Unidesk ELM Access for  your-subscription-name \" and delete it. If you do not see such an entry, look for it in your other Active Directories. Run the Unidesk Azure Credentials Tool again to create a new Client Secret.", 
            "title": "What to do if your Azure Client Secret is lost"
        }, 
        {
            "location": "/#how-virtual-machines-are-organized_1", 
            "text": "Nutanix does not provide a mechanism for organizing virtual machines. Because of this, it may be difficult to find the virtual machines created by your Unidesk ELM when the total number of virtual machines is large. To help you find these VMs, the following naming conventions are used:  Packaging Machines  (virtual machines created during the process of creating an App Layer or OS Version) The virtual machine name will start with the layer name that is being created/modified The virtual machine names will end with the following text: (Unidesk Packaging Machine) Layered Image Virtual Machines  (virtual machines created as a result of publishing a Layered Image) The virtual machine name will start with the image name that was published The virtual machine name will end with the following text: (Unidesk Published Image)  When viewing virtual machines through the Nutanix web console, you can search for virtual machines by filtering on:  \"Unidesk\" to find all virtual machines created by Unidesk \"Unidesk Packaging Machine\" to find all virtual machines created for Layer management jobs. \"Unidesk Layered Image\" to find all virtual machines created to publish a Layered Image. Image name or Layer name to find virtual machines related to a specific Layered Image publishing job or App or OS creation.", 
            "title": "How Virtual Machines are Organized"
        }, 
        {
            "location": "/#virtual-machine-network-connectivity_1", 
            "text": "The virtual network settings of the source template specified in the Nutanix AHV Connector Configuration will be carried over when creating any VMs through the Nutanix Acropolis Hypervisor (AHV) Connector. There is no option in the Connector Configuration UI to override the network settings.", 
            "title": "Virtual Machine Network Connectivity"
        }, 
        {
            "location": "/#configure-a-script-optional_3", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed here, and click  Save .", 
            "title": "Configure a Script (optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_5", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_5", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName Common Common This is the name of the connector configuration that the script configuration is associated with. imageName Common Common This is the name of the layered image template that was used to build/publish the layered image. osType Common Common This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows7 64-bit Windows2008 64-bit Windows2012 64-bit Windows10 Windows1064 virtualInfrastructureServer Common Nutanix AHV The Nutanix AHV (Prism Server) specified in the connector configuraiton. vmId Common Nutanix AHV The virtual machine UUID (same as vmUuid). vmName Common Nutanix AHV The name of the virtual machine that was created. vmNetwork Common Nutanix AHV The name of the virtual network that the main NIC of the virtual machine is connected to. vmNetworkId Common Nutanix AHV The UUID of the virtual network that the main NIC of the virtual machine is connected to. vmNetworkMAC Common Nutanix AHV The MAC address of the main NIC that is connected to the virtual network specified in vmNetwork and vmNetworkId. vmUuid Common Nutanix AHV The virtual machine UUID (same as vmId).", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#definition-scope_3", 
            "text": "Defines whether the  scripts   variable is set for all Connector types or whether it is specific to a particular Connector type.", 
            "title": "Definition Scope"
        }, 
        {
            "location": "/#value-source_3", 
            "text": "Defines whether the variable value is determined by common code or by Connector-specific code.", 
            "title": "Value Source"
        }, 
        {
            "location": "/#configure-a-script-remember-this-is-optional_2", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (Remember, this is optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_6", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_6", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows200864 Windows201264 Windows10 Windows1064 virtualInfrastructureServer All vSphere connector code The vCenter server specified in the connector configuration. vmName All vSphere connector code The name of the virtual machine that was created. vmId All vSphere connector code The virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\") vmUuid All vSphere connector code The virtual machine UUID as set by the underlying highbrd.", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#user-impersonation_2", 
            "text": "The Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.", 
            "title": "User Impersonation"
        }, 
        {
            "location": "/#script-execution-policy_2", 
            "text": "Script execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.", 
            "title": "Script Execution Policy"
        }, 
        {
            "location": "/#configure-a-script-remember-this-is-optional_3", 
            "text": "If you want a script to run each time a Layered Image is published, complete these steps using the values described in the sections that follow.  Complete and save the Connector Configuration as described above. Note:  Before selecting Script Configuration page, you must save (or discard) any edits to the Connector Configuration settings, If the Navigation menu on the left is not open, select it and click  Script Configuration  to open the Script Path page. Complete the required fields using the values detailed herein, and click  Save .", 
            "title": "Configure a Script (Remember, this is optional)"
        }, 
        {
            "location": "/#other-script-configuration-values_7", 
            "text": "", 
            "title": "Other Script Configuration values"
        }, 
        {
            "location": "/#powershell-variables_7", 
            "text": "When the script is executed the following variables will be set and can be used in the powershell script:  Value Applies to connector types: Value determined by which code: Description connectorCfgName All Common code This is the name of the connector configuration that the script configuration is associated with. imageName All Common code This is the name of the layered image template that was used to build/publish the layered image. osType All Common code This is the OS type of the layered image that was published. It can be one of the following values: Windows7 Windows764 Windows8 Windows864 Windows200864 Windows201264 Windows10 Windows1064 virtualInfrastructureServer All vSphere connector code The vCenter server specified in the connector configuration. vmName All vSphere connector code The name of the virtual machine that was created. vmId All vSphere connector code The virtual machine ID taken from the mobref of the vm (i.e. \"vm-12345\") vmUuid All vSphere connector code The virtual machine UUID as set by the underlying highbrd.", 
            "title": "Powershell variables"
        }, 
        {
            "location": "/#user-impersonation_3", 
            "text": "The Unidesk Agent, which runs as a service on a Windows machine, runs under either the local system account or the network account. Either of these accounts may have some special privileges, but they often are restricted when it comes to executing specific commands or seeing files in the file system. Therefore, Unidesk gives you the option of adding a domain user and password that can be used to \"impersonate\" a user. This means that the script can be executed as if that user had logged onto the system so that any commands or data will be accessible subject to those user rights and permissions. If no user name or password is entered, the script executes using the account under which the service is configured to run.", 
            "title": "User Impersonation"
        }, 
        {
            "location": "/#script-execution-policy_3", 
            "text": "Script execution policy requirements are generally up to you. If you intend to run unsigned scripts, you must configure the execution policy to one of the more lenient policies. However, if you sign your own scripts accordingly, you can choose to use a more restrictive execution policy.", 
            "title": "Script Execution Policy"
        }, 
        {
            "location": "/#manage-system-storage", 
            "text": "In this article:  Check the amount of free space in the Unidesk ELM's local storage Add space to an existing disk in locally attached storage Add a disk to locally attached storage", 
            "title": "Manage system storage"
        }, 
        {
            "location": "/#manage-the-unidesk-elm-virtual-appliance", 
            "text": "In this article:  Before you start Log into the ELM using an account with administrator privileges Change the administrator password Configure networking (includes Static IP Address option) Synchronize the system clock with NTP servers Change the Time Zone  The Enterprise Layer Manager (ELM) is a virtual appliance that coordinates communication in the Unidesk environment and manages copies of your Layers and Image Templates. Based on CentOS, the ELM hosts the Unidesk Management Console (UMC), a friendly interface where you create Unidesk Layers and use those Layers to publish Layered Images.  You can log into the ELM and modify the administrator password, network address, NTP servers, and Time Zone settings using the Unidesk Appliance Configuration utility, as described here.", 
            "title": "Manage the Unidesk ELM (virtual appliance)"
        }, 
        {
            "location": "/#open-firewall-ports-for-unidesk-as-needed_1", 
            "text": "In this article:  Admin User Unidesk Enterprise Layer Manager Appliance Next step  The Unidesk ELM must be connected to a network file share.  The Unidesk installer opens ports that the Unidesk Enterprise Layer Manager (ELM) needs to interact with services on the virtual server where it is hosted. The default ports that Unidesk uses are listed in the tables below.  If there is a firewall between the Unidesk appliance and the machine on which you are running the Unidesk Agent or one of the Unidesk Connectors, you must manually open the port in the firewall used for that purpose. If during installation you changed any of the ports from the default setting, be sure to open the correct port.", 
            "title": "Open firewall ports for Unidesk, as needed"
        }, 
        {
            "location": "/#internal-connections_1", 
            "text": "By default, Unidesk uses the following ports in your firewall for internal connections between the Unidesk appliance and each of the destinations listed below.  Destination Activity Protocol Ports Unidesk ELM ActiveMQ Console TCP 8161 Unidesk ELM Log deliveries from the Unidesk Agent TCP 8787 Unidesk ELM Log deliveries from users TCP 8888 Unidesk ELM Communication with datastore via ESXI Host TCP 443 Unidesk Agent Communication TCP 8016 Unidesk Agent Log gathering TCP 14243 Active Directory LDAP TCP 389, 636 Connector for Azure Communication TCP 3000 (HTTP)  3500 (HTTPS) Connector for PVS Communication TCP 3009 (HTTP)  3509 (HTTPS) Connector for vSphere Communication TCP 3004 (HTTP) 3504 (HTTPS) Connector for XenServer Communication TCP 3002 (HTTP) 3502 (HTTPS)", 
            "title": "Internal Connections"
        }, 
        {
            "location": "/#external-connection_1", 
            "text": "By default, Unidesk uses the following port in your firewall for external connections between the Unidesk appliance and the destination listed below.  Destination Activity Protocol Ports api.unidesk.com Logs and Phone Home data uploads from the Unidesk ELM (optional) TCP 443", 
            "title": "External connection"
        }, 
        {
            "location": "/#os-image-xenserver-requirement_1", 
            "text": "Citrix XenServer uses Port 5900 for communications between your OS Image and XenCenter or other Xen client.  Destination Activity Protocol Ports XenCenter Communications   5900", 
            "title": "OS Image (XenServer requirement)"
        }, 
        {
            "location": "/#update-your-unidesk-license_1", 
            "text": "In this article:  Log into the Unidesk site Update your Unidesk license (with web access to the ELM) Update your Unidesk license (without web access to the ELM))  To acquire a Unidesk license, you must be logged in to Unidesk. If you have not already done so, register on the Unidesk website to obtain a User Name and Password.", 
            "title": "Update your Unidesk license"
        }, 
        {
            "location": "/#support-resources", 
            "text": "In this article:  Need help getting started?  Questions about how Unidesk layering works?  Troubleshooting an issue?", 
            "title": "Support resources"
        }, 
        {
            "location": "/#try-unidesk-for-the-first-time", 
            "text": "Install the Unidesk Enterprise Layer Manager (ELM) Set up the ELM in your environment Take a test drive", 
            "title": "Try Unidesk for the first time"
        }, 
        {
            "location": "/#schedule-a-personalized-demo", 
            "text": "Join us for a one-on-one \"Day-in-the-Life\" with a Unidesk Solution Architect", 
            "title": "Schedule a personalized demo"
        }, 
        {
            "location": "/#deploy-rapidly-with-expert-assistance", 
            "text": "Request a Unidesk Pilot, if you haven't already Create a Support Case", 
            "title": "Deploy rapidly with expert assistance"
        }, 
        {
            "location": "/#ask-unidesk-employees-and-contributing-users", 
            "text": "Post your questions on the Unidesk Community Forum", 
            "title": "Ask Unidesk employees and contributing users"
        }, 
        {
            "location": "/#search-the-forum", 
            "text": "App Layer Recipes", 
            "title": "Search the Forum"
        }, 
        {
            "location": "/#export-log-files-for-support", 
            "text": "You can export logs for your Unidesk Enterprise Layer Manager (ELM), and send them to the Unidesk Support team via HTTPS or to yourself and others by email.  This topic explains what log files are available for export, and which log files are useful for what kinds of issues. It then explains how to export each of the logs.  About exporting Unidesk logs  Unidesk log files are text files that contain useful information for the Unidesk Support Team when helping you to resolve an issue. The exported logs are stripped of any passwords and encryption keys, so none of your credentials can be compromised.", 
            "title": "Export log files for Support"
        }, 
        {
            "location": "/#what-log-files-are-exported", 
            "text": "Each export includes the logs for the Unidesk ELM. The Database Crash Dump file export is optional. When you export logs, the Unidesk software creates a gzipped tar file (.tgz) containing the log files. A task with the URL for each tar file appears in the Task bar.  Virtual Machine Exported files Enterprise Layer Manager (ELM) The gzipped tar file (.tgz) with: Management Services logs Layering Services logs Crash Dump files (optional)  To view the log files, download them and extract them using a file compression utility such as the WinZip  product.", 
            "title": "What log files are exported?"
        }, 
        {
            "location": "/#before-you-start_30", 
            "text": "Before you can... You must... Send logs to Unidesk Support Have an open Support Case. Create a Support Case explaining the issue you're seeing. Send email notices Specify your email server in the System > Settings and Configuration > Notifications Settings box. Export logs Make sure the Log File Retention Settings are configured to keep the logs you need for the length of time you need.  Export and send Unidesk ELM logs  When configuring an export, you can choose to send a copy of the logs to Unidesk Support via HTTPS, or to yourself or others who need access to the logs via email.  In the Unidesk Management Console, select  System > Manage Appliance  and click  Export Logs . The Export Logs Wizard opens to the Send Options tab. If you want to send the logs to Unidesk via HTTPS and you have a Unidesk Support Case open, click  Send to Unidesk Support , choose the support case, and type a description in the Comments field. Note:  This option is only available if you have an open Support Case. You can open one and come back to this screen to select the option. If you want to send the files to yourself or others who need access to the logs, select the  Email  check box and type the addresses in the Recipients field. (Use a comma (,) or semi-colon (;) between addresses.) Note:  This field is only active if you've configured an email Notification in the  System > Settings and Configuration > Notifications Settings  box. In the Log Selection tab, the Enterprise Layer Manager Logs option is selected by default. If you need to include the Crash Dump files, mark the check box to include those. In the Confirm and Complete tab, click  Export Logs  to start the export process. The software locates the log files and exports them to a gzipped archive file (*.tgz) on the appliance.  The free  online div table generator  allows you to create nice grids for your websites. Please subsribe for a  htmlg  membership to stop adding promotional messages to the edited documents.", 
            "title": "Before you start"
        }
    ]
}